[["phytoplankton.html", "13 Phytoplankton 13.1 Contributors 13.2 Overview 13.3 Model Description 13.4 Setup &amp; Configuration 13.5 Case Studies &amp; Examples", " 13 Phytoplankton 13.1 Contributors 13.2 Overview The approach to simulate algal biomass is to adopt several plankton functional types (PFTs) that are typically defined based on specific groups such as diatoms, dinoflagellates and cyanobacteria. Whilst each group that is simulated is unique, they share a common mathematical approach and each simulate growth, death and sedimentation processes, and customisable internal nitrogen, phosphorus and/or silica stores if desired. Distinction between groups is made by adoption of groups specific parameters for environmental dependencies, and/or enabling options such as vertical migration or N fixation. For each phytoplankton group, the maximum potential growth rate at 20°C is multiplied by the minimum value of expressions for limitation by light, phosphorus, nitrogen and silica (when configured). While there may be some interaction between limiting factors, a minimum expression is likely to provide a realistic representation of growth limitation (Rhee and Gotham, 1981). 13.3 Model Description 13.3.1 Process Descriptions Photosynthesis &amp; Nutrient Uptake For each phytoplankton group, the maximum potential growth rate at 20˚C is multiplied by the minimum value of expressions for limitation by light, phosphorus, nitrogen and silica (when configured). While there may be some interaction between limiting factors, a minimum expression is likely to provide a realistic representation of growth limitation (Rhee and Gotham, 1981). Therefore, photosynthesis is parameterized as the uptake of carbon, and depends on the temperature, light and nutrient dimensionless functions (adopted from Hipsey &amp; Hamilton, 2008; Li et al., 2013). \\[\\begin{equation} \\text{Growth Equation} \\tag{13.1} \\end{equation}\\] \\[\\begin{align} {f_{uptake}^{PHY_{Ca}}} &amp;= \\end{align}\\] \\[\\begin{align} \\underbrace{{R_{growth}^{PHY_{a}}}}_{\\text{Max growth rate at 20˚C}}*\\underbrace{(1-{k_{pr}^{PHY_{a}}})}_{\\text{Photorespiratory loss}}*\\underbrace{{\\Phi_{tem}^{PHY_{a}}}(T)}_{\\text{Temperature scaling}}*\\underbrace{{\\Phi_{str}^{PHY_{a}}}(T)}_{\\text{Metabolic stress}}* \\end{align}\\] \\[\\begin{align} &amp;{\\text{min}}\\begin{Bmatrix}\\underbrace{\\Phi_{light}^{PHY_{a}}(I)}_{\\text{Light limitation}},\\underbrace{\\Phi_{N}^{PHY_{a}}(NO_{3},NH_{4},PHY_{N_{a}})}_{\\text{N limitation}},\\underbrace{\\Phi_{P}^{PHY_{a}}(PO_{4},PHY_{P_{a}})}_{\\text{P limitation}},\\underbrace{\\Phi_{Si}^{PHY_{a}}(RSi)}_{\\text{Si limitation}}\\end{Bmatrix}* \\end{align}\\] \\[\\begin{align} [PHY_{C_{a}}] \\end{align}\\] To allow for reduced growth at non-optimal temperatures, a temperature function is used where the maximum productivity occurs at a temperature \\(T_{OPT}\\); above this productivity decreases to zero at the maximum allowable temperature, \\(T_{MAX}\\). Below the standard temperature, \\(T_{STD}\\) the productivity follows a simple Arrenhius scaling formulation. In order to fit a function with these restrictions the following conditions are assumed: at \\(T=T_{STD}\\),\\(\\ {\\ \\Phi}_{tem}\\left(T\\right)=1\\) and at \\(T=T_{OPT},\\ \\ \\frac{d\\Phi_{tem}\\left(T\\right)}{dT}=0\\), and at \\(T=T_{MAX}\\),\\(\\ \\Phi_{tem}\\left(T\\right)=0\\). This can be numerically solved using Newton’s iterative method and can be specific for each phytoplankton group. The temperature function is calculated according to (Griffin et al. 2001): \\[\\begin{equation} \\Phi_{tem}^{{PHY}_a}\\left(T\\right)=\\vartheta_a^{T-20}-\\vartheta_a^{k\\left[T-{c1}_a\\right]}+{c0}_a \\tag{13.2} \\end{equation}\\] where \\({c1}_a\\) and \\({c0}_a\\) are solved numerically given input values of: \\(T_a^{std}\\), \\(T_a^{opt}\\) and \\(T_a^{max}\\). The level of light limitation on phytoplankton growth can be modelled as photoinhibition or non-photoinhibition. In the absence of significant photoinhibition, Webb et al. (1974) suggested a relationship for the fractional limitation of the maximum potential rate of carbon fixation for the case where light saturation behavior was absent (Talling, 1957), and the equations can be analytically integrated with respect to depth (Hipsey and Hamilton, 2008). For the case of photoinhibition, the light saturation value of maximum production (IS) is used and the net level effect can be averaged over the cell by integrating over depth. The aed_phytoplankton module contains several light functions, including those from a recent review by Baklouti et al. (2006). The user must select the sensitivity to light according to a photosynthesis-irradiance (P-I curve) formulation and each species must be set to be either non-photoinhibited or photoinhibited according to the options in Table 9. Figure 13.1: Light limitation of pytoplankton via various model approaches. Limitation of the photosynthetic rate may be dampened according to nitrogen or phosphorus availability, and this is either approximated using a Monod expression of the static model is chosen, or based on the internal nutrient stoichiometry if the dynamic (Droop uptake) model is selected: For advanced users, an optional metabolic scaling factor can be included to reduce the photosynthetic capacity of the simulated organisms, for example due to metabolic stress due to undertaking N2 fixation: \\[\\begin{equation} \\Phi_{str}^{{PHY}_a}=\\underbrace{f_{NF}^{{PHY}_a}+\\left[{1-f}_{NF}^{{PHY}_a}\\right]\\Phi_N^{{PHY}_a}\\left({NO}_3,{NH}_4,{PHY_N}_a\\right)}_{N_{2}\\text{ fixation growth scaling}} \\tag{13.3} \\end{equation}\\] The above discussion relates to photosynthesis and carbon uptake by the phytoplankton community. In addition users must choose one of two options to model the P, N uptake dynamics for each algal group: a constant nutrient to carbon ratio, or dynamic intracellular stores. For the first model a simple Michaelis-Menten equation is used to model nutrient limitation with a half-saturation constant for the effect of external nutrient concentrations on the growth rate. The internal phosphorus and nitrogen dynamics within the phytoplankton groups can be modelled using dynamic intracellular stores that are able to regulate growth based on the model of Droop (1974). This model allows for the phytoplankton to have dynamic nutrient uptake rates with variable internal nutrient concentrations bounded by user-defined minimum and maximum values (e.g., see Li et al., 2013). The uptake of nitrogen must be partitioned into uptake of NO3, NH4 and potentially labile DON. In the present version, distinction between uptake of NO3 and NH4 is calculated automatically via a preference factor: \\[\\begin{equation} {\\ p}_{NH4}^{{PHY}_a}=\\frac{{NO}_3\\ {NH}_4}{\\left({NH}_4+K_N^{{PHY}_a}\\right)\\left({NO}_3+K_N^{{PHY}_a}\\right)}\\frac{{NH}_4{\\ K}_N^{{PHY}_a}}{\\left({NH}_4+{NO}_3\\right)\\left({NO}_3+K_N^{{PHY}_a}\\right)} \\tag{13.4} \\end{equation}\\] \\[\\begin{equation} p_{NO3}^{{PHY}_a}=1-{\\ p}_{NH4}^{{PHY}_a} \\tag{13.5} \\end{equation}\\] For diatom groups, silica processes are simulated that include uptake of dissolved silica. The silica limitation function for diatoms is similar to the constant cases for nitrogen and phosphorus which assumes a fixed C:Si ratio. Respiration, Excretion &amp; Mortality Metabolic loss of nutrients from mortality and excretion is proportional to the internal nitrogen to chla ratio multiplied by the loss rate and the fraction of excretion and mortality that returns to the detrital pool. Loss terms for respiration, natural mortality and excretion are modelled with a single ‘respiration’ rate coefficient. This loss rate is then divided into the pure respiratory fraction and losses due to mortality and excretion. The constant \\(f_{DOM}\\) is the fraction of mortality and excretion to the dissolved organic pool with the remainder into the particulate organic pool. Nutrient losses through mortality and excretion for the internal nutrient model are similar to the simple model described above, except that dynamically calculated internal nutrient concentrations are used. \\[\\begin{align*} \\hat{R}&amp;=R_{resp}^{{PHY}_a}\\ \\ \\Phi_{sal}^{{PHY}_a}\\left(S\\right)\\ \\ \\left(\\vartheta_{resp}^{{PHY}_a}\\right)^{T-20} \\tag{13.6}\\\\ f_{resp}^{{PHY_C}_a}&amp;=k_{fres}^{{PHY}_a}\\ \\hat{R}\\ \\left[{PHY_C}_a\\right] \\tag{13.7}\\\\ f_{excr}^{{PHY_C}_a}&amp;=\\left(1-k_{fres}^{{PHY}_a}\\right)\\ k_{fdom}^{{PHY}_a}\\ \\hat{R}\\ \\ \\left[{PHY_C}_a\\right] \\tag{13.8}\\\\ f_{mort}^{{PHY_C}_a}&amp;=\\left(1-k_{fres}^{{PHY}_a}\\right)\\ \\left({1-k}_{fdom}^{{PHY}_a}\\right)\\ \\hat{R}\\ \\left[{PHY_C}_a\\right] \\tag{13.9}\\\\ f_{excr}^{{PHY_N}_a}&amp;=k_{fdom}^{{PHY}_a}\\ \\hat{R}\\ \\left[{PHY_N}_a\\right] \\tag{13.10}\\\\ f_{mort}^{{PHY_N}_a}&amp;=\\left(1-k_{fdom}^{{PHY}_a}\\right)\\ \\hat{R}\\ \\left[{PHY_N}_a\\right] \\tag{13.11}\\\\ f_{excr}^{{PHY_P}_a}&amp;=k_{fdom}^{{PHY}_a}\\ \\hat{R}\\ \\left[{PHY_P}_a\\right] \\tag{13.12}\\\\ f_{mort}^{{PHY_P}_a}&amp;=\\left(1-k_{fdom}^{{PHY}_a}\\right)\\ \\hat{R}\\ \\ \\left[{PHY_P}_a\\right] \\tag{13.13}\\\\ f_{excr}^{{PHY_{Si}}_a}&amp;=\\hat{R}\\ \\left[{PHY_{Si}}_a\\right] \\tag{13.14} \\end{align*}\\] The salinity effect on mortality is given by various quadratic formulations, depending on the groups sensitivity to salinity (Griffin et al 2001; Robson and Hamilton, 2004). An example of the use of various salinity limitation options is shown in Figure 3. 13.3.2 Variable Summary State Variables Table 13.1: Phytoplankton - state variables AED name Symbol Description Unit Type Typical Range Comments aed_phytoplankton PHY_{group} \\[\\mathbf{DOC_R}\\] phytoplanton group water column concentration \\[\\small{mmol\\: C/m^3}\\] pelagic NA select group using index from aed_phyto_pars database PHY_{group}_IN \\[\\mathbf{DON_R}\\] internal nitrogen concentration of phytoplakton group \\[\\small{mmol\\: N/m^3}\\] pelagic 0 - 200 activated when simINDynamics &amp;gt;1 PHY_{group}_IP \\[\\mathbf{DOP_R}\\] internal phosphorus concentration of phytoplakton group \\[\\small{mmol\\: P/m^3}\\] pelagic 7 - 9 activated when simIPDynamics &amp;gt;1 PHY_{group}_rho \\[\\mathbf{CPOM}\\] coarse particulate organic matter \\[\\small{mmol\\: C/m^3}\\] pelagic 0 - 500 CPOM activated by setting simRpools=T PHY_mpb \\[\\mathbf{CPOM}\\] coarse particulate organic matter \\[\\small{mmol\\: C/m^2}\\] benthic 0 - 500 CPOM activated by setting simRpools=T Dependent variables CAR_dic \\[\\mathbf{DIC}\\] dissolved inorganic carbon concentration \\[\\small{mmol\\: C/m^3}\\] pelagic NA optionally linked NIT_amm \\[\\mathbf{NH_4}\\] dissolved ammonium concentration \\[\\small{mmol\\: N/m^3}\\] pelagic NA optionally linked PHS_frp \\[\\mathbf{PO_4}\\] dissolved phosphate concentration \\[\\small{mmol\\: P/m^3}\\] pelagic NA optionally linked OXY_oxy \\[\\mathbf{O_2}\\] dissolved oxygen concentration \\[\\small{mmol\\: O_2/m^3}\\] pelagic 0 - 500 optionally linked NIT_nit \\[\\mathbf{NO_3}\\] dissolved nitrate concentration \\[\\small{mmol\\: N/m^3}\\] pelagic NA optionally linked OGM_doc \\[\\mathbf{DOC}\\] dissolved organic carbon concentration \\[\\small{mmol\\: C/m^3}\\] pelagic 0 - 5000 optionally linked OGM_poc \\[\\mathbf{POC}\\] particulate organic carbon concentration \\[\\small{mmol\\: C/m^3}\\] pelagic NA optionally linked OGM_don \\[\\mathbf{DON}\\] dissolved organic nitrogen concentration \\[\\small{mmol\\: N/m^3}\\] pelagic NA optionally linked OGM_pon \\[\\mathbf{PON}\\] particulate organic nitrogen concentration \\[\\small{mmol\\: N/m^3}\\] pelagic NA optionally linked OGM_dop \\[\\mathbf{DOP}\\] dissolved organic phosphorus concentration \\[\\small{mmol\\: P/m^3}\\] pelagic NA optionally linked OGM_pop \\[\\mathbf{POP}\\] particulate organic phosphorus concentration \\[\\small{mmol\\: P/m^3}\\] pelagic NA optionally linked SIL_rsi \\[\\mathbf{RSi}\\] NA \\[\\small{mmol\\: Si/m^3}\\] NA NA NCS_resus \\[\\mathbf{\\mathcal{F}}}_{resus}\\] sediment resuspension rate \\[\\small{g/m^2/s}\\] benthic 0 - 10 required for PHY resuspension, set via resus_link NA NA NA NA NA NA Table 13.2: State variables Variable Name Description Units Variable Type Core/Optional PHY_{Group} Phytoplanton group \\(mmol\\,m^{-3}\\) Pelagic Core PHY_{Group}_IN Internal nitrogen of phytoplakton group x NA NA Optional PHY_{Group}_IP Internal phosphorus of phytoplakton group x NA NA Optional Diagnostics Table 13.3: Diagnostics Variable Name Description Units Variable Type Core/Optional PHY_tchla Total chlorophyll-a \\(ug\\,L^{-1}\\) Pelagic diagnostic Core PHY_GPP Gross primary production \\(mmol C\\,m^{-3}\\,day^{-1}\\) Pelagic diagnostic Core PHY_{group}_f(I/T/S/N/P/Si) Phytoplankton growth limitation of light/nutrients NA Pelagic diagnostic Core PSED_PHY Phytoplankton sedimentation \\(mmol\\,m^{-2}\\,s^{-1}\\) NA NA PHY_NCP Net community production \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_NUP Nitrogen uptake \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_PUP Phosphorus uptake \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_CUP Carbon uptake \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_PAR Photosynthetically active radiation \\(W\\,m^{-2}\\) NA NA PHY_IN Phytoplankton nitrogen \\(mmol\\,m^{-3}\\) NA NA PHY_IP Phytoplankton phosphorus \\(mmol\\,m^{-3}\\) NA NA PHY_MBP Microphytobenthos \\(mmol\\,m^{-2}\\) NA NA PHY_BPP Benthic productivity \\(mmol\\,m^{-2}\\,day^{-1}\\) NA NA PHY_MPBV Microphytobenthos vertical ewxchange \\(mmol\\,m^{-2}\\,day^{-1}\\) NA NA PHY_PPR Gross phytoplankton p/r ratio NA NA NA PHY_NPR Net phytoplankton p/r ratio NA NA NA PHY_{Group}_NtoP NA NA NA NA 13.3.3 Parameter Summary Table 13.4: Diagnostics p_name ‘Peridinium’ ‘cyano’ ‘green’ ‘karlodinium’ ‘phy05’ ‘phy06’ ‘diatom’ ‘crypto’ ‘cryptophyte’ ‘chlorophyte’ ‘synechococcus’ ‘MICROCYSTIS’ ‘Cyanobacteria’ ‘Cyanobacteria’ ‘n_spumigena’ ‘Peridinium’ ‘Microcystis’ ‘Microcystis(1)’ ‘Aphanizomenon’ ‘Nanoplankton’ ‘Cayelan_Test’ string Name of phytoplankton group GENERAL parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA p_initial 1.0000 10.0000 0.0400 10.0000 10.0000 10.0000 10.0000 8.4000 2.4000 10.0000 10.0000 10.0000 200.0000 10.0000 10.0000 2.81e+00 102.0000 2.81e+00 2.81e+00 2.81e+00 2.81e+00 real Initial concentration of phytoplankton (mmol C/m3) p0 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 5.0000 0.0300 0.0300 3.00e-02 0.0300 3.00e-02 3.00e-02 3.00e-02 3.00e-02 real Minimum concentration of phytoplankton (mmol C/m3) w_p 0.0000 0.0000 -0.0100 0.0000 0.0000 0.0000 -0.1040 -0.1040 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 real sedimentation rate (m/d) Xcc 50.0000 50.0000 40.0000 50.0000 50.0000 50.0000 40.0000 40.0000 40.0000 50.0000 50.0000 50.0000 40.0000 40.0000 50.0000 5.50e+01 50.0000 9.20e+01 7.70e+01 8.00e+01 7.70e+01 real carbon to chlorophyll ratio (mg C/mg chla) GROWTH parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA R_growth 1.1000 1.1000 0.7000 1.1000 1.1000 1.1000 2.8000 1.1000 0.7000 1.1000 1.1000 1.1000 0.5300 1.1000 1.1000 3.50e-01 1.1000 7.00e-01 4.10e-01 2.70e+00 4.10e-01 real Phyto max growth rate (20C?) (/day) fT_Method 1.0000 1.0000 0.0000 1.0000 1.0000 1.0000 0.0000 0.0000 0.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 0.00e+00 1.00e+00 integer Specifies temperature limitation function of growth (-); 0 = no temperature limitation 1= CAEDYM style theta_growth 1.0600 1.0600 1.0800 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0800 1.0600 1.0600 1.07e+00 1.0600 1.07e+00 1.10e+00 1.07e+00 1.10e+00 real Arrenhius temperature scaling for growth function (-) T_std 20.0000 20.0000 20.0000 20.0000 20.0000 20.0000 15.0000 15.0000 20.0000 20.0000 20.0000 20.0000 20.0000 20.0000 20.0000 1.90e+01 20.0000 1.90e+01 2.40e+01 2.00e+01 2.40e+01 real Standard temperature (deg C) T_opt 28.0000 28.0000 27.0000 28.0000 28.0000 28.0000 20.0000 20.0000 28.0000 28.0000 28.0000 28.0000 28.7000 28.0000 28.0000 2.40e+01 28.0000 2.60e+01 2.90e+01 2.70e+01 2.90e+01 real Optimum temperature (deg C) T_max 35.0000 35.0000 33.0000 35.0000 35.0000 35.0000 32.0000 32.0000 34.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 3.20e+01 35.0000 3.50e+01 3.40e+01 3.50e+01 3.40e+01 real Maximum temperature (deg C) LIGHT parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA lightModel 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Type of light response function [0 = no photoinhibition; 1 = photoinhibition] I_K 25.0000 25.0000 25.0000 25.0000 25.0000 25.0000 10.0000 10.0000 25.0000 25.0000 25.0000 25.0000 228.0000 25.0000 25.0000 1.75e+01 25.0000 1.75e+01 1.75e+01 1.75e+01 1.75e+01 real Half saturation constant for light limitation of growth (microE/m2/s) used if lightModel=0 I_S 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 230.0000 100.0000 100.0000 6.00e+02 100.0000 1.50e+02 8.00e+01 4.00e+02 8.00e+01 real saturating light intensity (microE/m2/s) used if lightModel=1 KePHY 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0010 0.0010 0.0050 0.0050 0.0050 0.0050 0.0000 0.0050 0.0050 1.20e-04 0.0050 1.20e-04 1.20e-04 1.20e-04 1.20e-04 real Specific attenuation coefficient ((mmol C m3-1)1 m-1) RESPIRATION parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA f_pr 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0020 0.0020 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 4.00e-03 0.0050 4.00e-03 4.00e-03 4.00e-03 4.00e-03 real Fraction of primary production lost to exudation (-) R_resp 0.0800 0.0800 0.0120 0.0800 0.0800 0.0800 0.1200 0.1200 0.0120 0.0800 0.0800 0.0800 0.0800 0.0800 0.0800 6.60e-02 0.0800 6.60e-02 6.60e-02 6.60e-02 6.60e-02 real Phytoplankton respiration/metabolic loss rate @ 20 (degC) theta_resp 1.0500 1.0500 1.0600 1.0500 1.0500 1.0500 1.0700 1.0700 1.0500 1.0500 1.0500 1.0500 1.0500 1.0500 1.0500 1.05e+00 1.0500 1.05e+00 1.05e+00 1.05e+00 1.05e+00 real Arrhenius temperature scaling factor for respiration (-) k_fres 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 2.50e-01 0.6000 2.50e-01 2.50e-01 2.50e-01 2.50e-01 real Fraction of metabolic loss that is true respiration (-) k_fdom 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 2.00e-01 0.0500 2.00e-01 2.00e-01 2.00e-01 2.00e-01 real Fraction of metabolic loss that is DOM (-) SALINITY parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA salTol 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Type of salinity limitation function (-) S_bep 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.00e+00 2.0000 2.00e+00 2.00e+00 2.00e+00 2.00e+00 real Salinity limitation value at maximum salinity S_maxsp (-) S_maxsp 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 3.50e+01 35.0000 3.50e+01 3.50e+01 3.50e+01 3.50e+01 real Maximum salinity (g/kg) S_opt 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 1.00e+00 1.00e+00 real Optimal salinity (g/kg) NITROGEN parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA simDINUptake 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 1.00e+00 1.00e+00 integer Simulate DIN uptake (0 = false 1 = true) simDONUptake 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Simulate DON uptake (0 = false 1 = true) simNFixation 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Simulate N fixation (0 = false 1 = true) simINDynamics 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.00e+00 2.0000 2.00e+00 2.00e+00 2.00e+00 2.00e+00 integer Simulate internal N (0 = assumed fixed C:N 2 = dynamic C:N) N_o 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 2.50e-01 0.2500 2.50e-01 2.50e-01 2.50e-01 2.50e-01 real Nitrogen concentraion below which uptake is 0 (mmol N/m3) K_N 4.0000 4.0000 3.2100 4.0000 4.0000 4.0000 3.5700 3.5700 3.2100 4.0000 4.0000 4.0000 4.0000 4.0000 4.0000 3.39e+00 4.0000 3.39e+00 3.39e+00 3.39e+00 3.39e+00 real Half-saturation concentration of nitrogen (mmol N/m3) X_ncon 232342.0000 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 3.50e-02 0.0350 3.50e-02 3.50e-02 3.50e-02 3.50e-02 real Constant internal nitrogen concentration (mmol N/ mmol C) used if simINDynamics = 0 or 1 X_nmin 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 3.00e-03 0.0200 2.00e-03 1.70e-02 7.00e-03 1.70e-02 real minimum internal nitrogen concentration (mmol N/ mmol C) used if simINDynamics = 2 X_nmax 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 6.00e-03 0.0700 5.00e-03 9.00e-03 2.80e-02 9.00e-03 real maximum internal nitrogen concentration (mmol N/ mmol C) used if simINDynamics = 2 R_nuptake 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 2.00e-02 0.0200 2.00e-02 2.00e-02 2.00e-02 2.00e-02 real maximum nitrogen uptake rate(mmol N/m3/d) used if simINDynamics = 2 k_nfix 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 7.00e-01 0.7000 7.00e-01 7.00e-01 7.00e-01 7.00e-01 real growth rate reduction under maximum nitrogen fixation (/day) used if simNFixation &gt;0 R_nfix 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.00e+00 0.0350 0.00e+00 1.20e-02 0.00e+00 1.20e-02 real nitrogen fixation rate (mmol N/mmol C/day) PHOSPHORUS parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA simDIPUptake 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 1.00e+00 1.00e+00 integer Simulate DIP uptake (0 = false 1 = true) simIPDynamics 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.00e+00 2.0000 2.00e+00 2.00e+00 2.00e+00 2.00e+00 integer Simulate internal phosphorus dynamics (0 = assumed fixed C:P 2 = dynamic C:P) P_0 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 3.00e-02 0.0300 3.00e-02 3.00e-02 3.00e-02 3.00e-02 real Phosphorus concentraion below which uptake is 0 (mmol P/m3) K_P 0.1500 0.1500 0.1600 0.1500 0.1500 0.1500 0.1600 0.1600 0.1600 0.1500 0.1500 0.1500 0.1500 0.1500 0.1500 7.74e-05 0.1500 5.80e-05 3.87e-05 4.51e-05 3.87e-05 real Half-saturation concentration of phosphorus (mmol P/m3) X_pcon 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 1.50e-03 0.0015 1.50e-03 1.50e-03 1.50e-03 1.50e-03 real Constant internal phosphorus concentration (mmol P/ mmol C) used if simIPDynamics = 0 or 1 X_pmin 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.00e+00 0.0005 3.00e-03 6.00e-03 3.00e-03 6.00e-03 real Minimum internal phosphorus concentration (mmol P/mmol C) used if simIPDynamics = 2 X_pmax 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 1.00e-03 0.0050 1.90e-02 5.02e-01 1.20e-02 5.02e-01 real Maximum internal phosphorus concentration (mmol P/mmol C) used if simIPDynamics = 2 R_puptake 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 1.00e-03 0.0010 1.00e-03 1.00e-03 1.00e-03 1.00e-03 real Maximum phosphorus uptake rate(mmol P/m3/d) used if simIPDynamics = 2 SILICA parameter NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA simSiUptake 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Simulate Si uptake (0 = false 1 = true) Si_0 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 3.00e-01 0.3000 3.00e-01 3.00e-01 3.00e-01 3.00e-01 real Silica concentraion below which uptake is 0 (mmol Si/m3) K_Si 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.50e+00 2.5000 2.50e+00 2.50e+00 2.50e+00 2.50e+00 real Half-saturation concentration of silica (mmol Si /m3) X_sicon 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 4.00e-01 0.4000 4.00e-01 4.00e-01 4.00e-01 4.00e-01 real Constant interal silica concentration (mmol Si/mmol C) 13.3.4 Optional Module Links 13.3.5 Feedbacks to the Host Model 13.4 Setup &amp; Configuration 13.4.1 Setup Example Table 13.5: Parameters and configuration Parameter Name Description Units Parameter Type Default Typical Range Comment num_phytos Number of phytoplankton groups NA Integer NA 0-7 NA the_phytos List of ID’s of groups in aed_phyto_pars.nml (len=num_phyto) NA Integer NA 1/7/17 NA X_excretion_target_variable State variable to receive C, N or P from excretion NA String NA NA NA X_mortality_target_variable State variable to receive C, N or P from mortality NA String NA NA NA X_uptake_target_variable State variable to be linked C, N, P, Si or O2 uptake NA String NA NA NA settling Settling calculation method NA Integer NA 1/3/17 NA do_mpb Switch to enable microphytobenthos calculations NA float NA NA NA R_mpbg Maximum rate of MPB growth \\(mmol C\\,m^{-3}\\,day^{-1}\\) Float 5.00E-01 NA NA R_mpbr Maximum rate of MPB respiration \\(mmol C\\,m^{-3}\\,day^{-1}\\) Float 5.00E-02 NA NA I_Kmpb Half saturation constant for light limitation of MPB growth \\(microE\\,m^{-2}\\,s^{-1}\\) Float 100 NA NA mpb_max Maximum MPB biomass NA Float 2000 NA NA resuspension Resuspension rate of phytoplankton group x NA Float NA NA NA resus_link Resuspension link variable NA String NA NA NA n_zones Total number of active material zones NA Integer NA NA NA active_zones AActive material Zone ID’s NA Array NA NA NA dbase Link to phy database NA String NA NA NA extra_diag Include extra diags in nc output NA Boolean .false. NA NA min_rho Minimum phytoplankton density \\(kg\\,m^{-3}\\) Float 900 NA NA max_rho Maximum phytoplankton density \\(kg\\,m^{-3}\\) Float 1200 NA NA An example nml block for the phytoplankton module is shown below: Users must supply a valid “aed_phyto_pars.nml” file. &amp;aed2_phytoplankton !-- Configure phytoplankton groups to simulate num_phytos = 1 the_phytos = 1 settling = 1 !-- Benthic phytoplankton group (microphytobenthos) do_mpb = 1 R_mpbg = 0.5 R_mpbr = 0.05 I_Kmpb = 100. mpb_max = 2000. resuspension = 0.45 resus_link = &#39;TRC_resus&#39; n_zones = 4 active_zones = 2,3,4,5 !-- Set link variables to other modules p_excretion_target_variable=&#39;OGM_dop&#39; n_excretion_target_variable=&#39;OGM_don&#39; c_excretion_target_variable=&#39;OGM_doc&#39; si_excretion_target_variable=&#39;&#39; p_mortality_target_variable=&#39;OGM_pop&#39; n_mortality_target_variable=&#39;OGM_pon&#39; c_mortality_target_variable=&#39;OGM_poc&#39; si_mortality_target_variable=&#39;&#39; p1_uptake_target_variable=&#39;PHS_frp&#39; n1_uptake_target_variable=&#39;NIT_nit&#39; n2_uptake_target_variable=&#39;NIT_amm&#39; si_uptake_target_variable=&#39;SIL_rsi&#39; do_uptake_target_variable=&#39;OXY_oxy&#39; c_uptake_target_variable=&#39;&#39; !-- General options dbase = &#39;../External/AED2/aed2_phyto_pars.nml&#39; extra_diag = .false. !zerolimitfudgefactor = ?? min_rho = 900. max_rho = 1200. / 13.5 Case Studies &amp; Examples 13.5.1 Case Study &lt;&lt;&lt;&lt;&lt;&lt;&lt; Updated upstream #case 1 case1 &lt;- data.frame( par_c = double(), I_K = double(), fI = double() ) for(i in seq(10, 500, by = 10)){ case1_temp &lt;- data.frame( par_c = seq(0, 2000, by = 10), I_K = i ) case1_temp\\(fI &lt;- (case1_temp\\)par_c/case1_temp\\(I_K)/(1+(case1_temp\\)par_c/case1_temp$I_K)) case1 &lt;- bind_rows(case1,case1_temp) } #case 4 case4 &lt;- data.frame( par_c = double(), I_K = double(), fI = double() ) for(i in seq(10, 500, by = 10)){ case4_temp &lt;- data.frame( par_c = seq(0, 2000, by = 10), I_K = i ) case4_temp\\(fI &lt;- tanh(case4_temp\\)par_c/case4_temp$I_K) case4 &lt;- bind_rows(case4,case4_temp) } #case 3 case3 &lt;- data.frame( par_c = double(), I_K = double(), fI = double() ) for(i in seq(10, 500, by = 10)){ case3_temp &lt;- data.frame( par_c = seq(0, 2000, by = 10), I_K = i ) case3_temp\\(fI &lt;- 1 - exp(-(case3_temp\\)par_c/case3_temp$I_K)) case3 &lt;- bind_rows(case3,case3_temp) } #create plot fig &lt;- plot_ly() fig &lt;- fig %&gt;% add_trace( case1, name=“Case 1,” x = case1\\(par_c, y = case1\\)fI, frame = case1\\(I_K, hovertemplate = &#39;fI: %{y:.2f}&lt;extra&gt;&lt;/extra&gt;&#39;, type = &#39;scatter&#39;, mode = &#39;lines&#39;) fig &lt;- fig %&gt;% add_trace( case3, name=&quot;Case 3&quot;, x = case3\\)par_c, y = case3\\(fI, frame = case3\\)I_K, hovertemplate = ‘fI: %{y:.2f},’ type = ‘scatter,’ mode = ‘lines’) fig &lt;- fig %&gt;% add_trace( case4, name=“Case 4,” x = case4\\(par_c, y = case4\\)fI, frame = case4$I_K, hovertemplate = ‘fI: %{y:.2f},’ type = ‘scatter,’ mode = ‘lines’) fig &lt;- fig %&gt;% layout( hovermode = “x unified,” xaxis = list(title=‘Light (PAR),’hoverformat = “Light (PAR)”), yaxis = list(title=‘Photosynthesis (fI)’) ) %&gt;% animation_opts( 250, easing = “linear,” redraw = FALSE ) %&gt;% animation_slider( currentvalue = list(prefix = “I_K:”) ) %&gt;% config(displayModeBar = FALSE, displaylogo = FALSE) fig ``` ======= &gt;&gt;&gt;&gt;&gt;&gt;&gt; Stashed changes 13.5.2 Publications "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
