[["index.html", "The AED Manual Modelling Aquatic Eco-Dynamics: Overview of the AED modular simulation platform Welcome How to Contribute? Editing the Book Supporting the project", " The AED Manual 2021-09-06 Modelling Aquatic Eco-Dynamics: Overview of the AED modular simulation platform Welcome This is the online home of Modelling Aquatic Eco-Dynamics, a book on describing the AED (previously released as AED2) modelling platform for the simulation of aquatic ecosystem dynamics. Inspired by bookdown and the Open Data movement in ecology and the environmental sciences (e.g., Read et al., 2015), this book is open source. This encourages a collaborative approach to model development and discussion and ensures the approaches adopted by the user-community are reproducible and publicly accessible for people worldwide. The model platform has been applied to many diverse sites across the globe (Figure 0.1) and we hope it can be useful to help with your application! Figure 0.1: Locations How to Contribute? You may be a new user seeking to understand how to get started, or you may interested to tailor a module to your research or management application. As modules evolve, through incremental improvements or wholesale changes, the experts working on these changes can ensure the latest information is available to the community by updating and improving this book. bookdown makes editing a book as easy as editing a wiki, provided you have a GitHub account (sign-up at github.com). Once logged-in to GitHub, click on the ‘edit me’ icon highlighted with a red ellipse in the image below. This will take you to an editable version of the the source R Markdown file that generated the page you’re on: To raise an issue about the book’s content (e.g. code not running) or make a feature request, check-out the issue tracker. Readers may also use the hypothes.is utility on the right margin of the book to add personal annotations and public comments on the book content. Maintainers and contributors must follow this repository’s CODE OF CONDUCT. Editing the Book To build the book locally, clone or download the aed-science repo, load R in root directory (e.g. by opening aed-sceince.Rproj in RStudio) and run the following lines: bookdown::render_book(&quot;index.Rmd&quot;) # to build the book browseURL(&quot;_book/index.html&quot;) # to view it Supporting the project If you find AED useful, please support it by: Telling people about it in person Communicating about the model in digital media e.g. via the #xxxxxx hashtag on Twitter (see our Guestbook at geocompr.github.io) or by letting us know of courses using the book Citing or linking-to it ‘Starring’ the geocompr GitHub repository Reviewing it, e.g. on Amazon or Goodreads Asking questions about or making suggestion on the content via GitHub or Twitter. Buying a copy This work is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. "],["foreward.html", "Foreward", " Foreward "],["preface.html", "Preface Who is this book for? Why AED? Acknowledgements", " Preface Who is this book for? This book describes the scientific basis and technical details of the module within the AED library. If you’re a new user seeking to get started with water quality modelling you may have undertaken a tutorial and interested to setup your own site for the first time. Or you may have your own conceptual model and keen to build a tailored setup to simulate your site. Or you may be ready to modify a module or create a whole new module for your research or management application. Depending at what stage you are at in your model development journey, different parts of the book may be more relevant to you. Why AED? The AED modelling code-base is a community-driven library of modules and algorithms for simulation of “aquatic ecodynamics” - water quality, aquatic biogeochemistry, biotic habitat and aquatic ecosystem dynamics. The AED software is unique as it is suitable for a very wide range water bodies types, including lakes, reservoirs, wetlands, ponds, estuaries and coastal waters. It has been applied to many research and water engineering projects across the world. Users select water quality and ecosystem variables they wish to simulate and are able to customize links and dependencies between modules. Each module aims to be based on state-of-the-art science sourced from a wide variety of scientific literature, making the library one of the most advanced available to aquatic ecosystem modellers. Importantly, this software is an open-source project, and the source code is accessible and customisable for specific applications. Most modules have numerous options and alternate algorithms so users can tailor the model to their specific needs, but inevitably, users will require flexibility to embed custom algorithms or functionality. It is envisaged that the flexible nature of the model components will facilitate the model community to experiment with model structural complexity, to more easily share model innovations at the algorithm level, and support the development of common performance assessment approaches (for a discussion on model assessment, readers are referred to Hipsey et al., 2020). Acknowledgements "],["introduction.html", "1 Introduction Scientific Overview Application Contexts Navigating this book", " 1 Introduction Scientific Overview The AED modelling library (termed ‘AED’ for short) consists of numerous modules that are designed as individual model ‘components’ able to be configured in a way that facilitates custom aquatic ecosystem conceptualisations – from very simple to very complex. Think of it like a set of jigsaw pieces that connect together to build a complete picture. Users select water quality and ecosystem variables they wish to simulate and then are able to customize connections and dependencies with other modules, including support for easy customisation at an algorithm level how model components operate (e.g. photosynthesis functions, sorption algorithms etc). In general, model components consider the cycling of carbon, nitrogen and phosphorus, and other relevant components such as oxygen, and are able to simulate organisms including different functional groups of phytoplankton and zooplankton, and also organic matter. Modules to support simulation of water column and sediment geochemistry, including coupled kinetic-equilibria, are also included. Application Contexts The modules have been applied across wetlands, lakes, rivers and estuaries, by taking advantage of the standard coupling interface between the scientific modules and hydrodynamic drivers. Due to this flexibility the model can be applied across a range of scales and contexts. For example through a 0D box model, the 1D model GLM, or the 3D finite volume model TUFLOW-FV. Applications of the model include: Hypoxia in lakes or estuaries Fish-kill risks Harmful algal blooms Pathogen risk Nutrient cycling Greenhouse-gases Habitat quality Floodplain response Invasive species Food web studies Navigating this book This is not the sought of book you read from cover to cover! The book has initial introductory material in the first 4 chapters, and then is followed by 5 major sections: Part I: AED Water - Descriptions of the core “water” modules, those relevant to simulating basic water quality in the pelagic environment. Part II: AED+ Water - Description of the advanced “plus” water modules. Part III: AED+ Benthic - Description of the advanced benthic modules. Part IV: AED+ Riparian - Description of the advanced riparian modules. Part V: Supporting Material. The chapters within the Parts I-IV of the book typically map to a specific module within the AED code library. Each describes the scientific context of the module, provides technical descriptions for the model processes, and the provides summary information on the required module parameters, and configuration details. Where available, the modules also include case-studies to demonstrate the functionality and publications using the module that can be referred to for further information. "],["nomenclature.html", "2 Nomenclature 2.1 Variables and Data Types 2.2 A Note on Notation", " 2 Nomenclature 2.1 Variables and Data Types There is often confusion over the types of variables and data-types used within the modules. Standard terminology adopted in the \\(\\mathrm{AED}\\) system is described in Table 2.1. Table 2.1 Table 2.1: Variables and data types State variable A state variable is a primary variable being simulated within the cells of the computational domain, and which is subject to transport or boundary conditions as controlled by the host model. Generally, state variables are subject to solution of an Ordinary Differential Equation (ODE) to predict their time-varying conditions within AED, in addition to transport by the host. State variables can be “normal” in which case they exist in all water cells, or they can be “sheet” in which case they are used for surface or benthic attributes (these are typically called “3D” and “2D,” or “pelagic” and “benthic,” respectively, though are still relevant in 1D models like GLM). Diagnostic variable A diagnostic variable is a property of interest defined on the computational domain, and available to be output by the host model for plotting and post-processing. Typically, diagnostic variables include derived measure of model state, integrated values, process rates or other cell-specific attributes of interest for debugging. Importantly, diagnostic variables are not subject to transport or boundary conditions as are state variables. Diagnostic variables can be “normal” in which case they exist in all water cells, or they can be “sheet” in which case they are used for surface or benthic attributes (these are typically called 3D and 2D, respectively, though are still relevant in 1D models like GLM). Environment variable An environment variable in AED is a variable managed by the host model but is required by AED for computation of module-specific dynamics. This typically relate to predictions of the host model such as temperature, salinity and velocity, but can also include features of the domain, including benthic material type or cell thickness. Boundary condition A boundary condition is a driving variable external to the simulation dynamics, such as weather or flow. In most cases in AED these are handled by the host model, and passed to AED modules as environment vars (e.g. wind, solar radiation etc). Process rate A process rate in AED refers to a flux pathway, ie. a mass or energy flux connecting two variables or more variables. Generally these are units of concentration per time. Parameter - constant A constant parameter is a fixed value over the course of the simulation associated with a process calculation, unit conversion etc. This will be in a variety of units. These values are not accessible outside of the specific module in which they are declared. Parameter - variable A variable parameter is a value over associated with a process calculation, or related attribute, that can vary between computational cells, and/or from time to time depending on local conditions. These values are not accessible outside of the specific module in which they are declared, unless the spatiotemporal varying parameters are also stored as “diagnostic” variables, where they can be linked to other modules and output for post-processing assessment. Option An option is an integer or Boolean “switch” used to enable a feature in a module, or select a specific algorithm or function 2.2 A Note on Notation The modules being described in this book each list the specific simulated variables and parameters, with summaries of the module specific notations. For consistency across the modules a standard mathematical notation is adopted. 2.2.1 General Notation The following symbols are used to denote commonly used variables: \\(t\\) = time \\(N\\) = number of groups (integer) \\(a, om, z\\) = indices of various biological sub-groups, such as algae/phytoplankton, organic matter and zooplankton (integer) \\(\\chi_{C:Y}^{group}\\) = the stoichiometric ratio of “\\(group\\)” between element \"“\\(C\\)”\" and element “\\(Y\\)” (\\(mmol\\) \\(C\\) \\(/\\) \\(mmol\\) \\(Y\\)) \\(f_{process}^{var}\\) = function that returns the mass flux of “\\(process\\)” on “\\(var\\)” (\\(mmol \\text{ var}/m^3/time\\)) \\(R_{process}^{var}\\) = the relative rate of “\\(process\\)” influencing the variable “\\(var\\)” (\\(/time\\)) \\(F_{process}^{var}\\) = the areal flux of variable “var” due to a “\\(process\\),” applied at the sediment-water or air-water interface (\\(mmol \\text{ var}/m^2\\)) \\(p_{source}^{group}\\) = the preference of “\\(group\\)” for “\\(source\\)” (0-1) \\(\\Phi_{lim}^{group}[var]\\) = dimensionless limitation or scaling function to account for the effect of “\\(lim\\)” on a “\\(group\\)” (-) \\(\\Phi_{lim}^{process}[var]\\) = dimensionless limitation or scaling function to account for the effect of “\\(lim\\)” (limiting) “\\(var\\)” on a “\\(process\\)” (-) \\(k^{var}\\) = generic fraction related to “\\(var\\)” (0-1) \\(\\Theta_{config}^{group}\\) = switch to configure selectable model component “\\(config\\)” for “\\(group\\)” (0,1,2,…) \\(K_{process}^{var}\\) = half-saturation constant associated with a biogeochemical “\\(process\\),” based on the concentration of variable “\\(var\\)” (\\(mmol \\text{ var}/m^3\\)) \\(c,\\theta,\\gamma, \\dotsb\\) = miscellaneous coefficients (various units) 2.2.2 Model Domain and Position The \\(\\mathrm{AED}\\) model links with a variety of models that have diverse approaches to discretize the spatial domain, ranging from an individual ‘box’ to a complex finite-volume mesh. The following standard descriptions are used: \\(c, sz\\) = indices of computational cells, or sediment zones (integer) \\(\\Delta z\\) = generic vertical thickness of a computational cell or layer \\(\\Delta z_{s}\\) = vertical thickness of the surface computational cell or layer \\(\\Delta z_{b}\\) = vertical thickness of the bottom computational cell or layer \\(h\\) = height above a reference point \\(z\\) = depth below water surface \\(d\\) = water depth \\(A\\) = area In the science descriptions within each module the dynamics are referred to usually at a generic point in space for convenience. However, we highlight that most variables and properties are resolved as vectors, spanning the number of cells in the computational domain. Note the following conventions: \\(C\\) = generic use of a variable without a specific spatial position \\(C_c\\) = denoting the value of a variable \\(C\\) at the location of a specific cell, \\(c\\) \\(C_{sz}\\) = denoting the value of a variable \\(C\\) at the location of a specific sediment zone, \\(sz\\) To highlight whether a process is particular to a certain set of cells within the domain we use: \\(f_{process}^{var}\\) = generic use of a function that returns the mass flux of “\\(process\\)” on “\\(var\\)” \\(\\hat{f}_{process}^{var}\\) = use of a function that returns the mass flux of “\\(process\\)” on “\\(var\\)” specific to a benthic process at the sediment-water interface \\(\\check{f}_{process}^{var}\\) = use of a function that returns the mass flux of “\\(process\\)” on “\\(var\\)” specific to a surface process at the air-water interface To differentiate between a symbol that is referring to a scalar or a vector of cells we use: \\(C\\) = generic use of a variable without a specific spatial position \\(\\mathbf{C}\\) = an array of the variable \\(C\\) spanning the model’s 1D, 2D or 3D spatial domain \\(f_{process}^{var}\\) = generic “\\(process\\)” within the model without a specific spatial position \\(\\mathbf{f}_{process}^{var}\\) = an array of of values describing a “\\(process\\),” spanning the model’s 3D spatial domain \\(F_{process}^{var}\\) = generic value or constant describing an areal flux of variable “var” due to a “\\(process\\)” \\(\\mathbf{F}_{process}^{var}\\) = an array of of values describing an areal flux of variable “var” due to a “\\(process\\),” spanning the model’s 2D spatial domain 2.2.3 Environmental Conditions As outlined in Table 2.1, \\(\\mathrm{AED}\\) refers to a specific class of variable denoted an environmental variable. These are provided to the \\(\\mathrm{AED}\\) modules from the host model - that is, they are external drivers of dynamics carried out by \\(\\mathrm{AED}\\). Key variables referred to commonly include: \\(T\\) or \\(T_K\\) = water temperature in Celsius or Kelvin, respectively (\\(^{\\circ}C\\), \\(K\\)) \\(S\\) = water salinity in practical salinity units (\\(psu\\)) \\(I\\) = light intensity (\\(W/m^2\\)) \\(u\\) = generic water velocity (\\(m/s\\)) \\(\\tau\\) = shear stress (\\(N/m^2\\)) Variables outside of the water may also be referred to: \\(U\\) = wind speed, above the domain (\\(m/s\\)) \\(T_a\\) = air temperature (\\(^{\\circ}C\\)) \\(I_0\\) = light intensity incident on the domain (\\(W/m^2\\)) 2.2.4 Transport Reference Frame As \\(\\mathrm{AED}\\) is designed to be agnostic of the host model spatial domain, and the transport of \\(\\mathrm{AED}\\) variables is managed by the host model, this book refers to transport in a generic way. Each simulated state variable is subject to advection and turbulent mixing, plus boundary conditions, as managed by the host hydrodynamic model. The material derivative, \\(\\frac{D}{Dt}\\) is used to depict that the reactions and processes in the \\(\\mathrm{AED}\\) library (those summarised in the module descriptions) are undertaken superimposed on the movement of the water being simulated by the host model. For a generic non-reactive \\(\\mathrm{AED}\\) variable, \\(C\\), this is: \\[\\begin{equation} \\frac{D}{Dt}C = \\frac{\\partial C}{\\partial t} + \\mathbf{u} \\cdot \\nabla C \\tag{2.1} \\end{equation}\\] where \\(\\nabla\\) is the gradient operator, which in the context of a hydrodynamic model, can be used to generically summarise the advection field: \\[\\begin{equation} \\frac{D}{Dt}C = \\frac{\\partial C}{\\partial t} + u\\frac{\\partial C}{\\partial x} + v\\frac{\\partial C}{\\partial y} + w\\frac{\\partial C}{\\partial z} \\tag{2.2} \\end{equation}\\] where \\(u\\), \\(v\\), and \\(w\\) are the water velocity in cartesian coordinates, \\(x\\), \\(y\\), and \\(z\\). As the \\(\\mathrm{AED}\\) model links with hydrodynamic models that use unstructured or non-standard computational domains, the exact transport solution and notation for a given model will necessarily be model-specific, but broadly consistent with the above. Similarly, each model will resolve diffusion and turbulent mixing between computational cells in a unique way. For this reason we simply denote the process of “mixing” using the symbol \\(\\mathbb{M}\\). For a typical RANS hydrodynamic model this would be \\(\\mathbf{u} \\cdot \\nabla^2 C\\). Some models, such as the General Lake Model (Hipsey et al., 2019), may however adopt a “bulk mixing” model, whereby mixing is resolved using a multi-step algorithm that is not so easily summarised. The host model will also have various model-specific approaches for defining the model boundary conditions for simulated \\(\\mathrm{AED}\\) variables. We therefore use the generic symbol \\(\\mathcal{S}\\) to represent sources of mass to a computational cell. \\(\\mathcal{S}\\) will be cell-specific, and would be zero for interior model cells not subject to source terms. Therefore, the rate of change of a generic \\(\\mathrm{AED}\\) variable in an unspecified cell can be summarised as: \\[\\begin{equation} \\frac{D}{Dt}C = \\mathbb{M} + \\mathcal{S} \\quad \\underbrace{\\color{#ED7D31} \\pm \\color{#ED7D31} \\dotsb \\color{#ED7D31} f \\color{#ED7D31} \\dotsb}_{\\text{AED terms}} \\tag{2.3} \\end{equation}\\] where the AED terms on the RHS are the reaction or movement (e.g. settling) processes that are subsequently described throughout the remainder of this book. In summary, generic notation is adopted to denote the effects of advection, mixing and boundary conditions that are managed by the host hydrodynamic model for \\(\\mathrm{AED}\\) simulated variables. Reactions, species interactions, and material or organism redistribution is the focus of the \\(\\mathrm{AED}\\) module library. "],["organisation-of-the-library-module-structure.html", "3 Organisation of the Library &amp; Module Structure 3.1 Library Design 3.2 Model Structure 3.3 Module Summary", " 3 Organisation of the Library &amp; Module Structure 3.1 Library Design The AED modelling library is organised as a series of “modules” that can be connected or “linked” through specific variable dependencies. By linking modules users can simulate most aquatic biogeochemical processes relevant to nutrient cycling, oxygen dynamics, harmful algal blooms, sediment/soil biogeochemistry, vegetation, pathogens etc. Each module can work alone or combined with other modules, depending on the complexity of targeted system. A wide array of modules are available with some operational only in water, some operational where no water is present, and some can operate under both dry and wet conditions. The current AED software is divided into 5 separate code-libraries …… .Prior to the 2020 release, the model was distributed as two libraries: the first was the core AED2 library (libaed2) and the second is the advanced modules which are bundled together as AED2+ (libaed2-plus). Currently there are 8 core modules in AED2, and 12 advanced modules in AED2+. For routine water quality assessments of lakes or estuaries, AED2 will suit most applications. For advanced users and researchers seeking to extend their simulation abilities, then AED2+ includes numerous advanced options 3.2 Model Structure The philosophy of the AED/AED2 library is that biogeochemical and ecological modules have a standard class structure. State variables defined within each module are subject to transport and mass conservation, as managed by the scalar transport facility of the host hydrodynamic model (see Section 4). Any AED module can have the ability to simulate a range of physical, chemical and biological processes, that can be generally classified as belonging to: Feedback of chemical or biological attributes to physical properties of water (light extinction, drag, density) Water column kinetic (time-varying) chemical / biological transformations (e.g., denitrification or algal growth) Water column equilibrium (instantaneous) chemical transformations (e.g., PO4 adsorption) Biogeochemical transformations in the sediment or biological changes in the benthos Vertical sedimentation or migration Fluxes across the air-water interface Fluxes across the sediment-water interface Fluxes across the terrestrial-water interface (riparian interactions) Ecohydrological dynamics and biogeochemical transformations in the exposed (dry) cells Feedbacks of soil and vegetation dynamics onto lake hydrodynamics and water balance A general module structure in Figure X. Specific methods available within a module include those in Table Y. Note that not all methods must be used in modules; developers must choose which methods are relevant to a specific module. The only exception is “define,” which is compulsory for all modules to configure the chosen state variables, diagnostic variables, and set the necessary parameters and options. 3.3 Module Summary A high level overview of the simulatable modules are include in Table 3.1 below. /* Style the buttons inside the tab */ .tab button { background-color: #2481AA; float: left; width: 50%; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 17px; color: #FFFFFF; font-weight: bold; } AED-water AED-benthic Table 3.1: Modules Module Description Relevant Variables TRC: Tracers, Suspended Soilds and Retention Time Modellers can use the aed_tracer to simulate a dissolved or particulate tracer (subject to transport processes only), or this can be optionally configured to account for decay, sedimentation and/or resuspension. This module also include an option to simulate water “retention time” where the water age increments once enters into the waterbody C,\\(t_{ret}\\) OXY: Dissolved Oxygen Dissolved oxygen (DO) dynamics are able to be simulated, accounting for atmospheric exchange and sediment oxygen demand, and through links to other modules will account for microbial use during organic matter mineralisation and nitrification, photosynthetic oxygen production and respiratory oxygen consumption, and respiration by other optional biotic components O2 NUT: Inorganic Nutrients Modules exist for simulation of inorganic nutrients including phosphorus, nitrogen and silica. These modules provide basic nutrient cycling functionality and are designed to be linked with other modules (eg OGM, PHY) in order to provide a more comprehensive depiction of nutrient cycling. OGM: Organic Matter Organic matter variables cover the C, N &amp; P stored in the dissolved and particulate organic matter pools. This module optionally also supports depiction of “labile” vs “refractory” fractions of organic matter, including the breakdown and hydrolysis process, photo-degradation and mineralisation. DOM, POM PHY: Phytoplankton Highly customisable phytoplankton module for simulating change in algae, cyano-bacteria and chl-a, including phytoplankton production/respiration, nutrient uptake, excretion, vertical movement (eg buoyancy control), and grazing effects. Benthic phytoplankton may also be optionally configured. ZOO: Zooplankton Simulates different size classes of zooplankton, accounting for carbon and nutrient assimilation from grazing, carbon loss via respiration, excretion of DOM, faecal pellet production, mortality, and predation by larger organisms. TOT: Totals A summary module, allowing users to “sum-up” component variables from other modules into a total, for example, to compute TN, TP or TSS. SDF: Sediment Flux An interface module designed to provide spatially variable sediment flux settings to key modules (e.g., OXY, OGM, NUT), and/or link these variables to the dynamic sediment biogeochemistry model (SDG). Table 3.2: Modules Module Description Relevant Variables MAC: Benthic macrophytes Simulates benthic habitat and/or growth of macrophytes such as seagrasses in specified sediment zones. NA MAG: Macroalgae Simulates benthic macroalgal growth and sloughing/detachment of macroalgae and its subsequent redistribution within the domain. NA BIV: Bivalves A model of one or more groups of benthic filter feeders, able to assimilate C, N and P and recycle filter material back to the water column and sediment. NA HAB: Habitat Quality A high level module that returns habitat quality metrics based on underlying water condition attributes, for example, for seagrass or crab habitat suitability at different life stages. NA "],["coupling-to-host-models.html", "4 Coupling to Host Models 4.1 Interface Approach 4.2 “Environment” Variables 4.3 Feedback Options 4.4 Light Climate 4.5 Velocity &amp; Stress 4.6 Sediment Zones 4.7 Lagrangian Particles 4.8 Current Hosts", " 4 Coupling to Host Models 4.1 Interface Approach 4.2 “Environment” Variables 4.3 Feedback Options 4.4 Light Climate 4.5 Velocity &amp; Stress 4.6 Sediment Zones 4.7 Lagrangian Particles 4.8 Current Hosts "],["tracers-water-age.html", "5 Tracers &amp; Water Age 5.1 Contributors 5.2 Overview 5.3 Model Description 5.4 Setup &amp; Configuration 5.5 Case Studies &amp; Examples", " 5 Tracers &amp; Water Age 5.1 Contributors 5.2 Overview 5.3 Model Description 5.3.1 Process Descriptions 5.3.2 Variable Summary 5.3.3 Parameter Summary 5.3.4 Optional Module Links 5.3.5 Feedbacks to the Host Model 5.4 Setup &amp; Configuration 5.5 Case Studies &amp; Examples 5.5.1 Case Study 5.5.2 Publications "],["suspended-sediment.html", "6 Suspended Sediment 6.1 Contributors 6.2 Overview 6.3 Model Description 6.4 Setup &amp; Configuration 6.5 Case Studies &amp; Examples", " 6 Suspended Sediment 6.1 Contributors 6.2 Overview 6.3 Model Description 6.3.1 Process Descriptions 6.3.2 Variable Summary 6.3.3 Parameter Summary 6.3.4 Optional Module Links 6.3.5 Feedbacks to the Host Model 6.4 Setup &amp; Configuration 6.5 Case Studies &amp; Examples 6.5.1 Case Study 6.5.2 Publications "],["DO-1.html", "7 Dissolved Oxygen 7.1 Contributors 7.2 Overview 7.3 Model Description 7.4 Setup &amp; Configuration 7.5 Case Studies &amp; Examples", " 7 Dissolved Oxygen 7.1 Contributors Matthew Hipsey &amp; Peisheng Huang 7.2 Overview Dissolved Oxygen (\\(DO\\) or \\(O_2\\)) is considered to be one of the most important indicators of aquatic ecosystem conditions and is commonly used in models of water quality. Eutrophication and climate change pressures are exacerbating issues of hypoxia and anoxia in waters, ranging from small wetlands, lakes, and the coastal ocean. \\(O_2\\) dynamics respond to processes of atmospheric exchange, sediment oxygen demand, microbial respiration during organic matter mineralisation and nitrification, photosynthetic oxygen production and respiratory oxygen consumption, chemical oxygen demand, and respiration by other biotic components such as seagrass and bivalves. The \\(\\mathrm{AED}\\) oxygen module is suitable for a wide range of waterbody types, from ponds and wetlands, to lakes estuaries and the coastal ocean. 7.3 Model Description This module supports one state variable to capture the oxygen concentration, \\(O_2\\). The module is a low-level module that supports the two core processes of air-water exchange, \\(\\check{f}_{atm}^{O_2}\\), and sediment-water exchange, \\(\\hat{f}_{sed}^{O_2}\\), and is designed to be linked to by other modules that interact with oxygen. The dynamics of \\(O_2\\) can therefore be summarised as: \\[\\begin{eqnarray} \\frac{D}{Dt}O_2 = \\color{darkgray}{ \\mathbb{M} + \\mathcal{S} } \\quad &amp;+&amp; \\overbrace{\\check{f}_{atm}^{O_2}+\\hat{f}_{sed}^{O_2}}^\\text{aed_oxygen} \\\\ \\tag{7.1} &amp;-&amp; \\color{brown}{ f_{min}^{DOC} - f_{nitrf}^{NH_4} - f_{ch4ox}^{CH_4} - f_{h2sox}^{H_2S} - f_{feox}^{FeII} } \\\\ \\nonumber &amp;+&amp; \\color{brown}{ f_{gpp}^{PHY} - f_{rsp}^{PHY} - f_{rsp}^{ZOO} + \\hat{f}_{gpp}^{MAC} - \\hat{f}_{rsp}^{MAC} + f_{gpp}^{MAG} - f_{rsp}^{MAG} - \\hat{f}_{rsp}^{BIV} } \\\\ \\nonumber \\end{eqnarray}\\] where \\(\\mathbb{M}\\) and \\(\\mathcal{S}\\) refer to water mixing and boundary source terms, respectively, and the coloured \\(\\color{brown}{f}\\) terms reflect the optionally configurable contributions from other modules; these include the breakdown of \\(DOC\\) by aerobic heterotrophic bacteria to \\(CO_2\\), whereby a stoichiometrically equivalent amount of oxygen is removed, chemical oxidation reactions, such as nitrification or sulfide oxidation, photosynthetic oxygen production and respiratory consumption by phytoplankton, and also oxygen consumed and produced by any benthic biological groups. 7.3.1 Process Descriptions Oxygen solubility &amp; atmospheric exchange Atmospheric exchange is typically modelled based on Wanninkhof (1992) and the flux equation of Riley and Skirrow (1974) for the open water, and on Ho et al. (2011) for estuarine environments. The instantaneous flux at the air-water interface, \\(\\mathcal{F}_{atm}^{O_2}\\), depends on the oxygen gradient between the air and water and the gas transfer or piston velocity, \\(k_{piston}\\) \\((m/s)\\) : \\[\\begin{equation} \\mathcal{F}_{atm}^{O_2} = k_{piston}^{O_2} \\left({O_2}_{air} - {O_2}_{s}\\right) \\tag{7.2} \\end{equation}\\] where \\({O_2}_{s}\\) is the oxygen concentration in the surface waters near the air-water interface and \\(C_{air}\\) is the concentration of oxygen in the air phase near the interface (\\(mmol\\) \\(O_2/m^3\\)). A positive flux represents input of oxygen from the atmosphere to the water. \\({O_2}_{air}\\) is dependent on temperature, \\(T\\), salinity, \\(S\\) and atmospheric pressure, \\(p\\), as given by: \\[\\begin{eqnarray} {O_2}_{air}\\left[T,S,p \\right] &amp;=&amp; \\tfrac{32}{1000} \\: 1.42763 \\: \\Phi_{p}^{atm} \\\\ &amp;\\times&amp;\\exp \\left\\{ -173.4292+249.6339 \\left[\\tfrac{100}{T_K}\\right] + 143.3483 \\ln \\left[ \\tfrac{T_K}{100}\\right] - 21.8492 \\left[\\tfrac{T_K}{100}\\right] \\right. \\nonumber \\\\ &amp;+&amp; \\left. S\\left(-0.033096 +0.014259 \\left[\\tfrac{T_K}{100}\\right] -0.0017 \\left[\\tfrac{T_K}{100}\\right]^2 \\right) \\right\\} \\tag{7.3} \\end{eqnarray}\\] where \\(T_K\\) is temperature in degrees Kelvin, salinity is expressed as parts per thousand and atmospheric pressure is in kPa. The pressure correction function, \\(\\Phi_{p}^{atm}\\) varies between one and zero for the surface and high altitudes respectively: \\[\\begin{equation} \\Phi_{p}^{atm}[p]=\\frac{p_H}{p_{SL}}\\left[1-\\frac{p_{vap}}{p_H}\\right]/\\left[1-\\frac{p_{vap}}{p_{SL}}\\right]. \\tag{7.4} \\end{equation}\\] where \\(p_H\\) and \\(p_{SL}\\) is the pressure at the altitude of the simulation domain (\\(H\\)) and at sea level, respectively. As \\(\\mathrm{AED}\\) can be applied across many types of environments, spanning the ocean to small lakes and flowing waters, users can select from a range of \\(k_{piston}\\) options, or implement their own, to capture this process. The options of \\(k\\) methods are listed in the Gas Transfer section of Chapter 30. Once the exchange flux is computed it is applied to the surface cells of the simulated domain, and the change in the \\(O_2\\) concentration in the surface layer is: \\[\\begin{equation} \\check{f}_{atm}^{O_2} = \\frac{\\mathcal{F}_{atm}^{O_2}}{\\Delta z_{surf}} \\tag{7.5} \\end{equation}\\] where \\(\\Delta z_{surf}\\) is the surface layer thickness. Sediment oxygen demand Modelling sediment oxygen demand (\\(SOD\\)) can take a variety of forms. The simplest form in AED is the “static” model whereby \\(SOD\\) varies as a function of the overlying water temperature and bottom water dissolved oxygen concentration: \\[\\begin{equation} \\mathcal{F}_{sed}^{O_2}[T,O_2] = F_{sed}^{oxy} \\: \\theta_{sod}^{T-20} \\: \\Phi_{sod}^{oxy}\\left[O_2\\right] \\tag{7.6} \\end{equation}\\] where \\(F_{sed}^{oxy}\\) is the maximum oxygen flux across the sediment-water interface at \\(20^{\\circ}C\\). The oxygen limitation is computed based on: \\[\\begin{equation} \\Phi_{sod}^{oxy}\\left[O_2\\right]=\\frac{O_2}{K_{sod}^{oxy}+O_2} \\tag{7.7} \\end{equation}\\] where \\(K_{sod}^{oxy}\\) is the half-saturation constant controlling the sediment oxygen demand. Once the exchange flux is computed it is applied to the bottom cells of the simulated domain, and the change in the \\(O_2\\) concentration in the bottom layer is: \\[\\begin{equation} \\hat{f}_{sed}^{O_2} = \\frac{\\mathcal{F}_{sed}^{O_2}}{\\Delta z_{bot}} \\tag{7.8} \\end{equation}\\] where \\(\\Delta z_{bot}\\) is the bottom layer thickness. Spatially variable sediment fluxes: The approach described above is the most simple and default method for capturing oxygen fluxes into the sediment, and is referred to as the static model. This approach can be extended to allow for spatial variability in \\(F_{sed}^{oxy}\\) by engaging the link to the aed_sedflux module, where the host models support multiple benthic cells or zones. In this case, users input spatially discrete values of \\(F_{sed}^{oxy}\\). Dynamically varying sediment flux rates: Where dynamic rates of \\(O_2\\) are required to flux to the sediment (e.g. in response to episodic loading of organic material to the sediment, or for assessment of long-term changes in sediment quality), then the above expressions may be replaced instead with dynamically calculated variables in aed_seddiagenesis via a link created with the aed_sedflux module. 7.3.2 Optional Module Links Other oxygen sources/sinks are indicated in Eq (7.1). These include: Oxygen consumption during bacterial mineralisation of DOC is done in the organic matter module - aed_organic_matter; Oxygen consumption during nitrification is done in the nitrogen module - [aed_nitrogen][Inorganic Nutrients: C/N/P/Si]; Oxygen production/consumption by phytoplankton phtosynthesis/respiration is done in the phytoplankton module - aed_phytoplankton; Oxygen consumption due to zooplankton respiration is done in the zooplankton module - aed_zooplankton; Oxygen production/consumption by seagrass phtosynthesis/respiration is done in the macrophyte module - aed_macrophyte; Oxygen consumption due to bivalve respiration is done in the benthic module - [aed_bivalve][Benthic Vegetation]; 7.3.3 Feedbacks to the Host Model The oxygen module has no feedbacks to the host hydrodynamic model. 7.3.4 Variable Summary The default variables created by this module, and the optionally required linked variables needed for full functionality of this module are summarised in Table 7.1. The diagnostic outputs able to be output are summarised in Table 7.2. State variables Table 7.1: Oxygen - state variables AED name Symbol Description Unit Type Typical Range Comments aed_oxygen OXY_oxy \\[\\mathbf{O_2}\\] dissolved oxygen concentration \\[\\small{mmol\\:O_2/m^3}\\] pelagic 0 - 500 . Dependent variables SDF_Fsed_oxy \\[\\mathbf{F}_{sed}^{oxy}\\] sediment \\(O_2\\) flux \\[\\small{mmol \\:O_2/m^2/s}\\] benthic -300 - 300 read and output as /day, but internally used as /s Diagnostics Table 7.2: Oxygen - diagnostic variables AED name Symbol Description Unit Type Typical Range Comments diag_level = 0+ OXY_sat \\[\\mathbf{O_2^{sat}}\\] oxygen saturation \\[\\small{\\%}\\] pelagic 0-200 . diag_level = 2+ OXY_sed_oxy \\[\\mathbf{F}_{sed}^{oxy}\\] \\(O_2\\) exchange across sediment-water interface \\[\\small{mmol\\: O_2/m^2/d}\\] benthic 0 - 50 . OXY_atm_oxy_flux \\[\\mathbf{F}_{atm}^{oxy}\\] \\(O_2\\) exchange across atm-water interface \\[\\small{mmol \\:O_2/m^2/d}\\] surface 0 - 100 . diag_level = 9+ OXY_atm_oxy_exch3d \\[\\mathbf{\\check{f}}_{atm}^{oxy}\\] \\(O_2\\) exchange across atm-water interface \\[\\small{mmol \\:O_2/m^3/d}\\] surface 0 - 1 . 7.3.5 Parameter Summary The parameters and settings used by this module are summarised in Table 7.3. Table 7.3: Oxygen module parameters and configuration options AED name Symbol Description Unit Type Typical Range Comments Initialisation oxy_initial \\[O_2|_{t=0}\\] initial \\(O_2\\) concentration \\[\\small{mmol\\: O_2/m^3}\\] float 0 - 5000 can be overwritten by initial condition files oxy_min \\[O_2\\rfloor_{min}\\] minimum \\(O_2\\) concentration \\[\\small{mmol\\: O_2/m^3}\\] float 0 optional limitier oxy_max \\[O_2\\rceil^{max}\\] maximum \\(O_2\\) concentration \\[\\small{mmol\\: O_2/m^3}\\] float 600 optional limitier Sediment exchange Fsed_oxy \\[F_{sed}^{oxy}\\] sediment \\(O_2\\) flux at 20C \\[\\small{mmol\\: O_2/m^2/d}\\] float -300 - 300 . Ksed_oxy \\[K_{sod}^{O_2}\\] half-saturation oxygen conc. controlling \\(O_2\\) flux \\[\\small{mmol\\: O_2/m^3}\\] float 20 - 100 . theta_sed_oxy \\[\\theta_{sed}^{oxy}\\] Arrhenius temperature multiplier for sediment \\(O_2\\) flux \\[\\small{-}\\] float 1.0 - 1.2 . Fsed_oxy_variable variable name to link to for spatially resolved sediment zones \\[\\small{-}\\] string SDF_Fsed_oxy optional link to enable spatially resolved fluxes Atmospheric exchange oxy_piston_model \\[\\Theta_{oxy}^{piston}\\] selection of air/water \\(O_2\\) flux velocity method \\[\\small{-}\\] integer 1 - 9 see options in the Gas Transfer section altitude \\[H\\] altitude of site above sea level \\[\\small{m}\\] float 0 - 4000 defaults to 0; Eq (7.4) used for \\(H \\gt 1\\) 7.4 Setup &amp; Configuration An example aed.nml parameter specification block for the aed_oxygen module is shown below: &amp;aed_oxygen oxy_initial = 250.0 oxy_min = 0 oxy_max = 500 Fsed_oxy = -40.0 Ksed_oxy = 100.0 theta_sed_oxy = 1.08 ! Fsed_oxy_variable = &#39;SDF_Fsed_oxy&#39; ! altitide = 1000 / Note that when users link Fsed_oxy_variable then Fsed_oxy is not required as this parameter will be set for each each sediment zone from values input via the aed_sedflux module. The entries oxy_min and oxy_max are optional. 7.5 Case Studies &amp; Examples 7.5.1 Case Study: Swan-Canning Estuary The Swan-Canning Estuary in Western Australia experiences hypoxia and anoxia due to the strong salt-wedge that forms within the system, and the high sediment oxygen demand. Huang et al. (2018) used the aed_oxygen model with the TUFLOW-FV hydrodynamic model to captured the large spatio-temporal variability in oxygen distribution. Using spatial zones with different values of Fsed_oxy, the simulations show very high accuracy in resolving the “dome” of low oxygen associated with the salt-wedge. Figure 1: Cross-section plots comparing modelled and field salinity (psu, left) and \\(O_2\\) (mg/L, right) for Sep-Dec 2008 within the Swan River. The field plots are based on contouring approx. 20 profile data locations. The results of the model were integrated over the length of the modelled domain to demonstrate the model’s performance in capturing the system-scale areal extent of hypoxia (\\(O_2&lt;4\\:mg/L\\)) and anoxia (\\(O_2&lt;2\\:mg/L\\)). Huang et al. (2018) also used the validated model to explore different remediation options based on artificial oxygenation inputs. Figure 2: The total area of anoxia (&lt;2 mg O2 / L) and hypoxia (&lt;4 mg O2 / L) within the estuary for 2008 and 2010, comparing the model (black line) and spatially interpolated weekly profile data (shaded region). 7.5.2 Publications html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #lwodkprljl .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 12px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: 100%; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #lwodkprljl .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lwodkprljl .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #lwodkprljl .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; border-top-color: #FFFFFF; border-top-width: 0; } #lwodkprljl .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lwodkprljl .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lwodkprljl .gt_col_heading { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #lwodkprljl .gt_column_spanner_outer { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #lwodkprljl .gt_column_spanner_outer:first-child { padding-left: 0; } #lwodkprljl .gt_column_spanner_outer:last-child { padding-right: 0; } #lwodkprljl .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #lwodkprljl .gt_group_heading { padding: 8px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #lwodkprljl .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #lwodkprljl .gt_from_md > :first-child { margin-top: 0; } #lwodkprljl .gt_from_md > :last-child { margin-bottom: 0; } #lwodkprljl .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #lwodkprljl .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #lwodkprljl .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lwodkprljl .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #lwodkprljl .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lwodkprljl .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #lwodkprljl .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #lwodkprljl .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lwodkprljl .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lwodkprljl .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #lwodkprljl .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lwodkprljl .gt_sourcenote { font-size: 90%; padding: 4px; } #lwodkprljl .gt_left { text-align: left; } #lwodkprljl .gt_center { text-align: center; } #lwodkprljl .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #lwodkprljl .gt_font_normal { font-weight: normal; } #lwodkprljl .gt_font_bold { font-weight: bold; } #lwodkprljl .gt_font_italic { font-style: italic; } #lwodkprljl .gt_super { font-size: 65%; } #lwodkprljl .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Author/Year Paper Title Description Bruce et al. (2014) Hydrodynamic controls on oxygen dynamics in a riverine salt wedge estuary, the Yarra River estuary, Australia. NA Bruce et al. (2015) A model of oxygen and nitrogen biogeochemical response to hydrodynamic regimes in the Yarra River estuary. NA Snortheim et al. (2017) Meteorological drivers of hypolimnetic anoxia in a eutrophic, north temperate lake. NA Huang et al. (2018) Assessing artificial oxygenation in a riverine salt-wedge estuary with a three-dimensional finite-volume model NA Huang et al. (2019) An integrated modelling system for water quality forecasting in an urban eutrophic estuary: The Swan-Canning Estuary Virtual Observatory. NA Ladwig et al. (2021) Lake thermal structure drives interannual variability in summer anoxia dynamics in a eutrophic lake over 37 years. NA References "],["Carbon-1.html", "8 Inorganic Carbon 8.1 Contributors 8.2 Overview 8.3 Model Description 8.4 Setup &amp; Configuration 8.5 Case Studies &amp; Examples", " 8 Inorganic Carbon 8.1 Contributors Peisheng Huang, Kamilla Kurucz &amp; Matthew Hipsey 8.2 Overview Understanding carbon cycling is central to understanding food webs and how aquatic communities are structured and supported (Dodds and Whiles, 2010). Exchange of carbon between aquatic systems and the atmosphere is also fundamental in influencing climate (e.g. Cai, 2011; Borges and Abril, 2012). Accordingly, there are a wide range of applications that require simulation of carbon species. The \\(\\mathrm{AED}\\) library can be used to simulate both the organic and inorganic pools of carbon. As carbon is a core building block of an aquatic ecosystem, aed_carbon (\\(\\mathrm{CAR}\\)) is designed as a low-level module for managing inorganic carbon pools, and is able to be linked to by higher level modules associated with organic matter cycling, primary production, and other biotic groups. In particular, organic carbon is the currency of energy exchange through food webs, and the processes for modelling organic carbon are described in Section 10 - Organic Matter. This chapter presents the forms of inorganic carbon and fluxes of carbon in the aquatic environment and how they are modelled in the aed_carbon module 8.3 Model Description The core variables included in the aed_carbon module are Dissolved Inorganic Carbon (DIC) and methane (CH4). The dynamics for DIC is captured in the model when simDIC = .true.. The rate of change of DIC concentration as it moves with the water is calculated from local effects associated with air-water exchange (\\(\\check{f}_{atm}^{CO_2}\\)), oxidation of CH4, (\\(f_{ox}^{CH_4}\\)), and sediment-water exchange (\\(\\hat{f}_{sed}^{DIC}\\)), which is summarized as: \\[\\begin{eqnarray} \\frac{D}{Dt}DIC = \\color{darkgray}{ \\mathbb{M} + \\mathcal{S} } \\quad &amp;+&amp; \\overbrace{\\check{f}_{atm}^{CO_2}+f_{ox}^{CH_4}+\\hat{f}_{sed}^{DIC} }^\\text{aed_carbon} \\\\ \\tag{8.1} &amp;+&amp; \\color{brown}{ f_{min}^{DOC} - f_{gpp}^{PHY} + f_{rsp}^{PHY} + f_{rsp}^{ZOO} } \\\\ \\nonumber &amp;-&amp; \\color{brown}{ \\hat{f}_{gpp}^{MAC} + \\hat{f}_{rsp}^{MAC} - f_{gpp}^{MAG} - f_{rsp}^{MAG} + \\hat{f}_{rsp}^{BIV} } \\\\ \\nonumber \\end{eqnarray}\\] where \\(\\mathbb{M}\\) and \\(\\mathcal{S}\\) refer to water mixing and boundary source terms, respectively, and the coloured \\(\\color{brown}{f}\\) terms reflect DIC fluxes computed by other (optionally) linked modules such as modules of organic matter (\\(\\mathrm{OMG}\\)), phytoplankton (\\(\\mathrm{PHY}\\)) or zooplankton (\\(\\mathrm{ZOO}\\)). The dynamics for CH4 is captured in the model when simCH4 = .true.. CH4 is formed during the decomposition of organic material by microbial methanogenesis (e.g., Cicerone and Oremland, 1988), which requires strictly anaerobic conditions and is therefore usually restricted to be deep within aquatic sediment. Inputs to the water therefore are from sediment CH4 production, which can enter the water column either as a dissolved flux or via ebullition (bubble release), or from external sources such as wastewater discharges. Once in the water, dissolved CH4 is the balance between inputs from the sediment and losses from air-water exchange and CH4 oxidation to DIC. The rate of change of CH4 concentration as it moves with the water is therefore calculated as: \\[\\begin{eqnarray} \\frac{D}{Dt}CH_4 = \\color{darkgray}{ \\mathbb{M} + \\mathcal{S} } \\quad &amp;+&amp; \\overbrace{\\check{f}_{atm}^{CH_4}-f_{ox}^{CH_4}+\\hat{f}_{sed}^{CH_4} +f_{dis}^{CH_{4-bubble}} }^\\text{aed_carbon} \\\\ \\tag{8.2} \\end{eqnarray}\\] where \\(\\check{f}_{atm}^{CH_4}\\) is the air-water exchange of dissolved methane and \\(\\hat{f}_{sed}^{CH_4}\\) is the sediment diffusive release flux. Bubbles moving through the water column after release from the sediment can also dissolve, denoted \\(f_{dis}^{CH_{4-bubble}}\\). The details of how each flux relevant to DIC and CH4 is calculated, and the associated parameter settings, are described in the next sections. For details on how to model organic carbon refer to the aed_organic_matter model. 8.3.1 Process Descriptions 8.3.1.1 Carbonate buffering and pH In most circum-neutral waters the carbonate buffer system controls the pH conditions within the water. When CO2 within the atmosphere (\\(CO_{2(gas)}\\)) is dissolved in water, it can exist in a variety of forms. Initially, carbon dioxide will dissolve, \\(CO_{2_{(aq)}}\\), which can then form carbonic acid, \\(H_2CO_3\\), and dissociate into bicarbonate, \\(HCO_3^-\\), and carbonate, \\(CO_3^{2-}\\), ions. \\[\\begin{eqnarray} CO_{2_{(aq)}} &amp;\\rightleftharpoons&amp; CO_{2_{(gas)}} \\\\ CO_{2_{(aq)}} + H_2O &amp;\\rightleftharpoons&amp; H_2CO_3 \\\\ H_2CO_3 &amp;\\rightleftharpoons&amp; H^+ + HCO_3^- \\\\ HCO_3^- &amp;\\rightleftharpoons&amp; H^+ + CO_3^{2-} \\end{eqnarray}\\] The sum of the concentrations of all these forms is the inorganic carbon concentration (DIC), and the composition of these forms depends on acidity (pH). The total \\(DIC\\) state variable is the sum of carbonate species in a water parcel, which is conservative with respect to hydrodynamics: \\[\\begin{equation} DIC = [CO_{3}^{2-}]+[HCO_{3}^{-}]+[CO_{2}]+[H_2CO_{3}]. \\label{eq:DIC} \\end{equation}\\] To capture the interaction between carbonate species that make up DIC, each cell is treated as a closed system, as in a titration, where fluxes into and out of the system are specified, such as fluxes due to respiration, dissolved sediment fluxes, or atmospheric exchange. The changes due to these fluxes alter the CO_(2(aq)) concentration without changing the alkalinity, allowing for the speciation and pH to be recomputed at the end of the time-step. aed_carbon provides three options for modelling the bicarbonate equilibrium by switching the CO2_model options: The users can choose the aed_geochemistry module, or adopts the widely used CO2SYS code (Lewis and Wallace, 1998) or Butler (1982) code to calculate the partial pressure of CO2 (pCO2) and bicarbonate system. These options all lead to creation of state variables for DIC and pH, and their concentrations need to be specified in the boundary conditions. The use of each option is described in below sections. 8.3.1.1.1 co2_model = 0 This option is selected if the user wishes to defer the speciation, pCO2 and pH calculation to the geochemistry model in aed_geochemistry. In this option, aed_carbon creates the DIC and pH state variables, will compute the atmospheric exchange and sediment fluxes, but not update the speciation, pCO2 or pH. When using this approach, users must pay attention to correctly configure the aed_geochemistry model to link to DIC, pCO2 and pH within the aed_carbon module. TO resolve carbonate buffering that module can be setup with the following components, and species: \\[\\begin{eqnarray} X &amp;\\in&amp; \\{CO_3^{2-}, H^+,H_2O\\} \\\\ C &amp;\\in&amp; \\{CO_2, HCO_3^-, H_2CO_3,CO_3^{2-},H^+,OH^-\\} \\end{eqnarray}\\] This will be solved each time the geochemical module is run. Fluxes of \\(CO_2\\) between the atmosphere and sediment or from bioloigcal process will also be applied to the \\(DIC\\) variable and therefore dynamically affect \\(pH\\). For users interested in simulating calcite precipitation, then this may also be achieved by configuring the geochemistry module, and enabling Calcite as a simulated mineral component. 8.3.1.1.2 co2_model = 1 This option adopts the CO2SYS code (Lewis and Wallace, 1998) in which the bicarbonate system was modelled from DIC (mmol m-3) and total alkalinity (TA, mmol m-3), with water temperature (T, degrees), salinity (S, PSU) and water pressure (P, dbar) derived from the coupled hydrodynamic model, and DIC concentration derived from the aed_carbon model. There are multiple options for TA calculation methods in this code depending on the data availability and environment of the study site, which can be switched by the alk_mode option: For freshwaters, there is a simple freshwater alkalinity option (alk_mode = 0), whereby TA is assumed to be dominated by the carbonate alkalinity. In this option, TA is calculated from the carbonate species according to: \\[\\begin{equation} TA=-[H^+ ]+[HCO_3^- ]+2[CO_3^(2-) ]+[OH^-] \\end{equation}\\] For hardwater lakes, estuaries or coastal systems, then other ions contribute significantly to the total alkalinity and the assumption above is no longer valid. However, the component ions needed for an alkalinity calculation are not always commonly available or included in the model and so approximations are needed to estimate TA. TA is a quasi-conservative parameter and it has been a popular practice in coastal modelling to predict TA from salinity (e.g. Lee et al. 2006; Alin et al., 2012; Takahashi et al., 2014), or from combination of salinity and DIC concentration (Kim and Lee, 2009; Jones et al., 2016). Accordingly, aed_carbon supports a few options to model the TA in coastal waters. 8.3.1.1.3 co2_model = 2 This option adopts the approach of Butler (1982) to model the carbonate system in freshwater environment. In a closed carbonate system, the TA, DIC and pH are related by: \\[\\begin{equation} TA=DIC \\frac{K_{a1}[H^+]+2K_{a1}K_{a2}}{[H^+]^2+K_{a1}[H^+]+K_{a1}K_{a2}}+ \\frac{K_w}{[H^+]} -[H^+] \\label{eq:TA} \\end{equation}\\] where \\(K_w\\) is the ion product of water, \\(K_{a1}\\) is the first acidity constant, \\(K_{a2}\\) is the second acidity constant. \\(pH\\) is calculated from: \\[\\begin{equation} pH = - \\log_{10}[H^+] \\end{equation}\\] and \\(DIC\\) is defined as: \\[\\begin{equation} DIC = [CO_{3}^{2-}]+[HCO_{3}^{-}]+[CO_{2}]+[H_2CO_{3}] \\label{eq:DIC2} \\end{equation}\\] where all concentrations are in (\\(mmol\\:C/m^3\\)). Note that the concentration of hydrated carbon dioxide, \\([H_2CO_3]\\), is considered to be negligible and is therefore omitted. The conversion between the carbon dioxide partial pressure, \\(pCO_2\\) and carbon dioxide concentration (\\(molL^{-1}\\)) is given by: \\[\\begin{equation} [CO_2]=K_HpCO_2 \\label{eq:pCO2} \\end{equation}\\] where \\(K_H\\) is the activity coefficient. The ionic strength of the water impacts the dissociation constants. Ionic strength, \\(I\\), is typically defined as : \\[\\begin{equation} I = 0.5 \\left([Na^+]+[H^+]+[HCO_{3}^-]+4[CO_{3}^{2-}]+[H^+]/K_w \\right). \\end{equation}\\] Rather than model this explicitly, the ionic strength is entered into the model as a constant, and is not assumed to vary significantly in space or time for a given system. From the ionic strength, an activity coefficient is defined as: \\[\\begin{equation} f = \\left( \\frac{I^{1/2}}{1+I^{1/2}}-0.2I \\right) \\left(\\frac{298}{T_K} \\right)^{2/3}. \\end{equation}\\] The dissociation constants are then computed following: \\[\\begin{eqnarray} \\log_{10}\\left(K_{H}^{i+1}\\right) &amp;=&amp; \\log_{10}\\left(K_{H}^{0}\\right) -bI \\\\ log_{10}\\left(K_{w}^{i+1}\\right) &amp;=&amp; \\log_{10}\\left(K_{w}^{0}\\right) +f \\\\ log_{10}\\left(K_{a1}^{i+1}\\right) &amp;=&amp; \\log_{10}\\left(K_{a1}^{0}\\right) +f+bI \\\\ log_{10}\\left(K_{a2}^{i+1}\\right) &amp;=&amp; \\log_{10}\\left(K_{a2}^{0}\\right) +2f \\end{eqnarray}\\] where \\(b=0.105\\) . For this system, if two of the three components (i.e. \\(TA\\), \\(pH\\) or \\(DIC\\)) are known the third can be determined. In AED, \\(pH\\) and \\(DIC\\) are tracked as state variables, and at each time step \\(TA\\) is also computed and avalable via a diagnostic output. The carbonate speciation for a given value of \\(pH\\) and \\(DIC\\) is then estimated from: \\[\\begin{eqnarray} \\left[CO_{3}^{2-}\\right] &amp;=&amp; DIC \\frac{K_{a1}K_{a2}}{[H^+]^2+K_{a1}[H^+]+K_{a1}K_{a2}}, \\label{eq:speciation1} \\\\ \\left[HCO_{3}\\right] &amp;=&amp; DIC \\frac{K_{a1}[H^+]}{[H^+]^2+K_{a1}[H^+]+K_{a1}K_{a2}}, \\label{eq:speciation2} \\\\ \\left[CO_{2}\\right]&amp;=&amp;DIC\\frac{[H^+]^2}{[H^+]^2+K_{a1}[H^+]+K_{a1}K_{a2}}. \\label{eq:speciation3} \\end{eqnarray}\\] Using this framework, the inorganic carbon model co2_model = 2 operates as follows: from initial field measurements of TA and pH, calculate DIC using calculate initial carbonate speciation using - calculate partial pressure of \\(CO_2\\) using start timestep loop calculate atmospheric \\(CO_2\\) flux using calculate internal \\(CO_2\\) fluxes from phytoplankton photosynthesis/respiration, zooplankton respiration and bacterial respiration calculate new DIC using assuming \\(TA\\) constant, as \\(CO_2\\) does not change the alkalinity directly, calculate new \\(pH\\) by iteratively solving calculate new carbonate speciation using - calculate new partial pressure of \\(CO_2\\) using update new \\(TA\\) and \\(DIC\\) concentratino estimates 8.3.1.2 Sediment exchange 8.3.2 Optional Module Links Other carbon sources/sinks are indicated in Eq (8.1) for DIC. These include: aed_oxygen: Oxygen is used to control oxidation; aed_organic_matter: organic matters minerization can update DIC; aed_phytoplankton: phytoplankton photosynthetic production of CO2 can update DIC; aed_geochemistry: optional link to simulate the carbonate system; aed_sedflux: modules to update the sediment-water exchange 8.3.3 Feedbacks to the Host Model The inorganic carbon module has no feedbacks to the host hydrodynamic model. 8.3.4 Variable Summary The default variables created by this module, and the optionally required linked variables needed for full functionality of this module are summarised in Table 8.1. The diagnostic outputs able to be output are summarised in Table 8.2. State variables Table 8.1: Carbon - state variables AED name Symbol Description Unit Type Typical Range Comments aed_carbon CAR_dic \\[\\mathbf{DIC}\\] dissolved inorganic carbon concentration \\[\\small{mmol\\: C/m^3}\\] pelagic 0 - 5000 simDIC activated by setting dic_initial \\(\\gt -9999\\) CAR_ch4 \\[\\mathbf{CH_4}\\] dissolved methane concentration \\[\\small{mmol\\: C/m^3}\\] pelagic 0 - 200 simDIC activated by setting ch4_initial \\(\\gt -9999\\) CAR_pH \\[\\mathbf{pH}\\] \\(pH\\) value \\[\\small{-}\\] pelagic 7 - 9 activated when simDIC=T Dependent variables OXY_oxy \\[\\mathbf{O_2}\\] dissolved oxygen concentration \\[\\small{mmol\\: O_2/m^3}\\] pelagic 0 - 500 optional for methane oxidation, via methane_reactant_variable SDF_Fsed_dic \\[\\mathbf{F}_{sed}^{dic}\\] dissolved sediment \\(CO_2\\) flux \\[\\small{mmol\\: C/m^2/s}\\] benthic 0 - 300 required for sediment zones; internally used as /s SDF_Fsed_ch4 \\[\\mathbf{F}_{sed}^{ch4}\\] dissolved sediment \\(CH_4\\) flux \\[\\small{mmol\\: C/m^2/s}\\] benthic NA required for sediment zones; internally used as /s SDF_Fsed_ch4_ebb \\[\\mathbf{F}_{sed}^{ch4-ebb}\\] sediment \\(CH_4\\) bubble release rate \\[\\small{mmol\\: C/m^2/s}\\] benthic NA required for sediment zones; internally used as /s Diagnostics Table 8.2: Carbon - diagnostics AED name Symbol Description Unit Type Typical Range Comments diag_level = 0+ CAR_pco2 \\[\\mathbf{pCO_2}\\] partial pressure of \\(CO_2\\) in water \\[\\small{atm}\\] pelagic 0 - 5000 diag_level = 2+ CAR_ch4ox \\[\\mathbf{f}_{ox}^{ch4}\\] methane oxidation rate \\[\\small{mmol\\: C/m^3/d}\\] pelagic 0 - 100 CAR_sed_dic \\[\\mathbf{\\mathcal{F}}_{sed}^{dic}\\] \\(CO_2\\) exchange across sediment-water interface \\[\\small{mmol\\: C/m^2/d}\\] benthic 0 - 50 CAR_sed_ch4 \\[\\mathbf{\\mathcal{F}}_{sed}^{ch4}\\] \\(CH_4\\) exchange across sediment-water interface \\[\\small{mmol\\: C/m^2/d}\\] benthic 0 - 1 CAR_atm_co2_flux \\[\\mathbf{\\mathcal{F}}_{atm}^{dic}\\] \\(CO_2\\) exchange across atm-water interface \\[\\small{mmol\\: C/m^2/d}\\] surface 0 - 100 CAR_atm_ch4_flux \\[\\mathbf{\\mathcal{F}}_{atm}^{ch4}\\] \\(CH_4\\) exchange across atm-water interface \\[\\small{mmol\\: C/m^2/d}\\] surface 0 - 1 CAR_atm_ch4_ebb_flux \\[\\mathbf{\\mathcal{F}}_{atm}^{ch4-bub}\\] \\(CH_4\\) bubble flux across air-water interface \\[\\small{mmol\\: C/m^2/d}\\] surface NA CAR_sed_ch4_ebb \\[\\mathbf{\\mathcal{F}}_{sed}^{ch4-bub}\\] \\(CH_4\\) bubble flux (ebullition) across sediment-water interface \\[\\small{mmol\\: C/m^2/d}\\] benthic NA CAR_sed_ch4_ebb_3d \\[\\mathbf{\\hat{f}}_{sed}^{CH_{4-bubble}}\\] \\(CH_4\\) bubble flux (ebullition) volume flux \\[\\small{mmol\\: C/m^3/d}\\] pelagic NA CAR_ch4_ebb_df \\[\\mathbf{f}_{dis}^{CH_{4-bubble}}\\] \\(CH_4\\) bubble dissolution \\[\\small{mmol\\: C/m^3/d}\\] pelagic 0 - 1 8.3.5 Parameter Summary The parameters and settings used by this module are summarised in Table 8.3. Table 8.3: Carbon - parameters AED name Symbol Description Unit Type Typical Range Comments Initialisation dic_initial \\[DIC|_{t=0}\\] initial \\(DIC\\) cooncentration \\[\\small{mmol\\: C/m^3}\\] float 0 - 5000 can be overwritten by initial condition files pH_initial \\[pH|_{t=0}\\] initial \\(pH\\) values \\[\\small{-}\\] float 7 - 9 can be overwritten by initial condition files ch4_initial \\[CH_4|_{t=0}\\] initial \\(CH_4\\) values \\[\\small{mmol\\: C/m^3}\\] float 0 - 200 can be overwritten by initial condition files Carbonate buffering co2_model \\[\\Theta_{co2}\\] selection of \\(pCO_2\\) model algorithms \\[\\small{-}\\] integer 0, 1, 2 1: CO2SYS; 2: Butler; 0: aed_geochem alk_model \\[\\Theta_{TA}\\] selection of total alkalinity model algorithms \\[\\small{-}\\] integer 0,1,2,3,4,5 empirical relations developed for Queensland Rivers ionic \\[I\\] average ionic strength of the water column \\[\\small{meq}\\] float NA Atmospheric exchange atm_co2 \\[pCO_2^a\\] atmospheric \\(CO_2\\) concentration \\[\\small{atm}\\] float \\(350-450\\times 10^{-6}\\) atm_ch4 \\[pCH_4^a\\] atmospheric \\(CH_4\\) concentration \\[\\small{atm}\\] float \\(1-2\\times 10^{-6}\\) co2_piston_model \\[\\Theta_{co2}^{piston}\\] selection of air-water \\(CO_2\\) flux velocity method \\[\\small{-}\\] integer 1 - 9 see options in the Gas Transfer section ch4_piston_model \\[\\Theta_{ch4}^{piston}\\] selection of air-water \\(CH_4\\) flux velocity method \\[\\small{-}\\] integer 1 - 9 see options in the Gas Transfer section Methane oxidation Rch4ox \\[R_{ox}^{ch4}\\] maximum reaction rate of \\(CH_4\\) oxidation @ \\(20^{\\circ}C\\) \\[\\small{/d}\\] float 0 - 1 Kch4ox \\[K_{ch4ox}^{O_2}\\] half-saturation \\(O_2\\) conc. for \\(CH_4\\) oxidation \\[\\small{mmol\\: O_2/m^3}\\] float 0.1 - 10 vTch4ox \\[\\theta_{ox}^{ch4}\\] Arrhenius temperature multiplier for \\(CH_4\\) oxidation \\[\\small{-}\\] float 1 - 1.1 methane_reactant_variable \\[O_2\\] state variable to be consumed during \\(CH_4\\) oxidation \\[\\small{-}\\] string OXY_oxy Sediment exchange Fsed_dic \\[F_{sed}^{dic}\\] sediment \\(CO_2\\) flux @ \\(20^{\\circ}C\\) \\[\\small{mmol\\: C/m^2/d}\\] float 0 - 1 Ksed_dic \\[K_{sed-dic}^{O_2}\\] half-saturation oxygen conc. controlling \\(CO_2\\) flux \\[\\small{mmol\\: O_2/m^3}\\] float 20 - 100 theta_sed_dic \\[\\theta_{sed}^{dic}\\] Arrhenius temperature multiplier for sediment \\(CO_2\\) flux \\[\\small{-}\\] float 1 - 1.1 Fsed_dic_variable \\[\\mathbf{F}_{sed}^{dic}\\] variable name to link to for spatially resolved sediment zones \\[\\small{-}\\] float SDF_Fsed_dic Fsed_ch4 \\[F_{sed}^{ch4}\\] sediment \\(CH_4\\) flux @ \\(20^{\\circ}C\\) \\[\\small{mmol\\: C/m^2/d}\\] float 0 - 1 Ksed_ch4 \\[K_{sed-ch4}^{O_2}\\] half-saturation oxygen conc. controlling \\(CH_4\\) flux \\[\\small{mmol\\: O_2/m^3}\\] float 10 - 50 theta_sed_ch4 \\[\\theta_{sed}^{ch4}\\] Arrhenius temperature multiplier for sediment \\(CH_4\\) flux \\[\\small{-}\\] float 1 - 1.1 Fsed_ch4_variable \\[\\mathbf{F}_{sed}^{ch4}\\] variable name to link to for spatially resolved sediment zones \\[\\small{mmol\\: C/m^2/d}\\] float SDF_Fsed_ch4 Sediment ebullition ebb_model \\[\\Theta_{ch4}^{ebullition}\\] option to activate \\(CH_4\\) ebullition \\[\\small{-}\\] logical 0 , 1 0: no ebullition (default); 1: simple release model Fsed_ebb_variable \\[\\mathbf{F}_{sed}^{ch4-ebb}\\] variable name to link to for spatially resolved sediment zones \\[\\small{-}\\] float SDF_Fsed_ch4_ebb ch4_bub_aLL \\[\\bar{z}\\] mean water depth \\[\\small{m}\\] float 1 - 100 ch4_bub_cLL \\[c_{n}\\] normalising constant \\[\\small{-}\\] float 0.5 - 0.7 Lake Kinneret specific value ch4_bub_kLL \\[\\epsilon_{reg}\\] exponential factor from the depth-ebullition regression relation \\[\\small{-}\\] float -0.8 - -0.9 Lake Kinneret specific value ch4_bub_disf1 \\[k_{dis}^{shallow}\\] bubble dissolution fraction (surface) \\[\\small{-}\\] float 0 - 1 ch4_bub_disf2 \\[k_{dis}^{deep}\\] bubble dissolution fraction (deep) \\[\\small{-}\\] float 0 - 1 ch4_bub_disdp \\[z_{dis}^{depth}\\] bubble dissolution fraction depth interface \\[\\small{m}\\] float 1 - 100 8.4 Setup &amp; Configuration An example aed.nml parameter specification block for the aed_carbon module that is only modelling \\(DIC\\) is shown below: &amp;aed_carbon dic_initial = 1000. pH_initial = 7.5 ch4_initial = -9999 ! disables CH4 ! Carbonate buffering co2_model = 1 alk_model = 5 ! Atmospheric exchange atmco2 = 0.000380 co2_piston_model = 1 ! Sediment respiration Fsed_dic = 10.0 ! replaced by linked SDF var Ksed_dic = 100. theta_sed_dic = 1.08 Fsed_dic_variable = &#39;SDF_Fsed_dic&#39; / An example aed.nml parameter specification block for the aed_carbon module that includes all options is shown below: &amp;aed_carbon dic_initial pH_initial ch4_initial ! co2_model alk_model ionic ! atmco2 atmch4 co2_piston_model ch4_piston_model ! Rch4ox Kch4ox vTch4ox methane_reactant_variable ! Fsed_dic Ksed_dic theta_sed_dic Fsed_dic_variable Fsed_ch4 Ksed_ch4 theta_sed_ch4 Fsed_ch4_variable ! ebb_model Fsed_ebb_variable ch4_bub_aLL ch4_bub_cLL ch4_bub_kLL ch4_bub_disf1 ch4_bub_disf2 ch4_bub_disdp / 8.5 Case Studies &amp; Examples 8.5.1 Case Study 8.5.2 Publications "],["inorganic-nitrogen.html", "9 Inorganic Nitrogen 9.1 Contributors 9.2 Overview 9.3 Model Description - Default Model 9.4 Model Description - Adding N2O Reactions 9.5 Setup &amp; Configuration 9.6 Case Studies &amp; Examples", " 9 Inorganic Nitrogen 9.1 Contributors Daniel Paraska, Louise Bruce, Peisheng Huang, Matthew Hipsey 9.2 Overview Nitrogen is fundamental to shaping water quality in aquatic ecosystems. Nitrogen is of particular interest in that exists in many redox states and there are a myriad of organic and inorganic reactions that make up the nitrogen biogeochemical system. NO3- and NH4+ are the primary inorganic nutrients that re taken up by aquatic plants (phytoplankton and macrophytes) to build biomass as organic nitrogen. As nitrogen is a core building block of an aquatic ecosystem, aed_nitrogen (\\(\\mathrm{NIT}\\)) is designed as a low-level module for managing inorganic nitrogen pools, and is able to be linked to by higher order modules associated with primary production, and organic matter breakdown. The general nitrogen redox process specifically resolved in this module is NH4+ oxidation to NO3- by O2, and NO3- is reduced to N2 with organic matter, releasing organic nitrogen and NH4+ in the process. Advanced options are available, in which the end result is generation of the nitrogen species N2O. Producing N2O uses more variables and reaction pathways and is not necessary for most nutrient cycling studies. Importantly, nitrogen species react with organic matter. The description of organic matter involvement in nitrogen reactions and interactions can be found in Section (OM). The uptake and use of these variables by phytoplankton and macroalgae are described in Section (PHY) and (MAG). 9.3 Model Description - Default Model 9.3.1 Process Descriptions In the basic nitrogen module configuration, the variables NO3 and NH4 are included and able to be modified by nitrification, denitrification, sediment release and atmospheric deposition; to use this basic functionality, ensure the parameter simN2O is set to 0. The main balance equations for the simulated variables are summarised as: \\[\\begin{eqnarray} \\frac{D}{Dt}NO_3 = \\color{darkgray}{ \\mathbb{M} + \\mathcal{S} } \\quad &amp;+&amp; \\overbrace{f_{nitrf}^{NH_4} - f_{denit}^{NO_3} + \\check{f}_{atmdep}^{NO_3}+\\hat{f}_{sed}^{NO_3}}^\\text{aed_nitrogen} \\\\ \\tag{9.1} &amp;-&amp; \\color{brown}{ f_{nup}^{PHY} - f_{nup}^{MAG} } \\\\ \\nonumber \\end{eqnarray}\\] \\[\\begin{eqnarray} \\frac{D}{Dt}NH_4 = \\color{darkgray}{ \\mathbb{M} + \\mathcal{S} } \\quad &amp;-&amp; \\overbrace{ f_{nitrf}^{NH_4} + \\check{f}_{atmdep}^{NH_4}+\\hat{f}_{sed}^{NH_4}}^\\text{aed_nitrogen} \\\\ \\tag{9.2} &amp;+&amp; \\color{brown}{ f_{min}^{DON} - f_{nup}^{PHY} - f_{nup}^{MAG} } \\\\ \\nonumber \\end{eqnarray}\\] where \\(\\mathbb{M}\\) and \\(\\mathcal{S}\\) refer to water mixing and boundary source terms, respectively, and the coloured \\(\\color{brown}{f}\\) terms reflect the optionally configurable contributions from other modules; these include the mineralisation of \\(DON\\) and \\(N\\) cycling terms associated with photosynthesis and respiration by various biotic groups. 9.3.1.1 Nitrification and denitrification reactions In an environment of high O2, NH4+ is oxidized by oxygen to NO3- via nitrification. In an environment of low O2, NO3- is reduced to N2 via the process denitrification. O2 limitation on the rate of the reaction is not included in the default setup, but can be chosen by the user, as described in the section below. Figure 9.1: Summary of two main reactions in the default nitrogen model. 9.3.1.2 Nitrification The rate of nitrification is assumed to vary primarily due to temperature, and also due to variation in O2 and pH, according to: \\[\\begin{equation} f_{nitrf}^{NH_4} =R_{nitrf} \\; \\theta_{nitrif}^{T-20} \\; {\\underbrace{\\Phi_{O2}^{nitrf}\\left[O_2\\right] \\Phi_{pH}^{nitrf}\\left[pH\\right]}_{\\text{Optional limitations}}} \\; NH_4 \\tag{9.3} \\end{equation}\\] Where \\(\\theta_{nitrif}\\) is a Arrhenius temperature parameter specific to nitrification, and \\(T\\) is the temperature produced by the host model. O2 limitation on this rate will not be included in the setup unless a link to the oxygen module is made, as described in the section below. Oxygen limitation on nitrification: An extra option is to allow low O2 concentration to limit the nitrification rate, \\(\\Phi_{O_{2}}^{nitrf}\\left[O_2\\right]\\). If the aed_oxygen module is linked to the nitrogen module, then this setting will switch on automatically. The limitation effect is calculated according to: \\[\\begin{equation} \\Phi_{O_{2}}^{nitrf}\\left[O_2\\right]=\\frac{O_2}{O_2+K_{nitrif}} \\tag{9.4} \\end{equation}\\] where \\(K_{nitrif}\\) is a half saturation constant concentration of oxygen. The purpose of this factor is to reduce the rate of nitrification as oxygen moves below a critical concentration. pH limitation on nitrification: The rate of nitrification can be decreased at very high and low pH values, if pH is being simulated (see Carbon and Geochemistry). To use this function, the parameter simNitrfpH is set to .TRUE.. Around neutral pH, between the upper and lower optimum parameters, the reaction proceeds at the normal rate. Below a lower tolerance, and above an upper tolerance, the reaction is stopped entirely. Between the optimum and tolerance values, the rate is limited, in proportion to pH. The piecewise function is described as: \\[\\begin{equation} \\Phi_{pH}^{nitrf}[pH]= \\left\\{\\begin{array}{ll} 0, \\ \\ \\ \\ pH &lt; 0\\\\ 0, \\ \\ \\ \\ x \\geq 0\\\\ 1, \\ \\ \\ \\ x \\geq 0\\\\ 0, \\ \\ \\ \\ x \\geq 0\\\\ 0, \\ \\ \\ \\ pH \\geq 0\\\\ \\end{array} \\right. \\tag{9.5} \\end{equation}\\] The function is shown schematically in Figure 9.2. Figure 9.2: pH limitation on nitrification. Light limitation on nitrification: This process is not currently included and is an open area for contributions. 9.3.1.3 Denitrification Denitrification is a heterotrophic process occurring in low oxygen environments such as anoxic bottom waters and sediments. In addition to oxygen, the rate of denitrification depends on temperature and nitrate availability. It is calculated according to: \\[\\begin{equation} f_{denit}^{NO_3} = R_{denit}\\; \\theta_{denit}^{T-20}\\; \\frac{NO_3}{NO_3+K_{NO3}} \\; \\Phi_{O2}^{denit}\\left[O_2\\right] NO_3 \\tag{9.6} \\end{equation}\\] Where \\(R_{denit}\\) is the kinetic rate constant for denitrification and \\(\\theta_{denit}\\) is a temperature parameter specific to denitrification. The Monod term in Equation (9.6) slows the rate at low NO3- concentrations, and allows it to proceed at the maximum rate R_denit at high NO3- concentrations. The parameter KNO3 is the half-saturation parameter for limiting the reaction rate and is set by the user to slow the rate at low NO3- concentrations. This parameter should not be confused with the O2 limitation factor K_denit, mentioned below; O2 limitation on the rate of the reaction is not included in the default setup, but can be chosen by the user, as described in the section below. Oxygen mediation of denitrification: For denitrification, oxygen slows the reaction through inclusion of an inhibition function as: \\[\\begin{equation} \\Phi_{O2}^{denit}\\left[O_2\\right]= \\left\\{\\begin{array}{ll} \\frac{K_{denit}}{O_{2}+K_{denit}},\\ \\ \\ \\ \\ \\ \\ \\Theta^{denit}_{oxylim} = 1\\\\ e^{(-O_{2}/K_{denit})},\\ \\ \\ \\Theta^{denit}_{oxylim} = 2\\\\ \\end{array} \\right. \\tag{9.7} \\end{equation}\\] Such that the denitrification rate is inhibited by high O2 concentrations, using the parameter K_denit. This parameter is an O2 concentration, and should not be confused with the parameter KNO3 which is a NO3- concentration. To use the process shown in Equation (9.7), the switch oxy_lim, \\(\\Theta_{oxylim}^{denit}\\), set to the number 1. Alternatively, the rate of denitrification can be set to decreases exponentially at high O2 concentrations, also using the parameter Kdenit. This is the same parameter as for the inhibition function described above, but applied differently. 9.3.1.4 Atmospheric deposition Nitrogen can be added to the surface cells of an aquatic system through two kinds of atmospheric deposition: wet and dry. These functions can be turned on by setting the parameters simDryDeposition and simWetDeposition to .TRUE.. \\[\\begin{equation} f_{atmdep}^{NOx}=\\left[{\\underbrace{F_{atm}^{DIN}}_{\\text{Dry flux}}}+{\\underbrace{R_n\\left[t\\right] {DIN}_{atm}}_{\\text{Wet flux}}}\\right] \\frac{{k}_{DINdepNO_x}}{\\Delta z_{surf}} \\tag{9.8} \\end{equation}\\] \\[\\begin{equation} f_{atmdep}^{NH_4}=\\left[{\\underbrace{F_{atm}^{DIN}}_{\\text{Dry flux}}} + {\\underbrace{R_n\\left[t\\right] {DIN}_{atm}}_{\\text{Wet flux}}}\\right]\\frac{\\left({1-k}_{DINdepNO_x}\\right)}{\\Delta z_{surf}} \\tag{9.9} \\end{equation}\\] Where \\(\\Delta z_{surf}\\) is the surface layer thickness. Wet deposition adds nitrogen as a result of rain, \\(R_n\\) (m/day), which is a variable or a boundary condition provided as an environment variable from the host model. The deposition from rain is proportional to the atmospheric nitrogen concentration atm_din_conc. As with dry deposition, the proportion that is assigned to NOx and NH4+ is given by the same parameter f_dindep_nox. 9.3.1.5 Sediment flux NO3- and NH4+ can flux into the water column from the sediment, using the parameters \\(F_{sed}^{nit}\\) and \\(F_{sed}^{amm}\\), which set the maximum flux rate. The maximum flux rate is limited by temperature, using the parameters theta_sed_nit and theta_sed_amm, according to \\[\\begin{equation} f_{sed}^{NOx}=F_{sed}^{nit} \\theta_{sednit}^{T-20}\\Phi_{O2}^{nit}\\left[O_2\\right] \\tag{9.10} \\end{equation}\\] \\[\\begin{equation} f_{sed}^{NH4}=F_{sed}^{amm} \\theta_{sedamm}^{T-20}\\Phi_{O2}^{amm}\\left[O_2\\right] \\tag{9.11} \\end{equation}\\] This assumes that there is a higher flux at higher temperatures. Oxygen mediation of the sediment nitrogen fluxes: As with the nitrification reaction, the sediment flux can be changed by bottom water O2 concentration. If the aed2_oxygen module is correctly linked to the nitrogen module then this setting will switch on automatically. At low O2 concentrations, the amount of NO3- fluxing out of the sediment is decreased and at high O2 concentrations, it is set close to the F_sed_nit, as shown in Equation (9.12). This is a convenient simplification that can be tuned within this module, rather than a more complicated full set of biogeochemical reactions. The parameter K_sed_nit can be used to tune the NO3- flux dependence on bottom water O2. A similar function can be used to tune the NH4+ flux using the parameter K_sed_amm, as shown in Equation 13. At high O2 concentrations, NH4+ flux decreases, and at low O2 concentrations, the flux is close to the parameter F_{sed}^{amm}. \\[\\begin{equation} \\Phi_{O2}^{nit}\\left[O_2\\right]=\\frac{O_2}{K_{sednit}+O_2} \\tag{9.12} \\end{equation}\\] \\[\\begin{equation} \\Phi_{O2}^{amm}\\left[O_2\\right]=\\frac{K_{sedamm}}{K_{sedamm}+O_2} \\tag{9.13} \\end{equation}\\] Advanced options: The approach described here is the most simple and default method for capturing DIN fluxes from the sediment, and is sometimes referred to the static model. This approach can be extended to allow for spatial variability in \\(F_{sed}^{nit}\\) and \\(F_{sed}^{amm}\\), by engaging the link to the aed_sedflux module, where the host models support multiple benthic cells or zones. In this case, users input spatially discrete values of \\(F_{sed}^{nit}\\) and \\(F_{sed}^{amm}\\). Where dynamic rates of DIN species are required to flux to/from the sediment (e.g. in response to episodic loading of organic material to the sediment, or for assessment of long-term changes in N loading), then the above expressions (Eq (9.10)-(9.13)) are replaced instead with dynamically calculated variables in aed_seddiagenesis, via a link created with the aed2_sedflux module. 9.3.2 Variable Summary The default variables created by this module, and the optionally required linked variables needed for full functionality of this module are summarised in Table X. 9.3.3 Parameter Summary The default parameters and settings used by this module are summarised in Table @ref(tab:nitrogen_tab1). html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #eohpoanbmw .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 12px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #eohpoanbmw .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #eohpoanbmw .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #eohpoanbmw .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; border-top-color: #FFFFFF; border-top-width: 0; } #eohpoanbmw .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eohpoanbmw .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #eohpoanbmw .gt_col_heading { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #eohpoanbmw .gt_column_spanner_outer { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #eohpoanbmw .gt_column_spanner_outer:first-child { padding-left: 0; } #eohpoanbmw .gt_column_spanner_outer:last-child { padding-right: 0; } #eohpoanbmw .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #eohpoanbmw .gt_group_heading { padding: 8px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #eohpoanbmw .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #eohpoanbmw .gt_from_md > :first-child { margin-top: 0; } #eohpoanbmw .gt_from_md > :last-child { margin-bottom: 0; } #eohpoanbmw .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #eohpoanbmw .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #eohpoanbmw .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #eohpoanbmw .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #eohpoanbmw .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #eohpoanbmw .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #eohpoanbmw .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #eohpoanbmw .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eohpoanbmw .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #eohpoanbmw .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #eohpoanbmw .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #eohpoanbmw .gt_sourcenote { font-size: 90%; padding: 4px; } #eohpoanbmw .gt_left { text-align: left; } #eohpoanbmw .gt_center { text-align: center; } #eohpoanbmw .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #eohpoanbmw .gt_font_normal { font-weight: normal; } #eohpoanbmw .gt_font_bold { font-weight: bold; } #eohpoanbmw .gt_font_italic { font-style: italic; } #eohpoanbmw .gt_super { font-size: 65%; } #eohpoanbmw .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Parameter name Description Unit Parameter type Default Typical range Nitrification/Denitrification R_nitrif Kinetic rate constant for nitrification day-1 real 0.01 0.001-0.2 theta_nitrif Temperature dependence of nitrification real 1 1.05-1.12 R_denit Kinetic rate constant for denitrification day-1 real 0.01 theta_denit Temperature dependence of denitrification Unitless real 1 KNO3 Half saturation constant for NO3- limitation on denitrification mmol m-3 real 5 Kdenit O2 inhibition of denitirification or exponential reduction mmol m-3 real 150 oxy_lim Integer 1 1 or 2 NITpHTolMin Minimum tolerance pH unit real 5.5 NITpHOptMin Minimum optimum pH unit real 7.1 NITpHOptMax Maximum optimum pH unit real 7.9 NITpHTolMax Maximum tolerance pH unit real 9 Atmospheric Deposition simDryDeposition Switch to turn on atmospheric deposition LOGICAL TRUE simWetDeposition Switch to turn on rain deposition LOGICAL TRUE atm_din_dd Atmospheric DIN deposition rate mmol m-2 d-1 real 0 atm_din_conc Atmospheric DIN composition mmol m-3 real 0 f_dindep_nox Fraction of DIN that is NOx real 0.5 Sediment Flux Fsed_nit Sediment NO3- flux Fsed_amm Sediment NH4+ flux Ksed_nit Sediment NO3- flux mmol m-2 d-1 real 30 Ksed_amm Sediment NH4+ flux mmol m-2 d-1 real 30 theta_sed_nit Temperature dependence on sediment NO3- flux real 1 theta_sed_amm Temperature dependence on sediment NH4+ flux real 1 9.3.4 Optional Module Links 9.3.5 Feedbacks to the Host Model 9.4 Model Description - Adding N2O Reactions The basic function of the nitrogen model is described above, when the parameter simN2O is set to the number 0. Users may extend their model to simulate the N cycle in more detail, including resolution of intermediate N pools. Using these advanced options, there are extra reaction pathways that are not critical for resolving basic nutrient cycling processes, but are needed for calculating the concentration of the greenhouse gas N2O. Here, these advanced module options are outlined, for when the user sets the parameter simN2O to the number 1 or 2. Simulation option 1 includes N2O, using a relatively simplistic assumption that N2O passively “leaks out” as a by-product or is consumed during the traditional nitrification-denitrification reactions. Simulation option 2 is a more comprehensive biogeochemical depiction of N cycling between its different redox states and considering the full diversity of autotrophic and heterotrophic pathways. In addition to different N reaction pathways in these sub-models, the inclusion of additional inorganic N components is also accompanied by new process pathways for atmospheric exchange and sediment interaction. 9.4.1 Process Descriptions (simN20 = 1) The simN2O 1 option is based on the conceptual model from Babbin et al. or Nevison. If the parameter simN2O is set to the number 1, N2O is both created and consumed through the denitrification reaction, and produced during nitrification; these rates are oxygen dependent. The main balance equation for the additional N2O is summarised as: \\[\\begin{equation} \\frac{\\partial N_{2}O}{\\partial t} = {f_{nitp}^{N_{2}O}} + {f_{denp}^{N_{2}O}} - {f_{denc}^{N_{2}O}} + \\color{#394E73}{f_{atm}^{N_{2}O}} + \\color{#8B701F}{f_{sed}^{N2O}} \\tag{9.14} \\end{equation}\\] 9.4.1.1 Denitrification production of N2O All of the NO3- consumed by denitrification is assumed to first produces N2O. The rate of production of N2O is multiplied by half because there is one mole of N2O produced for every two moles of NO3- consumed. The rate of denitrification is calculated as described here, and can have different O2 limitations, using the parameter use_oxy. \\[\\begin{equation} f^{N_{2}O}_{denp} = \\frac{1}{2}f^{NO_{x}}_{denit} \\tag{9.15} \\end{equation}\\] 9.4.1.2 Denitrification consumption of N2O Denitrification can also consume N2O, when the N2O acts as a high energy yielding oxidant that reacts with organic matter. The organic matter reaction is described in the organic matter model page here. The rate of N2O consumption is calculated as shown in Equation (9.16). Rn2o is a kinetic rate constant that sets the speed of the reaction and Kn2oc is the parameter for the exponential O2 inhibition of the reaction. \\[\\begin{equation} f_{denc}^{N2O}=R_{N_{2}O} e^{(-O_2/{K_{N_2Oc}})} N_{2}O \\tag{9.16} \\end{equation}\\] 9.4.1.3 Nitrification production of N2O N2O is also produced by the O2 oxidation of NH4+ as: 9.4.1.4 Atmospheric N2O Flux N2O fluxes from the atmosphere are calculated from the difference between water and atmospheric concentration: \\begin{equation} f_{atm}^{N_{2}O}=k_{N_{2}O}(N_{2}O-N_{2}O_{atm}) \\end{equation} Where \\(N_{2}O_{atm}\\) is the user defined atmospheric value, and \\(k_{N_{2}O}\\) is the piston velocity; refer to generic utility Section X for more detail using aed2_gas_piston_velocity, and the n2o_piston_model options. 9.4.1.5 Sediment N2O Flux N2O flux from the sediment is calculated in a similar way to the fluxes of NO3- and NH4+(Equation 22). \\begin{equation} \\(f_{sed}^{N2O}=F_{sed}^{n2o} \\theta_{sedamm}^{T-20}\\Phi_{O2}^{n2o}\\left[O_2\\right]\\) \\end{equation} \\[ f_{sed}^{N_{2}O}=F_{sed}^{N_{2}O}\\theta_{sedamm}^{T-20}\\Phi_{O_{2}}^{N_{2}O}[O_2] \\] {#eq:label} 9.4.2 Process Descriptions (simN2O = 2) The simN2O 2 option uses the terminology from Weissbach et al. (2017) for the names of the reaction processes, in order to avoid the ambiguity found across publications. The model processes are described as being part of either the oxidation pathway or reduction pathway. The main balance equations for the additional simulated variables are sumamrised as: \\[\\begin{equation} \\frac{\\partial{NO}_3}{\\partial t}=f_{Nitratation}-f_{Denitratation}+f_{atmdep}^{NOx}+f_{sed}^{NO3} \\end{equation}\\] \\[\\begin{equation} \\frac{\\partial{NO}_2}{\\partial t}={f_{Nitritation}+f}_{Denitratation}-f_{Denitritation}+f_{sed}^{NO2} \\end{equation}\\] \\[\\begin{equation} \\frac{\\partial N_2O}{\\partial t}=f_{Nitrousation}+f_{nitrous\\ denitritation}-f_{denitrousation}+f_{atm}^{N2O}+f_{sed}^{N2O} \\end{equation}\\] \\[\\begin{equation} \\frac{\\partial{NH}_4}{\\partial t}=f_{DNRA}+f_{NH4\\ release}-f_{NH4\\ \\ oxidation}+f_{atmdep}^{NH4}+f_{sed}^{NH4} \\end{equation}\\] 9.4.2.1 Nitrogen Oxidation Pathways In the oxidation pathway, reduced N in the form of ammonium is first oxidised to NO2 and N2O before NO3, as seen in Figure 1. These processes are described next. Figure 9.3: Nitrogen oxidation pathways. 9.4.2.2 Nitratation Nitratation is the production of NO3^- (nitrate) from NO2- by O2 oxidation. The rate is calculated as a second-order reaction proportional to both NO2- and O2 concentrations (Equation 14). The parameter Rno2o2 is the kinetic rate constant for the reaction. \\[\\begin{equation} f_{Nitratation}=R_{{NO}_2O_2}\\times{NO}_2^-\\times O_2 \\end{equation}\\] 9.4.2.3 Ammonium oxidation NH4+ is oxidized by O2 to both N2O and NO2-. The rate of NH4+ consumption is the second-order reaction proportional to both O2 and NH4+ concentrations (Equation 15). The parameter Rnh4o2 is the kinetic rate constant for the reaction. \\[\\begin{equation} f_{Ammonium\\ oxidation}=R_{{NH}_4O_2}\\times{NH}_4^+\\times O_2 \\end{equation}\\] 9.4.2.4 Nitritation Nitritation is the production of NO2- (nitrite) under conditions of high O2 concentration, from ammonium oxidation. It is limited by a partitioning function, in which the constant Kpart_ammox is the same as that for nitrousation, described below. Above a critical O2 concentration, this reaction pathway is favoured (Equation 16). The term R~Ammonium oxidation~ refers to the rate equation described above, rather than a kinetic constant. \\[\\begin{equation} f_{Nitritation}=f_{Ammonium\\ oxidation}\\frac{O_2}{K_{part\\ ammox}^ +O_2} \\end{equation}\\] 9.4.2.5 Nitrousation Nitrousation is one of two pathways that produce N2O using simN2O set to the number 2 (the other pathway is the reduction of NO2- via nitrous denitritation). This process occurs under conditions of low O2 concentration, and it is inhibited by oxygen, using an inhibition function (Equation 18). The constantKpart_ammox is the same as that in the nitritation process, which means that below a critical O2 concentration, this reaction pathway is favoured over nitritation. The reaction is multiplied by half, because for each mole of NH4+ oxidized, one mole of N2O is produced. The term R~Ammonium oxidation~ refers to the rate equation described above, rather than a kinetic constant. \\[\\begin{equation} f_{Nitrousation}=\\frac{1}{2}f_{Ammonium\\ oxidation}\\frac{K_{part\\ ammox}}{K_{part\\ ammox} +O_2} \\end{equation}\\] 9.4.2.6 Organic matter oxidation - nitrogen reduction reactions When the simN2O switch is set to 2, the complex set of N2O reactions is used. The details of the organic matter processes are explained on the organic matter model page here. The five nitrogen processes are explained here. 9.4.2.7 Deammonification (anammox) pathway Figure 9.4: Anammox pathways. The deammonification pathway is the oxidation of NH4+ by NO2- to produce N2. It uses neither organic matter nor O2, although it is inhibited by the presence of O2. This process is sometimes referred to as anammox (anaerobic ammonium oxidation), however, Weissbach et al (2017) use the term deammonification to distinguish it from the anammox commercial bioreactor. The parameter Rnh4no2 is the kinetic rate constant for this reaction. The parameter Kin_deamm is the O2 concentration parameter for O2 inhibition of this reaction. \\[\\begin{equation} f_{deammonification}=R_{{NH}_4{NO}_2}\\times{NO}_2^-\\times{NH}_4^+\\times\\frac{K_{in\\ deamm}}{K_{in\\ deamm} +O_2} \\end{equation}\\] 9.4.3 Variable Summary 9.4.3.1 State variables The following state variables are relevant to the nitrogen module, and dependent variables from other modules (Table x). html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #uocyghauqw .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 12px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: 100%; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #uocyghauqw .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #uocyghauqw .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #uocyghauqw .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; border-top-color: #FFFFFF; border-top-width: 0; } #uocyghauqw .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #uocyghauqw .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #uocyghauqw .gt_col_heading { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #uocyghauqw .gt_column_spanner_outer { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #uocyghauqw .gt_column_spanner_outer:first-child { padding-left: 0; } #uocyghauqw .gt_column_spanner_outer:last-child { padding-right: 0; } #uocyghauqw .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #uocyghauqw .gt_group_heading { padding: 8px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #uocyghauqw .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #uocyghauqw .gt_from_md > :first-child { margin-top: 0; } #uocyghauqw .gt_from_md > :last-child { margin-bottom: 0; } #uocyghauqw .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #uocyghauqw .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #uocyghauqw .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #uocyghauqw .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #uocyghauqw .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #uocyghauqw .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #uocyghauqw .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #uocyghauqw .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #uocyghauqw .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #uocyghauqw .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #uocyghauqw .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #uocyghauqw .gt_sourcenote { font-size: 90%; padding: 4px; } #uocyghauqw .gt_left { text-align: left; } #uocyghauqw .gt_center { text-align: center; } #uocyghauqw .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #uocyghauqw .gt_font_normal { font-weight: normal; } #uocyghauqw .gt_font_bold { font-weight: bold; } #uocyghauqw .gt_font_italic { font-style: italic; } #uocyghauqw .gt_super { font-size: 65%; } #uocyghauqw .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Symbol Variable AED identifier Unit Comment aed_nitrogen NO3- Nitrate NIT_nit mmol m-3 simN2O=1,2 NO2- Nitrite NIT_no2 mmol m-3 simN2O=2 only N2O Nitrous oxide NIT_n2o mmol m-3 simN2O=1,2 NH4+ Ammonium NIT_amm mmol m-3 simN2O=1,2 N2 Dinitrogen NIT_n2 mmol m-3 not tracked Dependent variables O2 Oxygen OXY_oxy mmol m-3 DOC Dissolved organic carbon OGM_doc mmol m-3 9.4.3.2 Diagnostics variables The following diagnostic variables are able to be output, based on the setting of diag_level&gt;0 (Table x). 9.4.4 Parameter summary An overview of the parameters used in the nitrogen module for users selecting simN2O 1 or 2, are summarised in Table X. html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #lbrfmmpptn .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 12px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #lbrfmmpptn .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lbrfmmpptn .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #lbrfmmpptn .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; border-top-color: #FFFFFF; border-top-width: 0; } #lbrfmmpptn .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lbrfmmpptn .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #lbrfmmpptn .gt_col_heading { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #lbrfmmpptn .gt_column_spanner_outer { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #lbrfmmpptn .gt_column_spanner_outer:first-child { padding-left: 0; } #lbrfmmpptn .gt_column_spanner_outer:last-child { padding-right: 0; } #lbrfmmpptn .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #lbrfmmpptn .gt_group_heading { padding: 8px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #lbrfmmpptn .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #lbrfmmpptn .gt_from_md > :first-child { margin-top: 0; } #lbrfmmpptn .gt_from_md > :last-child { margin-bottom: 0; } #lbrfmmpptn .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #lbrfmmpptn .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #lbrfmmpptn .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lbrfmmpptn .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #lbrfmmpptn .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #lbrfmmpptn .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #lbrfmmpptn .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #lbrfmmpptn .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #lbrfmmpptn .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lbrfmmpptn .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #lbrfmmpptn .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #lbrfmmpptn .gt_sourcenote { font-size: 90%; padding: 4px; } #lbrfmmpptn .gt_left { text-align: left; } #lbrfmmpptn .gt_center { text-align: center; } #lbrfmmpptn .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #lbrfmmpptn .gt_font_normal { font-weight: normal; } #lbrfmmpptn .gt_font_bold { font-weight: bold; } #lbrfmmpptn .gt_font_italic { font-style: italic; } #lbrfmmpptn .gt_super { font-size: 65%; } #lbrfmmpptn .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Parameter name Description Unit Parameter type Default Typical range Comment simN2O Switch to use simple or advanced N reactions INTEGER 1 0, 1, 2 Rn2o Kinetic rate constant for N2O consumption s-1 AED_REAL 0.0015 Kn2oc Exponential O2 inhibiting parameter for N2O consumption through denitrification mmol m-3 AED_REAL 0.3 Knev O2 threshold for switching on N2O production from nitrification mmol m-3 AED_REAL 3 aa O2 inhibition parameter mmol m-3 AED_REAL 0.26 bb O2 inhibition parameter AED_REAL -0.0006 simN2O Switch to use simple or advanced N reactions INTEGER 2 0, 1, 2 Rno2o2 Kinetic rate constant for nitratation mmol-1 m3 s-1 AED_REAL 1 Rnh4o2 Kinetic rate constant for nitratation mmol-1 m3 s-1 AED_REAL 1 Kpart_ammox Partitioning parameter for the products of ammonium oxidation, based on O2 concentration mmol m-3 AED_REAL 20 Rdom_minerl Kinetic rate constant for DOC mineralisation mmol-1 m3 s-1 AED_REAL 0.001 OGM Kdom_minerl O2 concentration for inhibition and limitation mmol m-3 AED_REAL 0.886 OGM theta_minerl Temperature parameter AED_REAL 1 OGM f_an 1 OGM `Klim_denitrousv N2O concentration to limit denitrousation and to inhibit denitratation and denitritation mmol m-3 AED_REAL 1 Kin_denitrousv O2 concentration to inhibit denitrousation mmol m-3 AED_REAL 0.205 Knit NO3- concentration to limit denitratation mmol m-3 AED_REAL 1 Kin_denitrat O2 concentration for inhibiting denitratation mmol m-3 AED_REAL 20 Klim_denitrit NO2- concentration parameter that inhibits denitratation and limits denitritation mmol m-3 AED_REAL 1 Kpart_denitrit Partitioning parameter for the products of denitritation mmol m-3 AED_REAL 1 simN2O Switch to use simple or advanced N reactions INTEGER 2 0, 1, 2 Rnh4no2 Kinetic rate constant for deammonification mmol-1 m3 s-1 AED_REAL 1 Kin_deamm O2 concentration for inhibition of deammonification mmol m-3 AED_REAL 0.886 simN2O Switch to use simple or advanced N reactions INTEGER 1 or 2 0, 1, 2 atm_n2o Atmospheric N2O concentration mmol m-3 or ppm AED_REAL 0.32×10-6 simN2O Switch to use simple or advanced N reactions INTEGER 1 or 2 0, 1, 2 use_oxy Fsed_n2o Maximum N2O sediment flux rate mmol m-2 y-1 0 Ksed_n2o O2 inhibition concentration parameter mmol m-2 y-1 AED_REAL 30 theta_sed_n2o Temperature limiting factor for sediment N2O flux AED_REAL 1 9.5 Setup &amp; Configuration 9.6 Case Studies &amp; Examples 9.6.1 Case Study: Yarra River Estuary Bruce et al (2015) demonstrate the base model in a 3D model of Yarra River estuary. The model results are shown in Figure X. Figure 9.5: Time series data for surface (blue) and bottom (red) ammonium, nitrate, dissolved and particulate organic nitrogen for (a) Morell Bridge, (b) Scotch College, (c) Bridge Road. Crosses and asterisks represent observed data for surface and bottom concentrations respectively and solid lines simulated data. 9.6.2 Case Study: Swan River Estuary Huang et al. (2019) demonstrate the base model in a 3D model of Swan River estuary. A transect of the model results are shown in Figure X. 9.6.3 Publications html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #pvaloawqix .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 12px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: 100%; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pvaloawqix .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pvaloawqix .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pvaloawqix .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; border-top-color: #FFFFFF; border-top-width: 0; } #pvaloawqix .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pvaloawqix .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pvaloawqix .gt_col_heading { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pvaloawqix .gt_column_spanner_outer { color: #FFFFFF; background-color: #14759E; font-size: 14px; font-weight: bold; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pvaloawqix .gt_column_spanner_outer:first-child { padding-left: 0; } #pvaloawqix .gt_column_spanner_outer:last-child { padding-right: 0; } #pvaloawqix .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #pvaloawqix .gt_group_heading { padding: 8px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #pvaloawqix .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #D3D3D3; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pvaloawqix .gt_from_md > :first-child { margin-top: 0; } #pvaloawqix .gt_from_md > :last-child { margin-bottom: 0; } #pvaloawqix .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pvaloawqix .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #pvaloawqix .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pvaloawqix .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #pvaloawqix .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pvaloawqix .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pvaloawqix .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pvaloawqix .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pvaloawqix .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pvaloawqix .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #pvaloawqix .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pvaloawqix .gt_sourcenote { font-size: 90%; padding: 4px; } #pvaloawqix .gt_left { text-align: left; } #pvaloawqix .gt_center { text-align: center; } #pvaloawqix .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pvaloawqix .gt_font_normal { font-weight: normal; } #pvaloawqix .gt_font_bold { font-weight: bold; } #pvaloawqix .gt_font_italic { font-style: italic; } #pvaloawqix .gt_super { font-size: 65%; } #pvaloawqix .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 65%; } Author/Year Paper Title Description Bruce et al. (2015) A model of oxygen and nitrogen biogeochemical response to hydrodynamic regimes in the Yarra River estuary NA Huang et al. (2019) An integrated modelling system for water quality forecasting in an urban eutrophic estuary: The Swan-Canning Estuary virtual observatory NA References "],["phosphorous.html", "10 Phosphorous 10.1 Contributors 10.2 Overview 10.3 Model Description 10.4 Setup &amp; Configuration 10.5 Case Studies &amp; Examples", " 10 Phosphorous 10.1 Contributors 10.2 Overview 10.3 Model Description 10.3.1 Process Descriptions 10.3.2 Variable Summary 10.3.3 Parameter Summary 10.3.4 Optional Module Links 10.3.5 Feedbacks to the Host Model 10.4 Setup &amp; Configuration 10.5 Case Studies &amp; Examples 10.5.1 Case Study 10.5.2 Publications "],["silica.html", "11 Silica 11.1 Contributors 11.2 Overview 11.3 Model Description 11.4 Setup &amp; Configuration 11.5 Case Studies &amp; Examples", " 11 Silica 11.1 Contributors 11.2 Overview 11.3 Model Description 11.3.1 Process Descriptions 11.3.2 Variable Summary 11.3.3 Parameter Summary 11.3.4 Optional Module Links 11.3.5 Feedbacks to the Host Model 11.4 Setup &amp; Configuration 11.5 Case Studies &amp; Examples 11.5.1 Case Study 11.5.2 Publications "],["organic-matter.html", "12 Organic Matter 12.1 Contributors 12.2 Overview 12.3 Model Description 12.4 Setup &amp; Configuration 12.5 Case Studies &amp; Examples", " 12 Organic Matter 12.1 Contributors 12.2 Overview 12.3 Model Description 12.3.1 Process Descriptions 12.3.2 Variable Summary 12.3.3 Parameter Summary 12.3.4 Optional Module Links 12.3.5 Feedbacks to the Host Model 12.4 Setup &amp; Configuration 12.5 Case Studies &amp; Examples 12.5.1 Case Study 12.5.2 Publications "],["phytoplankton.html", "13 Phytoplankton 13.1 Contributors 13.2 Overview 13.3 Model Description 13.4 Setup &amp; Configuration 13.5 Case Studies &amp; Examples", " 13 Phytoplankton 13.1 Contributors 13.2 Overview The approach to simulate algal biomass is to adopt several plankton functional types (PFTs) that are typically defined based on specific groups such as diatoms, dinoflagellates and cyanobacteria. Whilst each group that is simulated is unique, they share a common mathematical approach and each simulate growth, death and sedimentation processes, and customisable internal nitrogen, phosphorus and/or silica stores if desired. Distinction between groups is made by adoption of groups specific parameters for environmental dependencies, and/or enabling options such as vertical migration or N fixation. For each phytoplankton group, the maximum potential growth rate at 20°C is multiplied by the minimum value of expressions for limitation by light, phosphorus, nitrogen and silica (when configured). While there may be some interaction between limiting factors, a minimum expression is likely to provide a realistic representation of growth limitation (Rhee and Gotham, 1981). 13.3 Model Description 13.3.1 Process Descriptions Photosynthesis &amp; Nutrient Uptake For each phytoplankton group, the maximum potential growth rate at 20˚C is multiplied by the minimum value of expressions for limitation by light, phosphorus, nitrogen and silica (when configured). While there may be some interaction between limiting factors, a minimum expression is likely to provide a realistic representation of growth limitation (Rhee and Gotham, 1981). Therefore, photosynthesis is parameterized as the uptake of carbon, and depends on the temperature, light and nutrient dimensionless functions (adopted from Hipsey &amp; Hamilton, 2008; Li et al., 2013). \\[\\begin{equation} \\text{Mass Balance Equation} \\tag{13.1} \\end{equation}\\] \\[\\begin{align} {f_{uptake}^{PHY_{Ca}}} &amp;= \\end{align}\\] \\[\\begin{align} \\underbrace{{R_{growth}^{PHY_{a}}}}_{\\text{Max growth rate at 20˚C}}*\\underbrace{(1-{k_{pr}^{PHY_{a}}})}_{\\text{Photorespiratory loss}}*\\underbrace{{\\Phi_{tem}^{PHY_{a}}}(T)}_{\\text{Temperature scaling}}*\\underbrace{{\\Phi_{str}^{PHY_{a}}}(T)}_{\\text{Metabolic stress}}* \\end{align}\\] \\[\\begin{align} &amp;{\\text{min}}\\begin{Bmatrix}\\underbrace{\\Phi_{light}^{PHY_{a}}(I)}_{\\text{Light limitation}},\\underbrace{\\Phi_{N}^{PHY_{a}}(NO_{3},NH_{4},PHY_{N_{a}})}_{\\text{N limitation}},\\underbrace{\\Phi_{P}^{PHY_{a}}(PO_{4},PHY_{P_{a}})}_{\\text{P limitation}},\\underbrace{\\Phi_{Si}^{PHY_{a}}(RSi)}_{\\text{Si limitation}}\\end{Bmatrix}* \\end{align}\\] \\[\\begin{align} [PHY_{C_{a}}] \\end{align}\\] To allow for reduced growth at non-optimal temperatures, a temperature function is used where the maximum productivity occurs at a temperature \\(T_{OPT}\\); above this productivity decreases to zero at the maximum allowable temperature, \\(T_{MAX}\\). Below the standard temperature, \\(T_{STD}\\) the productivity follows a simple Arrenhius scaling formulation. In order to fit a function with these restrictions the following conditions are assumed: at \\(T=T_{STD}\\),\\(\\ {\\ \\Phi}_{tem}\\left(T\\right)=1\\) and at \\(T=T_{OPT},\\ \\ \\frac{d\\Phi_{tem}\\left(T\\right)}{dT}=0\\), and at \\(T=T_{MAX}\\),\\(\\ \\Phi_{tem}\\left(T\\right)=0\\). This can be numerically solved using Newton’s iterative method and can be specific for each phytoplankton group. The temperature function is calculated according to (Griffin et al. 2001): \\[\\begin{equation} \\Phi_{tem}^{{PHY}_a}\\left(T\\right)=\\vartheta_a^{T-20}-\\vartheta_a^{k\\left[T-{c1}_a\\right]}+{c0}_a \\tag{13.2} \\end{equation}\\] Where \\({c1}_a\\) and \\({c0}_a\\) are solved numerically given input values of: \\(T_a^{std}\\), \\(T_a^{opt}\\) and \\(T_a^{max}\\). The level of light limitation on phytoplankton growth can be modelled as photoinhibition or non-photoinhibition. In the absence of significant photoinhibition, Webb et al. (1974) suggested a relationship for the fractional limitation of the maximum potential rate of carbon fixation for the case where light saturation behavior was absent (Talling, 1957), and the equations can be analytically integrated with respect to depth (Hipsey and Hamilton, 2008). For the case of photoinhibition, the light saturation value of maximum production (IS) is used and the net level effect can be averaged over the cell by integrating over depth. The aed_phytoplankton module contains several light functions, including those from a recent review by Baklouti et al. (2006). The user must select the sensitivity to light according to a photosynthesis-irradiance (P-I curve) formulation and each species must be set to be either non-photoinhibited or photoinhibited according to the options in Table 9. Table Limitation of the photosynthetic rate may be dampened according to nitrogen or phosphorus availability, and this is either approximated using a Monod expression of the static model is chosen, or based on the internal nutrient stoichiometry if the dynamic (Droop uptake) model is selected: For advanced users, an optional metabolic scaling factor can be included to reduce the photosynthetic capacity of the simulated organisms, for example due to metabolic stress due to undertaking N2 fixation: \\[\\begin{equation} \\Phi_{str}^{{PHY}_a}=\\underbrace{f_{NF}^{{PHY}_a}+\\left[{1-f}_{NF}^{{PHY}_a}\\right]\\Phi_N^{{PHY}_a}\\left({NO}_3,{NH}_4,{PHY_N}_a\\right)}_{N_{2}\\text{ fixation growth scaling}} \\tag{13.3} \\end{equation}\\] The above discussion relates to photosynthesis and carbon uptake by the phytoplankton community. In addition users must choose one of two options to model the P, N uptake dynamics for each algal group: a constant nutrient to carbon ratio, or dynamic intracellular stores. For the first model a simple Michaelis-Menten equation is used to model nutrient limitation with a half-saturation constant for the effect of external nutrient concentrations on the growth rate. The internal phosphorus and nitrogen dynamics within the phytoplankton groups can be modelled using dynamic intracellular stores that are able to regulate growth based on the model of Droop (1974). This model allows for the phytoplankton to have dynamic nutrient uptake rates with variable internal nutrient concentrations bounded by user-defined minimum and maximum values (e.g., see Li et al., 2013). Table The uptake of nitrogen must be partitioned into uptake of NO3, NH4 and potentially labile DON. In the present version, distinction between uptake of NO3 and NH4 is calculated automatically via a preference factor: \\[\\begin{equation} {\\ p}_{NH4}^{{PHY}_a}=\\frac{{NO}_3\\ {NH}_4}{\\left({NH}_4+K_N^{{PHY}_a}\\right)\\left({NO}_3+K_N^{{PHY}_a}\\right)}\\frac{{NH}_4{\\ K}_N^{{PHY}_a}}{\\left({NH}_4+{NO}_3\\right)\\left({NO}_3+K_N^{{PHY}_a}\\right)} \\tag{13.4} \\end{equation}\\] \\[\\begin{equation} p_{NO3}^{{PHY}_a}=1-{\\ p}_{NH4}^{{PHY}_a} \\tag{13.5} \\end{equation}\\] For diatom groups, silica processes are simulated that include uptake of dissolved silica. The silica limitation function for diatoms is similar to the constant cases for nitrogen and phosphorus which assumes a fixed C:Si ratio. Respiration, Excretion &amp; Mortality Metabolic loss of nutrients from mortality and excretion is proportional to the internal nitrogen to chla ratio multiplied by the loss rate and the fraction of excretion and mortality that returns to the detrital pool. Loss terms for respiration, natural mortality and excretion are modelled with a single ‘respiration’ rate coefficient. This loss rate is then divided into the pure respiratory fraction and losses due to mortality and excretion. The constant \\(f_{DOM}\\) is the fraction of mortality and excretion to the dissolved organic pool with the remainder into the particulate organic pool. Nutrient losses through mortality and excretion for the internal nutrient model are similar to the simple model described above, except that dynamically calculated internal nutrient concentrations are used. \\[\\begin{align*} \\hat{R}&amp;=R_{resp}^{{PHY}_a}\\ \\ \\Phi_{sal}^{{PHY}_a}\\left(S\\right)\\ \\ \\left(\\vartheta_{resp}^{{PHY}_a}\\right)^{T-20} \\tag{13.6}\\\\ f_{resp}^{{PHY_C}_a}&amp;=k_{fres}^{{PHY}_a}\\ \\hat{R}\\ \\left[{PHY_C}_a\\right] \\tag{13.7}\\\\ f_{excr}^{{PHY_C}_a}&amp;=\\left(1-k_{fres}^{{PHY}_a}\\right)\\ k_{fdom}^{{PHY}_a}\\ \\hat{R}\\ \\ \\left[{PHY_C}_a\\right] \\tag{13.8}\\\\ f_{mort}^{{PHY_C}_a}&amp;=\\left(1-k_{fres}^{{PHY}_a}\\right)\\ \\left({1-k}_{fdom}^{{PHY}_a}\\right)\\ \\hat{R}\\ \\left[{PHY_C}_a\\right] \\tag{13.9}\\\\ f_{excr}^{{PHY_N}_a}&amp;=k_{fdom}^{{PHY}_a}\\ \\hat{R}\\ \\left[{PHY_N}_a\\right] \\tag{13.10}\\\\ f_{mort}^{{PHY_N}_a}&amp;=\\left(1-k_{fdom}^{{PHY}_a}\\right)\\ \\hat{R}\\ \\left[{PHY_N}_a\\right] \\tag{13.11}\\\\ f_{excr}^{{PHY_P}_a}&amp;=k_{fdom}^{{PHY}_a}\\ \\hat{R}\\ \\left[{PHY_P}_a\\right] \\tag{13.12}\\\\ f_{mort}^{{PHY_P}_a}&amp;=\\left(1-k_{fdom}^{{PHY}_a}\\right)\\ \\hat{R}\\ \\ \\left[{PHY_P}_a\\right] \\tag{13.13}\\\\ f_{excr}^{{PHY_{Si}}_a}&amp;=\\hat{R}\\ \\left[{PHY_{Si}}_a\\right] \\tag{13.14} \\end{align*}\\] The salinity effect on mortality is given by various quadratic formulations, depending on the groups sensitivity to salinity (Griffin et al 2001; Robson and Hamilton, 2004). An example of the use of various salinity limitation options is shown in Figure 3. 13.3.2 Variable Summary State Variables Table 13.1: State variables Variable Name Description Units Variable Type Core/Optional PHY_{Group} Phytoplanton group \\(mmol\\,m^{-3}\\) Pelagic Core PHY_{Group}_IN Internal nitrogen of phytoplakton group x NA NA Optional PHY_{Group}_IP Internal phosphorus of phytoplakton group x NA NA Optional Diagnostics Table 13.2: Diagnostics Variable Name Description Units Variable Type Core/Optional PHY_tchla Total chlorophyll-a \\(ug\\,L^{-1}\\) Pelagic diagnostic Core PHY_GPP Gross primary production \\(mmol C\\,m^{-3}\\,day^{-1}\\) Pelagic diagnostic Core PHY_{group}_f(I/T/S/N/P/Si) Phytoplankton growth limitation of light/nutrients NA Pelagic diagnostic Core PSED_PHY Phytoplankton sedimentation \\(mmol\\,m^{-2}\\,s^{-1}\\) NA NA PHY_NCP Net community production \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_NUP Nitrogen uptake \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_PUP Phosphorus uptake \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_CUP Carbon uptake \\(mmol\\,m^{-3}\\,day^{-1}\\) NA NA PHY_PAR Photosynthetically active radiation \\(W\\,m^{-2}\\) NA NA PHY_IN Phytoplankton nitrogen \\(mmol\\,m^{-3}\\) NA NA PHY_IP Phytoplankton phosphorus \\(mmol\\,m^{-3}\\) NA NA PHY_MBP Microphytobenthos \\(mmol\\,m^{-2}\\) NA NA PHY_BPP Benthic productivity \\(mmol\\,m^{-2}\\,day^{-1}\\) NA NA PHY_MPBV Microphytobenthos vertical ewxchange \\(mmol\\,m^{-2}\\,day^{-1}\\) NA NA PHY_PPR Gross phytoplankton p/r ratio NA NA NA PHY_NPR Net phytoplankton p/r ratio NA NA NA PHY_{Group}_NtoP NA NA NA NA 13.3.3 Parameter Summary Table 13.3: Diagnostics p_name ‘Peridinium’ ‘cyano’ ‘green’ ‘karlodinium’ ‘phy05’ ‘phy06’ ‘diatom’ ‘crypto’ ‘cryptophyte’ ‘chlorophyte’ ‘synechococcus’ ‘MICROCYSTIS’ ‘Cyanobacteria’ ‘Cyanobacteria’ ‘n_spumigena’ ‘Peridinium’ ‘Microcystis’ ‘Microcystis(1)’ ‘Aphanizomenon’ ‘Nanoplankton’ ‘Cayelan_Test’ string Name of phytoplankton group GENERAL parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA p_initial 1.0000 10.0000 0.0400 10.0000 10.0000 10.0000 10.0000 8.4000 2.4000 10.0000 10.0000 10.0000 200.0000 10.0000 10.0000 2.81e+00 102.0000 2.81e+00 2.81e+00 2.81e+00 2.81e+00 real Initial concentration of phytoplankton (mmol C/m3) p0 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 5.0000 0.0300 0.0300 3.00e-02 0.0300 3.00e-02 3.00e-02 3.00e-02 3.00e-02 real Minimum concentration of phytoplankton (mmol C/m3) w_p 0.0000 0.0000 -0.0100 0.0000 0.0000 0.0000 -0.1040 -0.1040 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 real sedimentation rate (m/d) Xcc 50.0000 50.0000 40.0000 50.0000 50.0000 50.0000 40.0000 40.0000 40.0000 50.0000 50.0000 50.0000 40.0000 40.0000 50.0000 5.50e+01 50.0000 9.20e+01 7.70e+01 8.00e+01 7.70e+01 real carbon to chlorophyll ratio (mg C/mg chla) GROWTH parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA R_growth 1.1000 1.1000 0.7000 1.1000 1.1000 1.1000 2.8000 1.1000 0.7000 1.1000 1.1000 1.1000 0.5300 1.1000 1.1000 3.50e-01 1.1000 7.00e-01 4.10e-01 2.70e+00 4.10e-01 real Phyto max growth rate (20C?) (/day) fT_Method 1.0000 1.0000 0.0000 1.0000 1.0000 1.0000 0.0000 0.0000 0.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 0.00e+00 1.00e+00 integer Specifies temperature limitation function of growth (-); 0 = no temperature limitation 1= CAEDYM style theta_growth 1.0600 1.0600 1.0800 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0600 1.0800 1.0600 1.0600 1.07e+00 1.0600 1.07e+00 1.10e+00 1.07e+00 1.10e+00 real Arrenhius temperature scaling for growth function (-) T_std 20.0000 20.0000 20.0000 20.0000 20.0000 20.0000 15.0000 15.0000 20.0000 20.0000 20.0000 20.0000 20.0000 20.0000 20.0000 1.90e+01 20.0000 1.90e+01 2.40e+01 2.00e+01 2.40e+01 real Standard temperature (deg C) T_opt 28.0000 28.0000 27.0000 28.0000 28.0000 28.0000 20.0000 20.0000 28.0000 28.0000 28.0000 28.0000 28.7000 28.0000 28.0000 2.40e+01 28.0000 2.60e+01 2.90e+01 2.70e+01 2.90e+01 real Optimum temperature (deg C) T_max 35.0000 35.0000 33.0000 35.0000 35.0000 35.0000 32.0000 32.0000 34.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 3.20e+01 35.0000 3.50e+01 3.40e+01 3.50e+01 3.40e+01 real Maximum temperature (deg C) LIGHT parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA lightModel 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Type of light response function [0 = no photoinhibition; 1 = photoinhibition] I_K 25.0000 25.0000 25.0000 25.0000 25.0000 25.0000 10.0000 10.0000 25.0000 25.0000 25.0000 25.0000 228.0000 25.0000 25.0000 1.75e+01 25.0000 1.75e+01 1.75e+01 1.75e+01 1.75e+01 real Half saturation constant for light limitation of growth (microE/m2/s) used if lightModel=0 I_S 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 100.0000 230.0000 100.0000 100.0000 6.00e+02 100.0000 1.50e+02 8.00e+01 4.00e+02 8.00e+01 real saturating light intensity (microE/m2/s) used if lightModel=1 KePHY 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0010 0.0010 0.0050 0.0050 0.0050 0.0050 0.0000 0.0050 0.0050 1.20e-04 0.0050 1.20e-04 1.20e-04 1.20e-04 1.20e-04 real Specific attenuation coefficient ((mmol C m3-1)1 m-1) RESPIRATION parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA f_pr 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0020 0.0020 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 4.00e-03 0.0050 4.00e-03 4.00e-03 4.00e-03 4.00e-03 real Fraction of primary production lost to exudation (-) R_resp 0.0800 0.0800 0.0120 0.0800 0.0800 0.0800 0.1200 0.1200 0.0120 0.0800 0.0800 0.0800 0.0800 0.0800 0.0800 6.60e-02 0.0800 6.60e-02 6.60e-02 6.60e-02 6.60e-02 real Phytoplankton respiration/metabolic loss rate @ 20 (degC) theta_resp 1.0500 1.0500 1.0600 1.0500 1.0500 1.0500 1.0700 1.0700 1.0500 1.0500 1.0500 1.0500 1.0500 1.0500 1.0500 1.05e+00 1.0500 1.05e+00 1.05e+00 1.05e+00 1.05e+00 real Arrhenius temperature scaling factor for respiration (-) k_fres 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 0.6000 2.50e-01 0.6000 2.50e-01 2.50e-01 2.50e-01 2.50e-01 real Fraction of metabolic loss that is true respiration (-) k_fdom 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 0.0500 2.00e-01 0.0500 2.00e-01 2.00e-01 2.00e-01 2.00e-01 real Fraction of metabolic loss that is DOM (-) SALINITY parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA salTol 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Type of salinity limitation function (-) S_bep 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.00e+00 2.0000 2.00e+00 2.00e+00 2.00e+00 2.00e+00 real Salinity limitation value at maximum salinity S_maxsp (-) S_maxsp 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 35.0000 3.50e+01 35.0000 3.50e+01 3.50e+01 3.50e+01 3.50e+01 real Maximum salinity (g/kg) S_opt 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 1.00e+00 1.00e+00 real Optimal salinity (g/kg) NITROGEN parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA simDINUptake 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 1.00e+00 1.00e+00 integer Simulate DIN uptake (0 = false 1 = true) simDONUptake 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Simulate DON uptake (0 = false 1 = true) simNFixation 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Simulate N fixation (0 = false 1 = true) simINDynamics 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.00e+00 2.0000 2.00e+00 2.00e+00 2.00e+00 2.00e+00 integer Simulate internal N (0 = assumed fixed C:N 2 = dynamic C:N) N_o 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 0.2500 2.50e-01 0.2500 2.50e-01 2.50e-01 2.50e-01 2.50e-01 real Nitrogen concentraion below which uptake is 0 (mmol N/m3) K_N 4.0000 4.0000 3.2100 4.0000 4.0000 4.0000 3.5700 3.5700 3.2100 4.0000 4.0000 4.0000 4.0000 4.0000 4.0000 3.39e+00 4.0000 3.39e+00 3.39e+00 3.39e+00 3.39e+00 real Half-saturation concentration of nitrogen (mmol N/m3) X_ncon 232342.0000 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 3.50e-02 0.0350 3.50e-02 3.50e-02 3.50e-02 3.50e-02 real Constant internal nitrogen concentration (mmol N/ mmol C) used if simINDynamics = 0 or 1 X_nmin 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 3.00e-03 0.0200 2.00e-03 1.70e-02 7.00e-03 1.70e-02 real minimum internal nitrogen concentration (mmol N/ mmol C) used if simINDynamics = 2 X_nmax 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 0.0700 6.00e-03 0.0700 5.00e-03 9.00e-03 2.80e-02 9.00e-03 real maximum internal nitrogen concentration (mmol N/ mmol C) used if simINDynamics = 2 R_nuptake 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 2.00e-02 0.0200 2.00e-02 2.00e-02 2.00e-02 2.00e-02 real maximum nitrogen uptake rate(mmol N/m3/d) used if simINDynamics = 2 k_nfix 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 0.7000 7.00e-01 0.7000 7.00e-01 7.00e-01 7.00e-01 7.00e-01 real growth rate reduction under maximum nitrogen fixation (/day) used if simNFixation &gt;0 R_nfix 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.0350 0.00e+00 0.0350 0.00e+00 1.20e-02 0.00e+00 1.20e-02 real nitrogen fixation rate (mmol N/mmol C/day) PHOSPHORUS parameters NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA simDIPUptake 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.00e+00 1.0000 1.00e+00 1.00e+00 1.00e+00 1.00e+00 integer Simulate DIP uptake (0 = false 1 = true) simIPDynamics 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.0000 2.00e+00 2.0000 2.00e+00 2.00e+00 2.00e+00 2.00e+00 integer Simulate internal phosphorus dynamics (0 = assumed fixed C:P 2 = dynamic C:P) P_0 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 0.0300 3.00e-02 0.0300 3.00e-02 3.00e-02 3.00e-02 3.00e-02 real Phosphorus concentraion below which uptake is 0 (mmol P/m3) K_P 0.1500 0.1500 0.1600 0.1500 0.1500 0.1500 0.1600 0.1600 0.1600 0.1500 0.1500 0.1500 0.1500 0.1500 0.1500 7.74e-05 0.1500 5.80e-05 3.87e-05 4.51e-05 3.87e-05 real Half-saturation concentration of phosphorus (mmol P/m3) X_pcon 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 0.0015 1.50e-03 0.0015 1.50e-03 1.50e-03 1.50e-03 1.50e-03 real Constant internal phosphorus concentration (mmol P/ mmol C) used if simIPDynamics = 0 or 1 X_pmin 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.0005 0.00e+00 0.0005 3.00e-03 6.00e-03 3.00e-03 6.00e-03 real Minimum internal phosphorus concentration (mmol P/mmol C) used if simIPDynamics = 2 X_pmax 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 1.00e-03 0.0050 1.90e-02 5.02e-01 1.20e-02 5.02e-01 real Maximum internal phosphorus concentration (mmol P/mmol C) used if simIPDynamics = 2 R_puptake 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 0.0010 1.00e-03 0.0010 1.00e-03 1.00e-03 1.00e-03 1.00e-03 real Maximum phosphorus uptake rate(mmol P/m3/d) used if simIPDynamics = 2 SILICA parameter NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA simSiUptake 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.00e+00 0.0000 0.00e+00 0.00e+00 0.00e+00 0.00e+00 integer Simulate Si uptake (0 = false 1 = true) Si_0 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 0.3000 3.00e-01 0.3000 3.00e-01 3.00e-01 3.00e-01 3.00e-01 real Silica concentraion below which uptake is 0 (mmol Si/m3) K_Si 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.5000 2.50e+00 2.5000 2.50e+00 2.50e+00 2.50e+00 2.50e+00 real Half-saturation concentration of silica (mmol Si /m3) X_sicon 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 0.4000 4.00e-01 0.4000 4.00e-01 4.00e-01 4.00e-01 4.00e-01 real Constant interal silica concentration (mmol Si/mmol C) 13.3.4 Optional Module Links 13.3.5 Feedbacks to the Host Model 13.4 Setup &amp; Configuration 13.4.1 Setup Example Table 13.4: Parameters and configuration Parameter Name Description Units Parameter Type Default Typical Range Comment num_phytos Number of phytoplankton groups NA Integer NA 0-7 NA the_phytos List of ID’s of groups in aed_phyto_pars.nml (len=num_phyto) NA Integer NA 1/7/17 NA X_excretion_target_variable State variable to receive C, N or P from excretion NA String NA NA NA X_mortality_target_variable State variable to receive C, N or P from mortality NA String NA NA NA X_uptake_target_variable State variable to be linked C, N, P, Si or O2 uptake NA String NA NA NA settling Settling calculation method NA Integer NA 1/3/17 NA do_mpb Switch to enable microphytobenthos calculations NA float NA NA NA R_mpbg Maximum rate of MPB growth \\(mmol C\\,m^{-3}\\,day^{-1}\\) Float 5.00E-01 NA NA R_mpbr Maximum rate of MPB respiration \\(mmol C\\,m^{-3}\\,day^{-1}\\) Float 5.00E-02 NA NA I_Kmpb Half saturation constant for light limitation of MPB growth \\(microE\\,m^{-2}\\,s^{-1}\\) Float 100 NA NA mpb_max Maximum MPB biomass NA Float 2000 NA NA resuspension Resuspension rate of phytoplankton group x NA Float NA NA NA resus_link Resuspension link variable NA String NA NA NA n_zones Total number of active material zones NA Integer NA NA NA active_zones AActive material Zone ID’s NA Array NA NA NA dbase Link to phy database NA String NA NA NA extra_diag Include extra diags in nc output NA Boolean .false. NA NA min_rho Minimum phytoplankton density \\(kg\\,m^{-3}\\) Float 900 NA NA max_rho Maximum phytoplankton density \\(kg\\,m^{-3}\\) Float 1200 NA NA An example nml block for the phytoplankton module is shown below: Users must supply a valid “aed_phyto_pars.nml” file. &amp;aed2_phytoplankton !-- Configure phytoplankton groups to simulate num_phytos = 1 the_phytos = 1 settling = 1 !-- Benthic phytoplankton group (microphytobenthos) do_mpb = 1 R_mpbg = 0.5 R_mpbr = 0.05 I_Kmpb = 100. mpb_max = 2000. resuspension = 0.45 resus_link = &#39;TRC_resus&#39; n_zones = 4 active_zones = 2,3,4,5 !-- Set link variables to other modules p_excretion_target_variable=&#39;OGM_dop&#39; n_excretion_target_variable=&#39;OGM_don&#39; c_excretion_target_variable=&#39;OGM_doc&#39; si_excretion_target_variable=&#39;&#39; p_mortality_target_variable=&#39;OGM_pop&#39; n_mortality_target_variable=&#39;OGM_pon&#39; c_mortality_target_variable=&#39;OGM_poc&#39; si_mortality_target_variable=&#39;&#39; p1_uptake_target_variable=&#39;PHS_frp&#39; n1_uptake_target_variable=&#39;NIT_nit&#39; n2_uptake_target_variable=&#39;NIT_amm&#39; si_uptake_target_variable=&#39;SIL_rsi&#39; do_uptake_target_variable=&#39;OXY_oxy&#39; c_uptake_target_variable=&#39;&#39; !-- General options dbase = &#39;../External/AED2/aed2_phyto_pars.nml&#39; extra_diag = .false. !zerolimitfudgefactor = ?? min_rho = 900. max_rho = 1200. / 13.5 Case Studies &amp; Examples 13.5.1 Case Study Figure 13.1: Light limitation of pytoplankton via various model approaches. 13.5.2 Publications "],["zooplankton.html", "14 Zooplankton 14.1 Contributors 14.2 Overview 14.3 Model Description 14.4 Setup &amp; Configuration 14.5 Case Studies &amp; Examples", " 14 Zooplankton 14.1 Contributors 14.2 Overview 14.3 Model Description 14.3.1 Process Descriptions 14.3.2 Variable Summary 14.3.3 Parameter Summary 14.3.4 Optional Module Links 14.3.5 Feedbacks to the Host Model 14.4 Setup &amp; Configuration 14.5 Case Studies &amp; Examples 14.5.1 Case Study 14.5.2 Publications "],["totals.html", "15 Totals 15.1 Contributors 15.2 Overview 15.3 Model Description 15.4 Setup &amp; Configuration 15.5 Case Studies &amp; Examples", " 15 Totals 15.1 Contributors 15.2 Overview 15.3 Model Description 15.3.1 Process Descriptions 15.3.2 Variable Summary 15.3.3 Parameter Summary 15.3.4 Optional Module Links 15.3.5 Feedbacks to the Host Model 15.4 Setup &amp; Configuration 15.5 Case Studies &amp; Examples 15.5.1 Case Study 15.5.2 Publications "],["aqueous-geochemistry.html", "16 Aqueous Geochemistry 16.1 Contributors 16.2 Overview 16.3 Model Description 16.4 Setup &amp; Configuration 16.5 Case Studies &amp; Examples", " 16 Aqueous Geochemistry 16.1 Contributors 16.2 Overview The module allows the user to choose from a wide array of geochemical ‘components’ (e.g., anions, cations, metals) to simulate, and then solves for the equilibrium speciation of the solution. The module includes an advanced solver, and provides pH and other solution properties, and optional mineral or gas phases. Relevant kinetic transformations (e.g. redox reactions) between simulated components are also included. Metals may be simulated as part of the model and can also be active within the biological cycles. The module is flexible and simple in its configuration and can be used in the water column and in the sediment if the dynamic sediment diagenesis model (see Section ?) is also being simulated. The module dynamically links with the other biogeochemical processes within AED2, such that any biological activity (e.g. algal nutrient uptake and photosynthesis, microbial respiration, and nitrification) will dynamically affect the aqueous speciation and pH. Details of the equilibrium and non-equilibrium processes included are described in the adjacent tab. Figure 16.1: Conceptual diagram highlighting key variables and interactions within the model 16.3 Model Description 16.3.1 Process Descriptions 16.3.1.1 General Approach The aqueous geochemistry sub-model was developed to simulate aqueous speciation and solubility equilibrium control of pure-phase minerals using an approach similar to PHREEQC and as reported previously in Salmon et al (in review). Each dissolved component, \\(X\\), and mineral phase, \\(PP\\), is a state variable within the model and is mass-conserved. In addition to external loading from inflows, the model includes a configurable dissolved sediment flux term for the dissolved species and a sedimentation term for the particulates. If we remove the hydrodynamic terms (e.g., inflows/outflows, mixing) for brevity, the differential equation is defined for the dissolved state variables as: Aqueous Speciation &amp; Solubility Equilibrium Control The aqueous geochemistry model is conceptually similar to other equilbrium codes (e.g. … ). The model defines geochemical reactions in terms of components. An aqueous species \\(C\\) is created as a product of reaction between components \\(A\\) and \\(B\\), as shown in the following example: \\[\\begin{equation} aA + bB \\Longleftrightarrow cC \\tag{16.1} \\end{equation}\\] where \\(a\\), \\(b\\) and \\(c\\) are the stoichiometric coefficients. The reaction shown above is able to proceed back and forward depending on the prevailing conditions of the aqueous solution. The equilibrium of the reaction is a function of the standard free energy, and from this the familiar mass-action expression is defined: \\[\\begin{equation} K_C=\\frac{[C]^c}{[A]^a[B]^b} \\tag{16.2} \\end{equation}\\] where \\(K_{C}\\) is denoted the equilibrium constant. In any natural aquatic system, numerous components are present and there are therefore hundreds of reactions similar to Eq. above that will be close to equilibrium. The many reactions form a complex and interdependent set of simultaneous expressions which can be solved numerically, discussed next. For each component, \\(X_{x}\\), (generally components are equivalent to elements, except for the case of elements with multiple redox states, in which case each redox state is assigned as a unique component), a set of \\(M\\) components is defined, \\(X \\in \\{X_1, X_2, ..., X_M\\}\\). Combination of all the components into an aqueous solution results in numerous reactions taking place of the form of Eq. .., and we define the resultant set of aqueous species that result as: \\(C \\in \\{C_1, C_2 ..., C_N\\}\\), where \\(N\\) is the total number produced. The `activity’ of an aqueous species is not equivalent to its molality due to the nonideality of aqueous solutions; a species activity, is related to its molality according to the activity coefficient, : \\[\\begin{equation} [C_i] = \\tilde{C_i} = \\gamma_i C_i \\tag{16.3} \\end{equation}\\] Numerous methods exist for estimating a species activity coefficient. The first is known as the Davies equation: \\[\\begin{equation} \\log \\gamma_i = -c_1z_i^2\\left(\\frac{\\sqrt{\\mu}}{1+\\sqrt{\\mu}}-0.3\\mu \\right) \\tag{16.4} \\end{equation}\\] and the other one used in the AED2 solution is the Debye-Huckel equation: \\[\\begin{equation} \\log \\gamma_i = -\\frac{c_1z_i^2\\sqrt{\\mu}}{1+c_2c_3\\sqrt{\\mu}} +c_4\\mu \\tag{16.5} \\end{equation}\\] where \\(z_{i}\\) is the ionic charge of the \\(i^{\\text{th}}\\) species \\(c_{1-4}\\) are constants that depend upon properties such as the temperature of the solution. The activity of a species is dependent on the ionic strength, \\(\\mu\\), a solution property defined as: \\[\\begin{equation} \\mu = \\frac{1}{2}\\sum_i^N{z_i^2\\frac{C_i}{W_{aq}}} \\tag{16.6} \\end{equation}\\] where \\(W_{aq}\\) is mass of water in the aqueous phase. To numerically solve the system of equations, the total number of moles of any component is estimated by adding up the amount contained in each species: \\[\\begin{equation} T_j = \\sum_{i=1}^N{a_{ij}C_i} \\:\\:\\:\\:\\:\\:\\:\\:\\:\\:\\: j=1..M \\tag{16.7} \\end{equation}\\] where \\())aix\\) is the stoichiometric coefficient of component \\(x\\) in species \\(i\\). The activity of each species is calculated using the mass-action equations, which are defined more generically as: \\[\\begin{equation} \\tilde{C}_i = K_i \\prod_{j=1}^M{\\tilde{X}_j^{a_{ij}}} \\:\\:\\:\\:\\:\\:\\: j=1..N \\tag{16.8} \\end{equation}\\] Taking the logarithm of both sides of Equation above leaves: \\[\\begin{equation} log \\tilde{C}_i = \\log K_i + \\sum_{j=1}^M{a_{ij}\\log \\tilde{X}_j} \\:\\:\\:\\:\\: j=1..N \\tag{16.9} \\end{equation}\\] which can be defined in matrix notation as: \\[\\begin{equation} \\tilde{C}^* = K^*+A\\tilde{X}^* \\tag{16.10} \\end{equation}\\] where \\(*\\) denotes a vector quantity. The solution is achieved by iterating using a Newton-Rhapson scheme, which aims to minimize the residual, \\(R\\), between the estimated component molalities (\\(T\\)) and the known values: \\[\\begin{equation} R_x = \\sum_{i=1}^{N}{a_{ix}C_i-T_x}\\:\\:\\:\\:\\: i=1..N \\tag{16.11} \\end{equation}\\] In matrix notation: \\[\\begin{equation} R=A^{-1}C-T \\tag{16.12} \\end{equation}\\] The Newton-Rhapson technique iterates towards a solution by employing a derivative (termed Jacobian) matrix, \\(J\\): \\[\\begin{equation} R=J \\Delta X \\tag{16.13} \\end{equation}\\] which is solved for \\(\\Delta X\\) at each iteration. The new estimates for \\(X\\) are then updated according to: \\[\\begin{equation} X^{n+1} = X^n + \\Delta X \\tag{16.14} \\end{equation}\\] and the whole scheme proceeds until the solution has sufficiently converged, \\(R&lt;\\epsilon\\), where \\(\\epsilon\\) is a pre-defined convergence criterion (\\(10^{-10}\\) in this code). The Jacobian matrix is defined as: \\[\\begin{equation} J = \\frac{dR_x}{dX_k} \\tag{16.15} \\end{equation}\\] which can be expanded to: \\[\\begin{equation} \\frac{dR_x}{dX_k} = \\sum_{i=1}^{N}{a_{ik}}\\frac{dC_i}{dX_k}-\\frac{dT_x}{dX_k} \\tag{16.16} \\end{equation}\\] using Eq. …. The derivatives are then defined according to: \\[\\begin{equation} \\frac{dC_i}{dX_k} = a_{ik}\\frac{C_i}{X_k} \\tag{16.17} \\end{equation}\\] and \\[\\begin{equation} \\frac{dT_x}{dX_k} = 0 \\tag{16.18} \\end{equation}\\] which are the substituted into Eq. .. to leave \\[\\begin{equation} \\frac{dR_x}{dX_k} = \\sum_{i=1}^{N}{a_{ik}\\:a_{ik}}\\frac{C_i}{X_k}. \\tag{16.19} \\end{equation}\\] Therefore for a given total number of moles of each element in each computational cell, using this scheme the model solves for the activity of each aqueous species, ionic strength and \\(pH\\). The charge balance variable (denoted \\(ubalchg\\)) is also subject to advection and mixing as all other state variables, and importantly, an estimate of \\(ubalchg\\) must be provided at any inflow boundaries. If this is not done, then the charge balance will be compromised, and will manifest in a poor \\(pH\\) prediction. The Newton-Rhapson scheme described above is implemented by making use of the Simplex numerical solver (Barrodale and Roberts, 1980; Parkhurst and Appelo, 1999). This is because AED2 also allows for simulation of pure phase (i.e. non-aqueous phase) minerals. When minerals can precipitate and dissolve, properties such as the ionic strength (\\(MU\\)), activity of water (\\(XH_{2}O\\)) and charge balance (\\(CV\\)) may be non-conservative in the aqueous solution. These are therefore included as unknowns in the simplex solver, which uses the Newton-Rhapson technique to solve the following matrix: \\[\\begin{equation} \\begin{array}{lll} \\begin{pmatrix} R_{PP}\\\\ R_{X_{1}}\\\\ \\vdots\\\\ R_{X_{N}}\\\\ R_{MU}\\\\ R_{H_2O}\\\\ R_{CB}\\\\ R_{W_{aq}}\\\\ X_{PP}\\\\ \\end{pmatrix} =&amp; \\begin{pmatrix} \\pd{R_{PP}}{\\text{ln}(\\tilde{X}_1)} &amp; \\dots &amp; \\pd{R_{PP}}{\\text{ln}(\\tilde{X}_N)} &amp; \\pd{R_{PP}}{d\\mu} &amp; &amp; \\\\ \\pd{R_{X_1}}{\\text{ln}(\\tilde{X}_1)} &amp; &amp; &amp; &amp; &amp; \\\\ &amp; &amp; &amp; &amp; &amp; \\\\ \\vdots &amp; &amp; &amp; &amp; &amp; \\\\ &amp; &amp; &amp; &amp; &amp; \\\\ &amp; &amp; &amp; &amp; &amp; \\pd{R_{Waq}}{X_{PP}} \\\\ &amp; &amp; &amp; &amp; &amp; 1 \\\\ \\end{pmatrix} &amp; \\begin{pmatrix} d\\text{ln}(\\tilde{X}_1)\\\\ R_{X_{1}}\\\\ \\vdots\\\\ d\\text{ln}(\\tilde{X}_N)\\\\ d\\mu \\\\ d\\text{ln}(\\tilde{X}_{H_2O})\\\\ d\\text{ln}(\\tilde{X}_{H^+})\\\\ d\\text{ln}(W_{aq})\\\\ dX_{PP}\\\\ \\end{pmatrix} \\end{array} \\tag{16.20} \\end{equation}\\] The operation of the simplex solver is complicated and the reader is referred to Barrodale and Roberts (1980) for a detailed account. The aqueous species used in the simulations is based on those from Nordstrom et al. (1990), termed the WATEQ4F database. Redox Transformations Other Geochemistry Sources/sinks (optional) 16.3.2 Variable Summary State Vairables Table 16.1: State variables Variable Name Description Units Variable Type Core/Optional GEO_{var} — \\(mmol m^{-3}\\) pelagic configurable 16.3.3 Parameter Summary Table 16.2: Parameters and configuration Parameter Name Description Units Parameter Type Default Typical Range Comment geochem_file Link to geochem database — string — — — num_components number f dissolved components to be concidered — integer — — — dis_components list of component names — string — — — component_link Active variables to be used as a componenet — string — — — Fsed_gch sediment flux rate of dissolved components \\(mmol\\,m^{-2}\\,day^{-1}\\) array — — — num_minerals number of particulate mineral phases to be included — integer — — — the_minerals list of mineral names — string — — — mineral_link name of any active variables to be used as a mineral — string — — — w_gch sedimentation rate of chosen particulate phases \\(m\\,day^{-1}\\) array — — — Riron_red — — float — — — Kiron_red — — float — — — theta_iron_red — — float — — — Riron_aox — — float — — — Riron_box — — float — — — theta_iron_ox — — float — — — simEq — — boolean — — — dis_initial — — array — — — speciesOutput — — string — — — min_initial — — array — — — 16.3.4 Optional Module Links 16.3.5 Feedbacks to the Host Model 16.4 Setup &amp; Configuration 16.4.1 Setup Example An example nml block for the geochemistry module is shown below: &amp;aed2_geochemistry geochem_file = &#39;../External/AED2/aed2_geochem_pars.dat&#39; !-- dissolved components num_components = 10 dis_components = &#39;DIC&#39;, &#39;FeII&#39;, &#39;FeIII&#39; ,&#39;Al&#39;, &#39;Cl&#39;, &#39;SO4&#39;, &#39;Na&#39;, &#39;K&#39;, &#39;Mg&#39;, &#39;Ca&#39;,&#39;H2S&#39; component_link = &#39;CAR_dic&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39; Fsed_gch = 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0. !-- mineral components num_minerals = 3 the_minerals = &#39;Gibbsite&#39;,&#39;FeOH3A&#39;,&#39;Calcite&#39; mineral_link = &#39;&#39;, &#39;&#39;, &#39;&#39; w_gch = 0.0, -1.0, 0.0 !-- iron redox Riron_red = 0.0 Kiron_red = 100. theta_iron_red = 1.07 Riron_aox = 0.0 !1 = 100% per day decay Riron_box = 0.5 theta_iron_ox = 1.06 !-- advanced simEq = .true. ! dis_initial = 0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1 ! speciesOutput = &#39;CO2&#39; ! min_initial = 0.01,0.01,0.01,0.01 / 16.5 Case Studies &amp; Examples 16.5.1 Case Study 16.5.2 Publications "],["pathogens-microbial-indicator-organisms.html", "17 Pathogens &amp; Microbial Indicator Organisms 17.1 Contributors 17.2 Overview 17.3 Model Description 17.4 Setup &amp; Configuration 17.5 Case Studies &amp; Examples", " 17 Pathogens &amp; Microbial Indicator Organisms 17.1 Contributors 17.2 Overview Understanding the fate and transport of pathogenic and indicator microbes within drinking water reservoirs is critical for managers to effectively reduce risk. Over the past decade several advances have been made for the simulating organism dynamics using coupled hydrodynamic-organism fate models. These have generally been used for simulating coliform bacteria (Hipsey, Antenucci, and Brookes 2008), with applications also reported for Cryptosporidium (Hipsey et al. 2004) and viruses (Sokolova et al. 2012) . In general, these models simulate organism concentrations within water bodies by accounting for external loading, advection and mixing process that occur within the lake interior, organism inactivation and sedimentation. The purpose of this document is to firstly synthesize relevant information from empirical and prior modelling studies to justify the necessary model required for reservoir systems, and secondly to summarise the implementation of the pathogen module within the AED2 model framework. 17.3 Model Description General Approach The general balance equation for organism transport and fate is summarized in Hipsey, Antenucci, and Brookes (2008) as: \\[\\begin{equation} \\frac{DC}{Dt} = +C_{r}(\\tau,SS_{SED},C_{SED})+[k_{g}(T,S,DOC_{L})-k_{d}(T,S,pH)-k_{l} (I_{0},S,DO,pH)-k_{s}(T,S,SS)-k_{p}(T)]C \\tag{17.1} \\end{equation}\\] where \\(C\\) is the organic concentration (orgs m-3). This relates organism concentration to the environmental conditions experienced that influence organism fate (including temperature, salinity, light intensity, dissolved organic carbon, oxygen and pH). This comprehensive description is usually simplified for specific applications, based on justification of the dominant processes present in any particular lake and available data for model setup and validation. Within the AED model framework, the transport terms are solved via hydrodynamic model transport routines and the remaining terms are simulated by the aed_pathogens module. The terms for simulation of organism resuspension and inactivation are described in next. 17.3.1 Process Descriptions Natural Mortality Natural mortality, or the ‘dark-death rate,’ \\(k_d\\), is an important process determining the net rate of die off of protozoan, viral and bacterial organisms and has been reported to vary for specific organisms due to changes in temperature, salinity and pH. The reported die off rates in the literature however are widely variable, with a synthesis of numerous studies from a range of water bodies presented in Hipsey, Antenucci, and Brookes (2008). For freshwater reservoirs, changes in salinity and pH are unlikely to be a significant driver of organism viability relative to the range presented Hipsey, Antenucci, and Brookes (2008) and therefore a simple constant die-off rate that depends on temperature is appropriate: \\[\\begin{equation} k_{d}(T) = k_{d_{20}}\\vartheta _{M}^{T-20} \\tag{17.2} \\end{equation}\\] where \\(k_{d_{20}}\\) is the rate of mortality in the dark at 20C and in freshwater. Since the AED2 implementation of the model to be applied with NPD does not include protozoan grazing as a separate term (as in Eq 1), the grazing effect needs to be embodied within the \\(k_{d_{20}}\\) term. This effectively assumes a constant grazing pressure over time, and if chosen to be a low value this will essentially ensure conservative estimate of the die-off due to grazing. Empirical data from Wivenhoe dam shows the presence of native micro-organisms can increase the background die-off rate by 1.1-3.0x (eg Table 5 in Sidhu and Toze (2012)). Sunlight Inactivation Depending on the clarity of the water, the light climate of the lake can be a dominant factor influencing organism viability and this has been observed empirically in Wivenhoe Dam by Sidhu and Toze (2012). Different organism types experience different sensitivity to different light bandwidths, with most organisms sensitive to UV-B and UV-A and some sensitive to light in the visible spectrum (Sinton, Hall, and Braithwaite 2007). Hipsey, Antenucci, and Brookes (2008) formulated a multiple band-width model for organisms that included direct and indirect mechanisms for sunlight mediated inactivation by accounting for the effect of salinity, oxygen and pH on free radical formation. Here we use a simplified form that accounts only for direct sunlight denaturation as the indirect mechanism is more specific to MS2 phage relative to rotavirus for example (Verbyla and Mihelcic 2015). The implemented expression is therefore: \\[\\begin{equation} k_{l} = \\sum_{b=1}^{N_{b}}[\\varphi k_{b} I_{b}] \\tag{17.3} \\end{equation}\\] where \\(N_B\\) is the number of discrete solar bandwidths to be modeled, \\(b\\) is the bandwidth class {1, 2, … , \\(N_B\\)}, \\(k_b\\) is the freshwater inactivation rate coefficient for exposure to the \\(b^{th}\\) class (m2 MJ-1), \\(I_b\\) is the intensity of the \\(b^{th}\\) bandwidth class (Wm-2), \\(\\varphi\\) is a constant to convert units from seconds to days and J to MJ (= 8.64*10-2). In AED2, the light intensity is computed for 3 distinct bandwidths, including UV-B, UV-A and PAR, and the attenuation of each through the reservoir water column is based on bandwidth specific light extinction coefficients, that account for the effect of turbidity and chromophoric dissolved organic matter (CDOM) on attenutation. Sedimentation Sedimentation of organisms occurs at a rate depending on the degree to which the population is attached to suspended particles. Within AED2, this is captured by simulating free and attached organisms and multiple groups of particles may be accounted for. If we assume a single dominant particle size and ignore the effect of salinity on the settling velocity, then the expression in Hipsey, Antenucci, and Brookes (2008) for the effective sedimentation velocity reduces to: \\[\\begin{equation} k_{s}=(1-f_{a})\\frac{V_{c}}{\\Delta z}+f_{a}\\frac{V_{s}}{\\Delta z} \\tag{17.4} \\end{equation}\\] where \\(f_a\\) is the attached fraction, and \\(V\\) is the vertical velocity of organisms or sediment particles. Resupension Resuspension of organisms accumulated within the sediment has been show to be a relatively important terms in environments where high currents or waves exist. In reservoirs this can occur in the lake margins or deeper in the lake where internal waves or river underflows increase the shear stress at the sediment. The amount of organisms that resuspend depends not only on the shear stress but also n the concentration of organisms in the surficial layers of the sediment. This may be modelled by accounting for the deposited organisms, decay within the sediment and resuspension rate, however, this is notoriously difficult given potentially complex dynamics of organisms in the sediment. Instead we assume that a standard background concentration exists within different sediment regions (based on depth and local geomorphology) and simulate resuspension rate as: \\[\\begin{equation} C_{r}(\\tau)=\\alpha_{c}\\frac{(\\tau - \\tau_{c_{s}})}{\\tau _{ref}}\\frac{1}{\\Delta z_{bot}} \\tag{17.5} \\end{equation}\\] where, \\(\\alpha_C\\) is the rate of organism suspension (orgs m-2s-1), which occurs when the critical shear stress is exceeded in the relative computational cell. 17.3.2 Variable Summary State Variables Table 17.1: State variables Variable Name Description Units Variable Type Core/Optional PTH_name Concentration of pathogens cfu/100mL Pelagic Optional Diagnostics 17.3.3 Parameter Summary Table 17.2: Diagnostics p_name ‘crypto’ ‘ecoli’ ‘totalcoli’ string pathogen name coef_grwth_uMAX 0.00e+00 3.00e+00 2.40e+00 real Max growth rate at 20C coef_grwth_Tmin 4.00e+00 4.00e+00 4.00e+00 real Tmin and Tmax f(T) coef_grwth_Tmax 3.50e+01 3.50e+01 3.50e+01 real Tmin and Tmax ? coef_grwth_T1 8.00e-03 8.00e-03 8.00e-03 real coef_grwth_T1 and coef_grwth_T2 coef_grwth_T2 1.00e-01 1.00e-01 1.00e-01 real coef_grwth_T1 and coef_grwth_T2 coef_grwth_Kdoc 0.00e+00 3.00e-01 3.00e-01 real Half-saturation for growth coef_grwth_Kdoc coef_grwth_ic 0.00e+00 0.00e+00 0.00e+00 real coef_grwth_ic coef_mort_kd20 3.00e-02 4.80e-01 3.40e-01 real Mortality rate (Dark death rate) @ 20C and 0 psu coef_mort_theta 1.08e+00 1.08e+00 1.11e+00 real Temperature multiplier for mortality: coef_mort_theta coef_mort_c_SM 0.00e+00 0.00e+00 2.00e-07 real Salinity effect on mortality coef_mort_alpha 0.00e+00 6.10e+00 4.20e+00 real Salinity effect on mortality coef_mort_beta 0.00e+00 2.50e-01 2.50e-01 real Salinity effect on mortality coef_mort_c_PHM 0.00e+00 5.00e+01 5.00e+01 real pH effect on mortality coef_mort_K_PHM 0.00e+00 6.00e+00 6.00e+00 real pH effect on mortality coef_mort_delta_M 0.00e+00 4.00e+00 4.00e+00 real pH effect on mortality coef_mort_fdoc 0.00e+00 5.00e-01 5.00e-01 real Fraction of mortality back to doc coef_light_kb_vis 0.00e+00 9.70e-02 9.70e-02 real Light inactivation coef_light_kb_uva 0.00e+00 1.16e+00 1.16e+00 real Light inactivation coef_light_kb_uvb 0.00e+00 3.64e+01 3.64e+01 real Light inactivation coef_light_cSb_vis 6.70e-03 6.70e-03 6.70e-03 real Salinity effect on light inactivation coef_light_cSb_uva 6.70e-03 6.70e-03 6.70e-03 real Salinity effect on light inactivation coef_light_cSb_uvb 6.70e-03 6.70e-03 6.70e-03 real Salinity effect on light inactivation coef_light_kDOb_vis 5.00e-01 5.00e-01 5.00e-01 real DO effect on light coef_light_kDOb_uva 5.00e-01 5.00e-01 5.00e-01 real DO effect on light coef_light_kDOb_uvb 5.00e-01 5.00e-01 5.00e-01 real DO effect on light coef_light_cpHb_vis 1.00e+01 1.00e+01 1.00e+01 real pH effect on light inactivation coef_light_cpHb_uva 1.00e+01 1.00e+01 1.00e+01 real pH effect on light inactivation coef_light_cpHb_uvb 1.00e+01 1.00e+01 1.00e+01 real pH effect on light inactivation coef_light_KpHb_vis 5.00e+00 5.00e+00 5.00e+00 real pH effect on light inactivation coef_light_KpHb_uva 5.00e+00 5.00e+00 5.00e+00 real pH effect on light inactivation coef_light_KpHb_uvb 5.00e+00 5.00e+00 5.00e+00 real pH effect on light inactivation coef_light_delb_vis 3.00e+00 3.00e+00 3.00e+00 real exponent for pH effect on light inactivation coef_light_delb_uva 3.00e+00 3.00e+00 3.00e+00 real exponent for pH effect on light inactivation coef_light_delb_uvb 3.00e+00 3.00e+00 3.00e+00 real exponent for pH effect on light inactivation coef_pred_kp20 0.00e+00 2.00e-01 2.00e-01 real Loss rate due to predation and temp multiplier coef_pred_theta_P 1.00e+00 1.04e+00 1.04e+00 real Loss rate due to predation and temp multiplier coef_sett_fa 0.00e+00 9.40e-01 8.10e-01 real Attached fraction in water column coef_sett_w_path -2.50e-06 -5.00e-07 -5.00e-07 real Sedimentation velocity (m/d) at 20C (-ve means down) for NON-ATTACHED orgs coef_resus_epsilonP 1.00e-02 1.00e-02 1.00e-02 real Pathogen resuspension rate coef_resus_tauP_0 1.00e-02 1.00e-02 1.00e-02 real Critical shear stress for organism resuspension 17.3.4 Optional Module Links 17.3.5 Feedbacks to the Host Model 17.4 Setup &amp; Configuration 17.4.1 Setup Example Table 17.3: Parameters and configuration Parameter Name Description Units Parameter Type Default Typical Range Comment num_pathogens number of pathogens to model 1-? NA NA NA NA An example nml block for the phytoplankton module is shown below: &amp;aed2_pathogens num_pathogens = 2 the_pathogens = 1,3 dbase = &#39;./the_path_to/aed2_pathogen_pars.nml&#39; ! OPTIONAL VARS HERE resuspension num_ss ss_set ss_tau ss_ke sim_sedorgs oxy_variable epsilon tau_0 tau_0_min Ktau_0 extra_diag att_ts / 2018 : aed2_pathogen_pars.nml parameter formatting style: !------------------------------------------------------------------------------- ! aed2_pathogen_pars.nml : PATHOGEN PARAMETER DATABASE !------------------------------------------------------------------------------- ! p_name : [ string] - pathogen name ! coef_grwth_uMAX : [ real] - Max growth rate at 20C ! coef_grwth_Tmin : [ real] - Tmin and Tmax, f(T) ! coef_grwth_Tmax : [ real] - Tmin and Tmax, f(T) ! coef_grwth_T1 : [ real] - coef_grwth_T1 and coef_grwth_T2 ! coef_grwth_T2 : [ real] - coef_grwth_T1 and coef_grwth_T2 ! coef_grwth_Kdoc : [ real] - Half-saturation for growth, coef_grwth_Kdoc ! coef_grwth_ic : [ real] - coef_grwth_ic ! coef_mort_kd20 : [ real] - Mortality rate (Dark death rate) @ 20C and 0 psu ! coef_mort_theta : [ real] - Temperature multiplier for mortality: coef_mort_theta ! coef_mort_c_SM : [ real] - Salinity effect on mortality ! coef_mort_alpha : [ real] - Salinity effect on mortality ! coef_mort_beta : [ real] - Salinity effect on mortality ! coef_mort_c_PHM : [ real] - pH effect on mortality ! coef_mort_K_PHM : [ real] - pH effect on mortality ! coef_mort_delta_M : [ real] - pH effect on mortality ! coef_mort_fdoc : [ real] - Fraction of mortality back to doc ! coef_light_kb_vis : [ real] - Light inactivation ! coef_light_kb_uva : [ real] - Light inactivation ! coef_light_kb_uvb : [ real] - Light inactivation ! coef_light_cSb_vis : [ real] - Salinity effect on light inactivation ! coef_light_cSb_uva : [ real] - Salinity effect on light inactivation ! coef_light_cSb_uvb : [ real] - Salinity effect on light inactivation ! coef_light_kDOb_vis : [ real] - DO effect on light ! coef_light_kDOb_uva : [ real] - DO effect on light ! coef_light_kDOb_uvb : [ real] - DO effect on light ! coef_light_cpHb_vis : [ real] - pH effect on light inactivation ! coef_light_cpHb_uva : [ real] - pH effect on light inactivation ! coef_light_cpHb_uvb : [ real] - pH effect on light inactivation ! coef_light_KpHb_vis : [ real] - pH effect on light inactivation ! coef_light_KpHb_uva : [ real] - pH effect on light inactivation ! coef_light_KpHb_uvb : [ real] - pH effect on light inactivation ! coef_light_delb_vis : [ real] - exponent for pH effect on light inactivation ! coef_light_delb_uva : [ real] - exponent for pH effect on light inactivation ! coef_light_delb_uvb : [ real] - exponent for pH effect on light inactivation ! coef_pred_kp20 : [ real] - Loss rate due to predation and temp multiplier ! coef_pred_theta_P : [ real] - Loss rate due to predation and temp multiplier ! coef_sett_fa : [ real] - Attached fraction in water column ! coef_sett_w_path : [ real] - Sedimentation velocity (m/d) at 20C (-ve means down) for NON-ATTACHED orgs ! coef_resus_epsilonP : [ real] - Pathogen resuspension rate ! coef_resus_tauP_0 : [ real] - Critical shear stress for organism resuspension &amp;pathogen_data pd%p_name = &#39;crypto&#39;, &#39;ecoli&#39;, &#39;totalcoli&#39; pd%coef_grwth_uMAX = 0, 3, 2.4 pd%coef_grwth_Tmin = 4, 4, 4 pd%coef_grwth_Tmax = 35, 35, 35 pd%coef_grwth_T1 = 0.008, 0.008, 0.008 pd%coef_grwth_T2 = 0.1, 0.1, 0.1 pd%coef_grwth_Kdoc = 0, 0.3, 0.3 pd%coef_grwth_ic = 1.0E-9, 1.0E-9, 1.0E-9 pd%coef_mort_kd20 = 0.03, 0.48, 0.34 pd%coef_mort_theta = 1.08, 1.08, 1.11 pd%coef_mort_c_SM = 0, 2.0E-10, 2.0E-7 pd%coef_mort_alpha = 0, 6.1, 4.2 pd%coef_mort_beta = 0, 0.25, 0.25 pd%coef_mort_c_PHM = 0, 50, 50 pd%coef_mort_K_PHM = 0, 6, 6 pd%coef_mort_delta_M = 0, 4, 4 pd%coef_mort_fdoc = 0, 0.5, 0.5 pd%coef_light_kb_vis = 0, 0.097, 0.097 pd%coef_light_kb_uva = 0, 1.16, 1.16 pd%coef_light_kb_uvb = 0, 36.4, 36.4 pd%coef_light_cSb_vis = 0.0067, 0.0067, 0.0067 pd%coef_light_cSb_uva = 0.0067, 0.0067, 0.0067 pd%coef_light_cSb_uvb = 0.0067, 0.0067, 0.0067 pd%coef_light_kDOb_vis = 0.5, 0.5, 0.5 pd%coef_light_kDOb_uva = 0.5, 0.5, 0.5 pd%coef_light_kDOb_uvb = 0.5, 0.5, 0.5 pd%coef_light_cpHb_vis = 10, 10, 10 pd%coef_light_cpHb_uva = 10, 10, 10 pd%coef_light_cpHb_uvb = 10, 10, 10 pd%coef_light_KpHb_vis = 5, 5, 5 pd%coef_light_KpHb_uva = 5, 5, 5 pd%coef_light_KpHb_uvb = 5, 5, 5 pd%coef_light_delb_vis = 3, 3, 3 pd%coef_light_delb_uva = 3, 3, 3 pd%coef_light_delb_uvb = 3, 3, 3 pd%coef_pred_kp20 = 0, 0.2, 0.2 pd%coef_pred_theta_P = 1, 1.04, 1.04 pd%coef_sett_fa = 0, 0.94, 0.81 pd%coef_sett_w_path = -2.5E-6, -5.0E-7, -5.0E-7 pd%coef_resus_epsilonP = 0.01, 0.01, 0.01 pd%coef_resus_tauP_0 = 0.01, 0.01, 0.01 / Go to the aed2_pathogen_pars.nml Parameter Database 2014: aed2_pathogen_pars.nml style parameters (note: not compatible with the online parameter database) !----------------------------------------------------------------! ! coef_grwth_uMAX !-- Max growth rate at 20C ! coef_grwth_Tmin, coef_grwth_Tmax !-- Tmin and Tmax, f(T) ! coef_grwth_T1, coef_grwth_T2 !-- coef_grwth_T1 and coef_grwth_T2 ! coef_grwth_Kdoc !-- Half-saturation for growth, coef_grwth_Kdoc ! coef_grwth_ic !-- coef_grwth_ic ! coef_mort_kd20 !-- Mortality rate (Dark death rate) @ 20C and 0 psu ! coef_mort_theta !-- Temperature multiplier for mortality: coef_mort_theta ! coef_mort_c_SM, coef_mort_alpha, coef_mort_beta !-- Salinity effect on mortality ! coef_mort_c_PHM, coef_mort_K_PHM, coef_mort_delta_M !-- pH effect on mortality ! coef_mort_fdoc !-- Fraction of mortality back to doc ! coef_light_kb_vis, coef_light_kb_uva, coef_light_kb_uvb !-- Light inactivation ! coef_light_cSb_vis, coef_light_cSb_uva, coef_light_cSb_uvb !-- Salinity effect on light inactivation ! coef_light_kDOb_vis, coef_light_kDOb_uva, coef_light_kDOb_uvb !-- DO effect on light ! coef_light_cpHb_vis, coef_light_cpHb_uva, coef_light_cpHb_uvb !-- pH effect on light inactivation ! coef_light_KpHb_vis, coef_light_KpHb_uva, coef_light_KpHb_uvb !-- pH effect on light inactivation ! coef_light_delb_vis, coef_light_delb_uva, coef_light_delb_uvb !-- exponent for pH effect on light inactivation ! coef_pred_kp20, coef_pred_theta_P !-- Loss rate due to predation and temp multiplier ! coef_sett_fa !-- Attached fraction in water column ! coef_sett_w_path !-- Sedimentation velocity (m/d) at 20C (-ve means down) for NON-ATTACHED orgs !----------------------------------------------------------------! ! p_name coef_grwth_uMAX, coef_grwth_Tmin, coef_grwth_Tmax, coef_grwth_T1, coef_grwth_T2, coef_grwth_Kdoc, coef_grwth_ic, coef_mort_kd20, coef_mort_theta, coef_mort_c_SM, coef_mort_alpha, coef_mort_beta, coef_mort_c_PHM, coef_mort_K_PHM, coef_mort_delta_M, coef_mort_fdoc, coef_light_kb_vis, coef_light_kb_uva, coef_light_kb_uvb, coef_light_cSb_vis, coef_light_cSb_uva, coef_light_cSb_uvb, coef_light_kDOb_vis, coef_light_kDOb_uva, coef_light_kDOb_uvb, coef_light_cpHb_vis, coef_light_cpHb_uva, coef_light_cpHb_uvb, coef_light_KpHb_vis, coef_light_KpHb_uva, coef_light_KpHb_uvb, coef_light_delb_vis, coef_light_delb_uva, coef_light_delb_uvb, coef_pred_kp20, coef_pred_theta_P, coef_sett_fa, coef_sett_w_path &amp;pathogen_data pd = &#39;crypto&#39;, 0.0, 4.0, 35.0, 0.008, 0.1, 0.0, 1e-9, 0.03, 1.14, 0.00, 0.0, 0.00, 0.0, 0.0, 0.0, 0.0, 0.000, 2.13, 33.7, 0.0067, 0.0067, 0.0067, 0.5, 0.5, 0.5, 10.0, 10.0, 10.0, 5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 0.0, 1.00, 0.00, -2.\\5e-6, &#39;ecoli&#39;, 0.0, 4.0, 35.0, 0.008, 0.1, 0.3, 1e-9, 0.48, 1.08, 2e-10, 6.1, 0.25, 50.0, 6.0, 4.0, 0.5, 0.097, 1.16, 36.4, 0.0067, 0.0067, 0.0067, 0.5, 0.5, 0.5, 10.0, 10.0, 10.0, 5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 0.0, 1.04, 0.94, -0.5e-6, &#39;fcoli&#39;, 0.0, 4.0, 35.0, 0.008, 0.1, 0.3, 1e-9, 0.71, 1.06, 2e-3, 1.8, 0.25, 50.0, 6.0, 4.0, 0.5, 0.097, 1.16, 36.4, 0.0067, 0.0067, 0.0067, 0.5, 0.5, 0.5, 10.0, 10.0, 10.0, 5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 0.0, 1.04, 0.81, -0.5e-6, &#39;ent&#39;, 0.0, 4.0, 35.0, 0.008, 0.1, 0.3, 1e-9, 0.45, 1.04, 0.00, 0.0, 0.25, 50.0, 6.0, 4.0, 0.5, 0.882, 1.16, 17.2, 0.0067, 0.0067, 0.0067, 0.5, 0.5, 0.5, 10.0, 10.0, 10.0, 5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 0.0, 1.04, 0.81, -0.5e-6, &#39;totalcoli&#39;, 0.0, 4.0, 35.0, 0.008, 0.1, 0.3, 1e-9, 0.34, 1.11, 2e-7, 4.2, 0.25, 50.0, 6.0, 4.0, 0.5, 0.097, 1.16, 36.4, 0.0067, 0.0067, 0.0067, 0.5, 0.5, 0.5, 10.0, 10.0, 10.0, 5.0, 5.0, 5.0, 3.0, 3.0, 3.0, 0.0, 1.04, 0.81, -0.5e-6, / 17.5 Case Studies &amp; Examples 17.5.1 Case Study 17.5.2 Publications References "],["stable-isotopes.html", "18 Stable Isotopes 18.1 Contributors 18.2 Overview 18.3 Model Description 18.4 Setup &amp; Configuration 18.5 Case Studies &amp; Examples", " 18 Stable Isotopes 18.1 Contributors 18.2 Overview 18.3 Model Description 18.3.1 Process Descriptions 18.3.2 Variable Summary 18.3.3 Parameter Summary 18.3.4 Optional Module Links 18.3.5 Feedbacks to the Host Model 18.4 Setup &amp; Configuration 18.5 Case Studies &amp; Examples 18.5.1 Case Study 18.5.2 Publications "],["bioactive-particles.html", "19 Bioactive Particles 19.1 Contributors 19.2 Overview 19.3 Model Description 19.4 Setup &amp; Configuration 19.5 Case Studies &amp; Examples", " 19 Bioactive Particles 19.1 Contributors 19.2 Overview 19.3 Model Description 19.3.1 Process Descriptions 19.3.2 Variable Summary 19.3.3 Parameter Summary 19.3.4 Optional Module Links 19.3.5 Feedbacks to the Host Model 19.4 Setup &amp; Configuration 19.5 Case Studies &amp; Examples 19.5.1 Case Study 19.5.2 Publications "],["sediment-biogeochemistry.html", "20 Sediment Biogeochemistry 20.1 Contributors 20.2 Overview 20.3 Model Description 20.4 Setup &amp; Configuration 20.5 Case Studies &amp; Examples", " 20 Sediment Biogeochemistry 20.1 Contributors Daniel Paraska, Matthew R Hipsey 20.2 Overview Sediment diagenesis models are highly complex environmental reactive transport modelling tools. The meta-analysis by Paraska et al (2014) discussed the history of their evolution to these complex configurations, in which the original models of Boudreau (1996), Van Cappellen and Wang (1996) and Soetaert et al. (1996) were taken up and applied in many contexts by new modellers, who added new features and extended their capabilities, or discarded old features as required. The meta-analysis also identified the major challenges associated with developing new sediment diagenesis models. Here, a new modelling package for sediment biogeochemistry is presented, CANDI-AED, which is an extension of the Approach 1 models, but reengineered and augmented with new model approaches and capabilities as a way to address some of these challenges. Paraska et al (in prep) outlined the significance and uncertainty associated with different parameterisation approaches of organic matter dynamics. In these cases, simulations were run to test the significance of different theoretical approaches and model structural assumptions, using an idealised model setup with only primary oxidation reactions and no physical processes or spatial resolution. The true impact of these different model approaches within a spatially-resolved model, accounting for all of the advection, diffusion and secondary reaction processes, however, is yet to be determined and it is unclear whether some formulations may suit some application contexts better than others. Therefore there is a need for a fully flexible model structure that can include these different organic matter breakdown parameterisations and allow users to assess critically the alternative approaches. In addition, other aspects related to secondary redox reactions, mineral reactions, precipitation and adsorption should similarly be subject to comparative assessments. A further challenge identified in Paraska et al (2014) was the difficulty involved in taking up these models by the broader modelling community, because of problems related to connecting these complex model structures with other water quality and aquatic ecosystem models. For example, there are problems related to mapping variables of ecosystem models to those of diagenesis models. There are also problems related to the mismatch between the resolution of processes that occur over different spatial and temporal scales, for example fast equilibrium reactions between sediment layers, and seasonal temperature or salinity changes across a study site. The model developed as part of this research aimed to address these challenges by building a full-featured, open-source model code with the flexibility to do the following: - set different kinetic rate equation approaches - set different organic matter pools and breakdown processes - use standard inhibition or thermodynamic limits on primary oxidation - optionally use manganese, iron and iron sulphide reactions - simulate adsorbed metals and nutrients - simulate calcium, iron and manganese carbonates - connect the boundary to either another model, a programmed file or a fixed concentration Therefore the numerical model presented in this chapter has many optional features and alternative parameterisations for key processes, without mandating their inclusion in the calculations or enforcing a fixed model structure. To facilitate the coupling, the model is implemented with the “Framework for Aquatic Biogeochemical Models” (FABM), which is a new object-oriented model software framework by Bruggeman and Bolding (2014). Through the definition of a generic architecture for configuring and coupling both benthic and pelagic models, the FABM has been designed to couple a wide range of ecological and biogeochemical models from various developers with numerous different hydrodynamic models (Trolle et al. 2011). To date the FABM has been applied with the 1D lake hydrodynamic model GLM (Hipsey et al. 2014), and the unstructured mesh model TUFLOW-FV (Bruce et al. 2014). The sediment model CANDI-AED presented here is implemented within the AED model library within the FABM (Hipsey et al. 2013b), however, it is able to couple with one or more of the FABM model libraries (Figure 20.1). Through the model coupling approach it may be applied with any of the hydrodynamic models listed above, or alternatively, run in isolation. This document provides a complete scientific description of the model and describes attributes of the model associated with its practical implementation and operation. An application of the model framework is subsequently demonstrated. Figure 20.1: Schematic of the framework of aquatic biogeochemical models. The new diagenesis model code AED CANDI fits into the category of multilayer 1D diagenesis models, coupled to other biogeochemical and physical models (Trolle et al. 2011) 20.3 Model Description The heart of this model is the reaction, diffusion, advection model of Berner (1980), which was implemented as the Carbon and Nutrient Diagenesis model of Boudreau (1996) and developed into Approach 1 from Chapter 2. The basic structure of this model is an adaptation of the C.CANDI code (Luff et al. 2000), which added extensions related to the geochemical aspects. Further additions to the C.CANDI code have been made to: - the organic matter dynamics - the geochemical dynamics - extensions for nutrients and trace metals The chemical reactions included in this model, including new features added to the model, are expanded upon below and summarised in Figure 20.2. Figure 20.2: AED CANDI includes chemical processes of organic matter transformation and oxidation, and reduction/oxidation, crystallisation, adsorption and precipitation reactions of inorganic by-products. Most of the processes are triggered by the input of POM at the sediment-water interface. 20.3.1 Process Descriptions Primary Redox Reactions The key chemical process that causes ongoing change in the sediment is the breakdown of organic matter. The user can decide how complex or simple the organic matter breakdown pathway should be, with three options of varying complexity for parameterising the pathways included (Figure 5 - 3). The first option (OMModel = 1) is a common multi-G model in which the POM phases are decomposed straight to CO2 and other breakdown products. Here POM is a variable that is not precisely defined, and its components (such as C, N and P) must be determined in post-processing based on a user-defined fixed stoichiometry. The second option (OMModel = 2) is another 2G model with both particulate and dissolved organic matter (POM and DOM) phases included and parameterisation hydrolysis of POM to DOM, and then DOM to CO2 and other breakdown products. The POM and DOM phases consist of three variables each, which trace the reaction and transport of carbon, nitrogen and phosphorus, thereby allowing for variable stoichiometry of organic matter to occur temporally and spatially. The third option (OMModel = 3) has many POM phases, which are all hydrolysed to DOM, which then undergoes fermentation and terminal metabolism, as using the mechanistic approach from Chapter 3. This allows the carbon, nitrogen and phosphorus to be calculated precisely before and after a model run, and allows the free energies of the reaction of each phase to be included. This third option is the most detailed and mechanistic, and allows for expansion of more detailed reaction mechanisms to be included. Table 20.1: Parameters and configuration Description Reaction Rate equation OMModel 1 \\(POM_{Lab} \\text{ oxidation}\\) \\(POM_{\\text{Lab}} \\rightarrow CO_{2 \\text{ space}}\\) \\[\\begin{equation} k_{DOMRef}{\\sum R}_{{Ox}_i} \\tag{20.1} \\end{equation}\\] POMRefoxidation OMModel 2 POMLab hydrolysis POMRef hydrolysis DOMLab oxidation DOMRef oxidation OMModel 3 POMi hydrolysis DHyd fermentation DHyd oxidation OAc, H2 oxidation Figure 20.3: Three options for different levels of complexity in organic matter breakdown, by setting the OMModel switch. a – Model in which POM breaks down directly to CO2 and other waste products. b – Model in which POM is first hydrolysed to DOM and then oxidised to CO2. c – Model in which POM is hydrolysed to DOM, which can then be fermented and oxidised. The terminal redox reaction pathways are the six pathways that are available in most diagenesis models, and are driven by different organic matter pools, depending on the OMModel configuration chosen from the above options (Table 5 - 2). AED CANDI allows the use of Approach 1 or 2 organic matter oxidation rate equations, as examined in detail in Paraska et al (in prep). The rate equation for the oxidation of the oxidants with any of the pools above can include any of the terms in equation 5 - 12, where \\(R_{{Ox}_i}\\) is the reaction of an oxidant \\(i\\) (Arndt et al. 2013) (Table 5 - 3). The kinetic rate constant \\(k_{OM}\\) gives the maximum oxidation rate, which is different for each reactive type, but the same for each oxidation pathway. Alternatively, using OMModel 3, the kinetic rate constant is the rate of bacterial growth. The factor for terminal electron acceptor (TEA) limitation is FTEA (5 - 11), where options for Approach 1 or Approach 2 equations are available. The Monod constant for rate limitation at low oxidant concentration is \\(K_{TEA}\\) in Approach 1 and LTEA in Approach 2. Similarly, the inhibition term \\(F_{In}\\) (5 - 14) can be set to Approach 1 or 2 equations, or turned off entirely. The constant for inhibition until low oxidant concentrations is \\(K_{In}\\) for Approach 1 and \\(L_{IN}\\) for Approach 2. \\(F_{T}\\) is the thermodynamic factor, as described in chapter 3. The current version of the model includes FT only for OMModel 3, for terminal oxidation reactions and fermentation. \\(F_{OM}\\) is the organic matter concentration and may be a Monod function as in equation 5 - 8 (\\(K_{OM}\\) is a half saturation constant and the index \\(i\\) is the reactive phase). Using OMModels 1 and 2, \\(F_{OM}\\) is the concentration of the substrate, rather than a Monod function. The current version of the model has switches built in for both the temperature dependence factor, \\(F_{Tem}\\), where values of 1 or 2 turn them off and on. However, implementation and testing of the factors has not been carried out for this version of the model. The metabolism rate at \\(T_{0}\\) is \\(R_{0}\\), \\(ξ\\) is a scaling constant (see, for example, Eldridge and Morse 2008). Secondary Redox Reactions In the meta-analysis, we identified the many secondary redox reactions that have been included across the diversity of diagenesis model applications. In AED CANDI, they are all included as options, and may be turned on or off as desired (Table 5 - 4). Equilibrium Geochemistry The pH is calculated as the sum of all charged species, where any unbalanced positive charge indicates H+. The charge balance is at each time step is solved as a state variable, which is subject to advection, diffusion and bioturbation reactions. The precipitation of minerals is solved as an equilibrium reaction, dependent on the concentrations of the dissolved and solid substances, their \\(K_{sp}\\) and ion activity product (IAP). The equations are applied in a similar manner to those in Van Cappellen and Wang (1996) and numerous other studies, but with the exact forms of the equations based on those from Tufano et al. (2009) (Table 5 - 5). A positive rate indicates precipitation and a negative rate indicates dissolution. This model applies the function to all mineral simulated, including Fe(OH)3, FeS, FeS2, FeCO3, CaCO3 and MnCO3. This model has a process of mineral ageing, whereby iron and manganese oxides become crystalline and no longer react with organic matter, but can still undergo secondary redox reactions. Physical Transport The analysis from chapter 2 showed that advection and diffusion reactions (equations 5 - 102, 5 - 103) are fairly consistent in diagenesis models, and here we use the same methods (Table 5 - 8). Porosity (ϕ) is defined according to equation 5 - 104, which allows it to decrease with depth, and the solid fraction is defined from \\(\\phi_s=1-\\phi)\\). For bioturbation the model uses a diffusion coefficient that varies with depth (\\(D_{B(x)}\\)) as a two layer function or a Gaussian decrease (Boudreau 1996). For the porewater components, diffusion coefficients are used that are based on free-solution molecular diffusion constants corrected for sediment tortuosity, \\(θ\\), according to equation 5 - 105. 20.3.2 Variable Summary 20.3.3 Parameter Summary 20.3.4 Optional Module Links 20.3.5 Feedbacks to the Host Model 20.4 Setup &amp; Configuration The preceding details were an explanation of the scientific aspects of this diagenesis model, and next we turn to practical implementation. 20.4.1 Implementation withing the FABM Framework The sediment diagenesis model AED CANDI is one module of the AED library (Table 5 - 9, Hipsey et al. 2013b), which is composed of numerous model components. The FABM allows any combination of these modules, or any other model package, to be included in a model simulation and couples them to a physical model of the water column, which provides the spatial and temporal resolution, and calculates the transport processes (Figure 5 - 1). The AED library is just one set that could be used with the FABM framework, where others include the Fasham model template (based on Fasham et al. 1990) or the simple NPZD model of Burchard et al. (2005). A range of physical models and configurations is also available, depending on whether the focus is on the sediment alone, or the sediment as part of a larger environmental simulation (Figure 5 - 3). Refer here for further up to date information about the FABM and available model codes. Figure 20.4: Spatial resolution options available through FABM. a) Water column studies have traditionally assigned a flux to the sediment water interface without resolving the sediment chemical concentrations by depth, though they can be resolved laterally. b) The 0D water column is the method used in most sediment diagenesis studies, and use of multiple sediment zones is an option available within the FABM. 20.4.2 Program Structure The general structure of the program is shown in Figure 5 - 5. The program is firstly initialised, then loops through the kinetic and equilibrium reactions for each time step and writes the resulting concentrations and rates at each depth to an output file. The kinetic reactions are solved by the VODE program (Brown et al. 1989) and the equilibrium reactions by the Simplex program. Figure 20.5: The program is firstly initialised, then loops through the kinetic and equilibrium reactions for each time step and writes the resulting concentrations and rates at each depth to an output file. The kinetic reactions are solved by the VODE program (Brown et al. 1989) and the equilibrium reactions by the Simplex program. 20.4.3 Model Setup, Boundary Conditions &amp; Parameter Definition The model is set up via the name list text file fabm.nml using the model keyword “aed_seddiagenesis” with the model configured to select the “Dynamic” option. Once this is selected, the model will search for the “&amp;aed_sedcandi” parameter block within fabm.nml. Each active sediment model within the FABM model is discretised into a user definable number of depth layers (maxnpts) that start at a thickness of a few mm at the sediment-water interface and which increase exponentially down to a pre-defined sediment depth (xl). Users must define the sediment domain physical properties as summarised in Table 5 - 10, including configuration options related to bioturbation and irrigation. The biogeochemical configuration (Table 5 - 11), rate constants (see Table 5 - 12 and Table 5 - 13) must be set according to the sub-model options described above. Table 20.2: Sediment physical and transport parameters Parameter name Unit Example value Description db0 cm2 y-1 10.00 Biodiffusion coefficient at sediment-water ineterface imix 0/1 0.00 Bioturbation function: 0-Gaussian; 1 – two-layer model xs cm 3.00 Half depth for Gaussian mixing (imix - 0) x1 cm 1.00 Depth at which db starts to decreacse (imix -1) x2 cm 5.00 Depth at which db is zero (imix - 1) irrig 0/1 1.00 Bioirrigation switch alpha0 y-1 15.00 Irrigation coefficient xirrig cm 4.00 Maximum irrigation depth ventflow cm y-1 0.00 Advective flux (positive value indicates from below) w00 cm y-1 0.75 Sediment accumulation velocity at maximum depth p0 0.90 Porosity at sediment-water interface (\\(\\phi_{0}\\) in equation 5 - 104) p00 0.80 Porosity at maximum depth (\\(\\phi_{xl}\\) in equation 5 - 104) bp 2.50 Porosity attenuation coefficient (\\(\\beta\\) in equation 5 - 104) torteq 1/2/3 3.00 Tortuosity calculation method switch: 1-Archie; 2-Burger; 3-Weissberg an 2.14 Porosity exponent for tortuosity (if Archie) aa 3.79 Porosity exponent for tortuosity (if Burger) ab 2.02 Porosity exponent for tortuosity (if Weissberg) xl cm 100.00 Maximum simulation depth maxnpts 40.00 Number of vertical layers Table 20.3: The major biogeochemical configuration options, which are set by the user before the model is initialised Biogeochemical configuration Unit Description Omapproach 1/2 Kinetic redox equations, corresponding to the approaches of chapter 2 OMModel 1/2/3 Organic matter breakdown models, as described in Table 5 - 1, Figure 5 - 2 FTem switch 1/2 Sets reaction rate dependency on temperature FT switch 1/2 Sets reaction rate dependency on thermodynamics FBio switch 1/2 Sets reaction rate dependency on biomass concentration FIN switch 1/2 Sets reaction rate dependency on concentration of other oxidants simMnFe T/F Turns all Mn and Fe primary and secondary reactions on or off simFeS T/F Turns all FeS reactions on or off simX T/F Allows simulation of adsorbed metal X Xname “X” Metal X: “As,” “Cu,” “Cd,” “Pb,” “Ni,” “Zn” simCaCO3 T/F Turns all calcite reactions on or off simFeCO3 T/F Turns all siderite reactions on or off simMnCO3 T/F Turns all rhodchrosite reactions on or off simNPads T/F Turns N and P adsorption on or off rxn_mode 0/1 Sets precipitation to: kinetic-0; IAP/Ksp-1 The initial conditions for each variable are set as a list by the “initial_vals,” which sets a constant concentration with depth in units of μmol L-1. For organic matter initial concentrations only, there are three available options for the concentration with depth, set by “OMInitMethodL.” The sediment-water interface is the uppermost layer of the sediment, for which there are three configuration options set by the parameter ibc2. If the user specifies ibc2 = 2, the concentration is a constant value set by default_vals in the fabm.nml name list. For ibc2 = 1, the concentration is provided by a “link_variable,” which provides the concentration from another simulated water column FABM module. If the variable name in the link list is left blank (“ ”) then AED_CANDI will assume these variables are not linked to any water column variables and default to the “default_vals” values. If ibc2 = 10, the concentration is provided by a user-prescribed temporally variable value read from the file aed_sediment_swibc.dat. This option may desirable, for example, for simulating a seasonally or daily changing boundary condition. Regardless of the ibc2 surface boundary condition option, fluxes of dissolved species occur between the sediment and water column. They are calculated from the concentration gradient at the sediment-water interface according to Fick’s Law: \\[\\begin{equation} F = D_{0}\\frac{\\Delta C}{\\Delta x} = \\frac{D_{0}}{\\delta} (C_{bw} - C_{1}) \\tag{20.1} \\end{equation}\\] where \\(D_{0}\\) is the diffusivity as defined above, \\(\\delta\\) is the thickness of the diffusive boundary layer at the sediment water interface and defined as the length scale of the first sediment layer, \\(C_{bw}\\) is the bottom water concentration and \\(C_{1}\\) is the concentration in the top sediment layer. At the bottom of the domain (\\(x\\) = “xl”) the model can be specified to have a fixed-concentration (ibbc = 0) such that the concentration at \\(xl = C_{Bot}\\), or it can be specified to have a zero-derivative (ibbc = 1) defined as \\(\\frac{dC}{dx}=0\\) at \\(x = xl\\). 20.4.4 Model Output &amp; Post-processing The model output files are written for each variable as text files, giving time (in years) as the first column depth as the first row and concentrations in the other fields. These can be read in using a data processing program such as R, Matlab or Excel for analysis. Further, the model outputs the file rates.sed for each variable at every depth for the final time step. 20.5 Case Studies &amp; Examples 20.5.1 Case Study 20.5.2 Publications "],["submerged-macrophytes.html", "21 Submerged Macrophytes 21.1 Contributors 21.2 Overview 21.3 Model Description 21.4 Setup &amp; Configuration 21.5 Case Studies &amp; Examples", " 21 Submerged Macrophytes 21.1 Contributors 21.2 Overview 21.3 Model Description 21.3.1 Process Descriptions 21.3.2 Variable Summary 21.3.3 Parameter Summary 21.3.4 Optional Module Links 21.3.5 Feedbacks to the Host Model 21.4 Setup &amp; Configuration 21.5 Case Studies &amp; Examples 21.5.1 Case Study 21.5.2 Publications "],["macroalgae.html", "22 Macroalgae 22.1 Contributors 22.2 Overview 22.3 Model Description 22.4 Setup &amp; Configuration 22.5 Case Studies &amp; Examples", " 22 Macroalgae 22.1 Contributors 22.2 Overview 22.3 Model Description 22.3.1 Process Descriptions 22.3.2 Variable Summary 22.3.3 Parameter Summary 22.3.4 Optional Module Links 22.3.5 Feedbacks to the Host Model 22.4 Setup &amp; Configuration 22.5 Case Studies &amp; Examples 22.5.1 Case Study 22.5.2 Publications "],["bivalves.html", "23 Bivalves 23.1 Contributors 23.2 Overview 23.3 Model Description 23.4 Setup &amp; Configuration 23.5 Case Studies &amp; Examples", " 23 Bivalves 23.1 Contributors 23.2 Overview Based on work in freshwater and estuarine systems a bivalve module to simulate growth, production, and (optionally) population dynamics has been incorporated into the AED2+ library. The model is originally based on an application to Oneida Lake and Lake Erie for mussels. One to several size classes of mussels are simulated based on physiological parameters assembled by Schneider (1992) and modified by Bierman et al. (2005) to estimate effect of mussels on Saginaw Bay, Michigan, USA; a formulation also used by Gudimov et al. (2015) to estimate mussel effects in Lake Simcoe, Ontario, Canada. Additionally, some model structure was taken from the Spillman et al. (2008) model of Tapes clams in the Barbamarco Lagoon, Italy, as modified by Bocaniov et al. (2014) for mussels in Lake Erie. The physiology of mussels are set to be size dependent, and can vary between species (e.g., Zebra vs Quagga)(Hetherington, 2016). Three size classes of mussels can be incorporated in the model, roughly corresponding to age-0, age-1 and age&gt;1 mussels. Physiological parameters are calculated for the weight assigned to each age class, using equations in Table 4. Individual mussel mass is given in mmol C or in the case of calculations of N and P budgets, in mmol N and mmol P. The stoichiometric ratios (C:N:P) are fixed. Group mussel biomass is calculated at each time step by calculating ingestion and subtracting pseudofeces production, standard dynamic action, respiration, excretion, egestion and mortality (expressed in mmol C/mmol C/day, mmol N/mmol N/day; mmol P/mmol P/day). Several of these processes are also functions of temperature, algal+POC concentrations, salinity, suspended solids and mussel density. The effect of salinity, suspended solids and mussel density is incorporated as a multiplier of filtration rate with the multipliers having values between -0 – (no filtering) and 1 (no effect). Mussel nitrogen and phosphorus concentrations are fixed ratios of mussel carbon concentrations. Since the various input and output fluxes have variable C:N:P ratios, the excretion of nutrients is dynamically adjusted each time-step to maintain this ratio at each time step. Reproduction and larval dynamics are not simulated. There is no transfer of biomass between age groups. 23.3 Model Description 23.3.1 Process Descriptions Ingestion Ingestion is modelled as a function of filtration rate, food availability, pseudofeces production, density, suspended solids, and salinity (Equation 2) (Schneider 1992; Bierman et al. 2005; Spillman et al. 2008; Gudimov et al. 2015). Filtration rate is based on maximum ingestion, temperature, food availability, and pseudofeces production according to the following: \\[\\begin{equation} FR = \\frac{\\frac{I_{max}*f(T)_{I}}{K_{A}}}{PF_{min}} \\text{ for } [A] &lt; KA \\tag{23.1} \\end{equation}\\] \\[\\begin{equation} FR = \\frac{\\frac{I_{max}*f(T)_{I}}{[A]}}{PF_{min}} \\text{ for } [A] &gt; KA \\tag{23.2} \\end{equation}\\] where \\(FR\\) is filtration rate (mmol/mmol/d), \\(Imax\\) is maximum ingestion rate (mmol/mmol/d), \\(f(T)_{I}\\) is filtration temperature function, \\(K_{A}\\) is optimum algal concentration (mmol/m3), \\([A]\\) is algal concentration + particulate organic carbon (POC) concentration (mmol/m3), and \\(PFmin\\) is minimum pseudofeces production (-). The maximum ingestion rate is based on weight from length according to the following: \\[\\begin{equation} I_{max} = (a_{I} * W^{bI}) \\tag{23.3} \\end{equation}\\] \\[\\begin{equation} W = \\frac{0.071}{1000} * L^{2.8} \\tag{23.4} \\end{equation}\\] where \\(Imax\\) is maximum ingestion rate (mmol/mmol/d), \\(a_{I}\\) is maximum standard ingestion rate (mmol/mmol/d), \\(W\\) is weight (g), \\(bI\\) is exponent for weight effect on ingestion, \\(L\\) in length (mm) (Schneider 1992; Bierman et al. 2005). The temperature dependence function (Thornton and Lessem 1978) was fit to zebra and quagga mussel data (Hetherington et al. Submitted) with optimal ingestion from 17°C to 20°C according to the following: \\[\\begin{equation} f(T)_{I} = 1 \\text{ for } T_{min_{I}} &lt; T &lt; T_{max_{I}} \\tag{23.5} \\end{equation}\\] \\[\\begin{equation} f(T)_{I} = (2*\\frac{Tmin_{TI}}{Tmin_{I}} - \\frac{(Tmin_{TI})^2}{(Tmin_{I})^2}) / (2*\\frac{Tmin_{I}-minT_{I}}{Tmin_{I}}-\\frac{(Tmin_{I}-minT_{I})^2}{(Tmin_{I})^2}) \\text{ for } minT_{I} &lt; T &lt; Tmin_{I} \\tag{23.6} \\end{equation}\\] \\[\\begin{equation} f(T)_{I} = -\\frac{(T^{2} + 2*Tmax_{I}*T–2*Tmax_{I}*maxT_{I} + maxT_{I}^{2})}{(Tmax_{I}-maxT_{I})^{2}} \\text{ for } Tmax_{I}&lt;T&lt;maxT_{I} \\tag{23.7} \\end{equation}\\] \\[\\begin{equation} f(T)_{I} = 0 \\text{ for } T &gt; maxT_{I} \\text{ or } T &lt; minT_{I} \\tag{23.8} \\end{equation}\\] where \\(T\\) is temperature (°C), \\(minT_{I}\\) is lower temperature for no ingestion (°C), \\(Tmin_{I}\\) is lower temperature for optimum ingestion (°C), \\(Tmax_{I}\\) is upper temperature for optimum ingestion, \\(maxT_{I}\\) is upper temperature for no ingestion (°C). Filtration rate is related to food concentration [Walz (1978); Sprung and Rose (1988); Schneider (1992); Bierman et al. (2005)). The filtration rate is maintained at a maximum value for all food values less than saturation food concentration. The filtration rate decreases as food concentrations increase above this value. Pseudofeces production is implicit as the difference between the mass filtered and consumed. According to Walz (1978), pseudofeces production (66%) was approximately double the ingestion rate (34%) at high food concentrations Bierman et al. (2005). Mussel density limits ingestion above some maximum density according to the following: \\[\\begin{equation} $f(D) = 1$ for $D&lt;Dmax$ \\tag{23.9} \\end{equation}\\] \\[\\begin{equation} f(D) = \\frac{-(D^{2} + 2*Dmax*D – 2*Dmax*maxD + maxD^{2})}{(Dmax – maxD)^{2}} \\text{ for } D&gt;Dmax \\tag{23.10} \\end{equation}\\] \\[\\begin{equation} f(D) = 0 \\text{ for } D&gt;maxD \\tag{23.11} \\end{equation}\\] where \\(D\\) is density (mmol/m2), \\(Dmax\\) is upper density for optimum ingestion (mmol/m2), and \\(maxD\\) is upper density for no ingestion (mmol/m2). An additional function to reduce ingestion is the suspended solids function which decreases ingestion with high inorganic loads according to the following: \\[\\begin{equation} f(SS) = 1 \\text{ for } SS&lt;SSmax \\tag{23.12} \\end{equation}\\] \\[\\begin{equation} f(SS) = \\frac{-(SS^{2} + 2*SSmax*SS – 2*SSmax*maxSS + maxSS^{2})}{(SSmax – maxSS)^{2}} \\text{ for } SS&gt;SSmax \\tag{23.13} \\end{equation}\\] \\[\\begin{equation} f(SS) = 0 \\text{ for } SS&gt;maxSS \\tag{23.14} \\end{equation}\\] where \\(SS\\) is suspended solids (mg/L), \\(SSmax\\) is upper suspended solids for optimum ingestion (mg/L), and \\(maxSS\\) is upper suspended solids for no ingestion (mg/L) (Spillman et al. 2008). Along with suspended solids, salinity limits ingestion according to the following: \\[\\begin{equation} f(S) = 1 \\text{ for } Smin &lt; S &lt; Smax \\tag{23.15} \\end{equation}\\] \\[\\begin{equation} f(S) = \\frac{(2*(S-minS)/Smin)–(S-minS)^{2}/Smin^{2})}{(2*(Smin-minS)/Smin)–(Smin-minS)^{2}/Smin^{2})} \\text{ for } minS&lt; S &lt; Smin \\tag{23.16} \\end{equation}\\] \\[\\begin{equation} f(S) = \\frac{-(S^{2} + 2*Smax*S – 2*Smax*maxS + maxS^{2})}{(Smax-maxS)^{2}} \\text{ for } Smax&lt;S&lt;maxS \\tag{23.17} \\end{equation}\\] \\[\\begin{equation} f(S) = 0 \\text{ for } S &gt; maxS \\text{ or } S &lt; minS \\tag{23.18} \\end{equation}\\] where \\(S\\) is salinity (psu), \\(minS\\) is lower salinity for no ingestion (psu), \\(Smin\\) is lower salinity for optimum ingestion (psu), \\(Smax\\) is upper salinity for optimum ingestion (psu), \\(maxS\\) is upper salinity for no ingestion (psu) (Spillman et al. 2008). Respiration Respiration is modelled as a base or standard respiration rate based on weight and temperature (Spillman et al. 2008). Respiration rate coefficient at 20°C is based on weight from length according to the following: \\[\\begin{equation} R_{20} = (a_{R} * W^{b}_{R}) \\tag{23.19} \\end{equation}\\] \\[\\begin{equation} W = \\frac{0.071}{1000} * L^{2.8} \\tag{23.20} \\end{equation}\\] where \\(R_{20}\\) is respiration rate coefficient at 20°C (mmol/mmol/d), \\(a_{R}\\) is standard respiration rate (mmol/mmol/d), \\(W\\) is weight (g), \\(b_{R}\\) is exponent for weight effect of respiration, and \\(L\\) is length (mm) (Schneider 1992). The respiration rate coefficient is adjusted for temperature according to the following: \\[\\begin{equation} f(T)_{RSpillman} = \\Theta_{RSpillman}^{T-20} \\tag{23.21} \\end{equation}\\] where \\(f(T)_{RSpillman}\\) is respiration temperature function, \\(\\Theta_{RSpillman}\\) is temperature multiplier for bivalve respiration (-), and \\(T\\) is temperature (°C) (Spillman et al. 2008). Alternatively, respiration is modelled as a base or standard respiration rate based on weight and temperature in addition to the energetic cost of feeding. Respiration rate coefficient at 30°C is based on weight from length according to the following: \\[\\begin{equation} R_{30} = (a^{R} * W^{b}_{R}) \\tag{23.22} \\end{equation}\\] \\[\\begin{equation} W = \\frac{0.071}{1000} * L^{2.8} \\tag{23.23} \\end{equation}\\] where \\(R_{30}\\) is respiration rate coefficient at 30°C (mmol/mmol/d), \\(a^{R}\\) is standard respiration rate (mmol/mmol/d), \\(W\\) is weight (g), \\(b_{R}\\) is exponent for weight effect of respiration, and \\(L\\) is length (mm) (Schneider 1992). The temperature function follows Schneider (1992) application of the model of Kitchell, Stewart, and Weininger (1977) to the data of Jr and McMahon (2004) according to the following: \\[\\begin{equation} f(T)_{RSchneider} = V^{X} * e^{X * (1-V)} \\tag{23.24} \\end{equation}\\] \\[\\begin{equation} V = \\frac{Tmax_{R} – T}{Tmax_{R} – maxT_{R}} \\tag{23.25} \\end{equation}\\] \\[\\begin{equation} X = (\\frac{W*(1+\\sqrt{1 + (\\frac{40}{Y})})}{20})^2 \\tag{23.26} \\end{equation}\\] \\[\\begin{equation} W = lnQ_{R}*(Tmax_{R} – maxT_{R}) \\tag{23.27} \\end{equation}\\] \\[\\begin{equation} Y = lnQ_{R}*(Tmax_{R} – maxT_{R} + 2) \\tag{23.28} \\end{equation}\\] where \\(T\\) is temperature (°C), \\(Tmax_{R}\\) is upper temperature for optimum respiration (°C), \\(maxT_{R}\\) is upper temperature for no respiration (°C), and \\(Q_{R}\\) is respiration curve slope estimate (-). The maximum respiration occurs at 30°C with 43°C as the upper lethal temperature. The energetic cost of feeding or specific dynamic action is applied only to the portion of ingestion that is not egested (Schneider 1992; Bierman et al. 2005; Gudimov et al. 2015). Excretion Excretion is modelled as a constant fraction of assimilated food (Schneider 1992; Bierman et al. 2005; Gudimov et al. 2015). Excretion data for zebra and quagga mussels are limited; therefore, the excretion formulation for Mytilus edulis derived by Bayne and Newell (1983) was used (Schneider 1992; Bierman et al. 2005; Gudimov et al. 2015). Egestion Egestion is modeled as a function of ingestion (Schneider 1992; Bierman et al. 2005; Gudimov et al. 2015). The model follows the assumption that ingestion is directly proportional to the food content of the water for all food concentrations less than the maximum which can be ingested. For all food concentrations above this saturation value, ingestion remains constant at a maximum value (\\(I_{max}\\)) (Walz 1978). Mortality Mortality is a function of dissolved oxygen and predation (Equation 7). Mortality increases with low dissolved oxygen concentrations according to the following: \\[\\begin{equation} f(DO) = 1 + K_{BDO} * \\frac{K_{DO}}{K_{DO} + DO} \\tag{23.29} \\end{equation}\\] where \\(DO\\) is dissolved oxygen (mmol/m3), \\(K_{BDO}\\) is basal respiration rate (mmol/m3), and \\(K_{DO}\\) is half saturation constant for metabolic response to dissolved oxygen (mmol/m3) (Spillman et al. 2008). A mortality rate coefficient (\\(K_{MORT}\\)) further influences the dissolved oxygen function. Additionally, mortality from predation is a constant rate added to the effect from dissolved oxygen. 23.3.2 Variable Summary State Variables Table 23.1: State variables Variable Name Description Units Variable Type Core/Optional BIV_{group} Bivalve group \\(mmol C\\,m^{-2}\\,day^{-1}\\) Benthic Core BIV_filtfrac Filtered fraction of water % Pelagic Optional : biv_tracer = .true. Diagnostics Table 23.2: Diagnostics Variable Name Description Units Variable Type Core/Optional BIV_tgrz Total rate of food filtration/grazing in the water column \\(mmol C\\,m^{-3}\\,day^{-1}\\) Pelagic diagnostic Core BIV_nmp Net mussel production \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_tbiv Total bivalve density (all groups) \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_grz Net bivalve filtration/grazing \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_resp Net bivalve respiration \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_mort Net bivalve mortality \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_excr Net bivalve excretion \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_egst Net bivalve egestion (faeces) \\(mmol C\\,m^{-3}\\,day^{-1}\\) Benthic diagnostic Core BIV_fT Bivalve temperature limitation NA Benthic diagnostic Optional: extra_diag=.true. BIV_fD Bivalve sediment limitation NA Benthic diagnostic Optional: extra_diag=.true. BIV_fG Bivalve food limitation NA Benthic diagnostic Optional: extra_diag=.true. BIV_fR Filtration rate \\(m^{3}\\, mmol C\\,m^{-2}\\,day^{-1}\\) Benthic diagnostic Optional: extra_diag=.true. BIV_pf Pseudofeaces production rate \\(day^{-1}\\) Benthic diagnostic Optional: extra_diag=.true. 23.3.3 Parameter Summary Table 23.3: Diagnostics name ‘zebra’ ‘quagga’ string Name of bivalve group General Parameters initial_conc 833 833 real Initial concentration of bivalve (mmolC/m2) min 8.3 8.3 real Minimum concentration of bivalve (mmolC/m3) length 15 15 real Length of bivalve (mm) INC 291.67 291.67 real Ratio of internal nitrogen to carbon of bivalve (-) IPC 64.58 64.58 real Ratio of internal phosphorus to carbon of bivalve (-) FILTRATION &amp; INGESTION Parameters Rgrz 1.9 0.12 real Maximum ingestion rate of bivalve (mmol/mmol/day) (Spillman et al. 2008) Calculated from Schneider 1992 based on 15 mm mussel Ing 0 0 integer Type of maximum ingestion for bivalve; 0=Enter (mmol/mmol/d) or 1=Calculate based on length WaI 0 0 real Maximum standard ingestion rate of bivalve (mmol/mmol/day) (Schneider 1992) WbI -0.39 -0.39 real Exponent for weight effect on ingestion of bivalve (-) (Schneider 1992) fassim 0.34 0.34 real Minimum proportion of food lost as pseudofeces for bivalve (-) Cmin_grz 0.05 0.05 real Minimum prey concentration for grazing by bivalve (mmolC/m3) Kgrz 187.5 187.5 real Optimum algae+POC concentration for ingestion of bivalve (mmol/m3) minT 4 4 real Lower temperature for no ingestion of bivalve (degC) Tmin 17 17 real Lower temperature for optimum ingestion of bivalve (degC) Tmax 20 20 real Upper temperature for optimum ingestion of bivalve (degC) maxT 32 32 real Upper temperature for no ingestion of bivalve (degC) Dmax 6333.3 6333.3 real Upper density for optimum ingestion of bivalve (mmol/m2) maxD 20000 20000 real Upper density for no ingestion of bivalve (mmol/m2) Ssmax 20 20 real Upper suspended solids for optimum ingestion of bivalve (mg/L) maxSS 100 100 real Upper suspended solids for no ingestion of bivalve (mg/L) EXCRETION AND EGESTION Parameters Rexcr 0 0 real Excretion fraction of ingestion for bivalve(-) Regst 0 0 real Minimum proportion egested as feces for bivalve (-) gegst 0 0 real Gamma coefficient for food availability dependence for bivalve RESPIRATION Parameters Rresp 0.01 0.01 real Respiration rate coefficient of bivalve (/day) (Calculated from Schneider 1992 based on 15 mm mussel) saltfunc 0 0 integer Type of salinity function for bivalve; 0=None or 1=Spillman et al. 2008 minS 0 0 real Lower salinity for no ingestion of bivalve (psu) Smin 0 0 real Lower salinity for optimum ingestion of bivalve (psu) Smax 0 0 real Upper salinity for optimum ingestion of bivalve (psu) maxS 0 0 real Upper salinity for no ingestion of bivalve (psu) fR20 0 0 integer Type of maximum respiration for bivalve; 0=Enter or 1=Calculate based on length (mm) War 16.759 16.759 real Standard respiration rate of bivalve (mmol/mmol/d) (Schneider 1992) Wbr -0.25 -0.25 real Exponent for weight effect on respiration of bivalve (-) fR 1 1 integer Type of respiration function for bivalve; 0=Schneider 1992 or 1=Spillman et al. 2008 theta_resp 1.08 1.08 real Temperature multiplier for respiration of bivalve (-) TmaxR 30 30 real Upper temperature for optimum respiration of bivalve (degC) maxTR 43 43 real Upper temperature for no respiration of bivalve (degC) Qresp 2.3 2.3 real Respiration curve slope estimate for bivalve (-) SDA 0.285 0.285 real Specific dynamic action of bivalve (-) MORTALITY Parameters Rmort 0 0 real Mortality rate coefficient for bivalve (/day) Rpred 0 0 real Mortality rate from predation of bivalve (/day) fDO 0 0 integer Type of dissolved oxygen function for bivalve; 0=None or 1=XXX or 2=XXX K_BDO 160 160 real Basal respiration rate of bivalve (mmol/m3) KDO 8 8 real Half saturation constant for metabolic response to DO for bivalve (mmol/m3) GENERAL Parameters num_prey 3 3 integer Number of state variables for bivalve prey prey(1)%bivalve_prey PHY_green PHY_green string State variable name of bivalve prey prey(1)%Pbiv_prey 1 1 real Preference factors for bivalve predators grazing on prey prey(2)%bivalve_prey PHY_diatom PHY_diatom string State variable name of bivalve prey prey(2)%Pbiv_prey 1 1 real Preference factors for bivalve predators grazing on prey prey(3)%bivalve_prey PHY_crypto OGM_poc string State variable name of bivalve prey prey(3)%Pbiv_prey 1 1 real Preference factors for bivalve predators grazing on prey 23.3.4 Optional Module Links 23.3.5 Feedbacks to the Host Model 23.4 Setup &amp; Configuration 23.4.1 Setup Example Table 23.4: Parameters and configuration Parameter Name Description Units Parameter Type Default Typical Range Comment num_biv Number of zooplankton groups NA Integer NA 0-3 NA the_biv List of ID’s of groups in aed_zoo_pars.nml (len=num_phyto) NA Integer NA 1/3/17 NA n_zones Number of sediment zones where bivalves will be active NA Integer NA NA NA active_zones The vector of sediment zones to include NA Integer (vector) NA NA NA biv_tracer Opton to include water column tracer tracking filtration amount NA Boolean .false. NA NA biv_feedback Switch to enable/disable feedbacks between bivalve metabolism and water column variable concentration NA Boolean .false. NA NA dn_target_variable Water column variable to receive DON excretion NA String NA NA NA pn_target_variable Water column variable to receive PON egestion/mortality NA String NA NA NA dp_target_variable Water column variable to receive DOP excretion NA String NA NA NA pp_target_variable Water column variable to receive POP egestion/mortality NA String NA NA NA dc_target_variable Water column variable to receive DOC excretion NA String NA NA NA pc_target_variable Water column variable to receive POC egestion/mortality NA String NA NA NA do_uptake_variable Water column variable providing DO concentration NA String NA NA NA ss_uptake_variable Water column variable providing SS concentration NA String NA NA NA dbase = 'AED2/aed2_bivalve_pars.nml' NA NA String aed2_bivalve_pars.nml aed2/aed2_bivalve_pars.nml NA extra_diag Switch to enable/disable extra diagnostics to be output NA Boolean .false. NA NA biv_fixedenv Switch to enable/disable environmental variables to be fixed (for testing) NA Boolean .false. NA NA fixed_temp Fixed temperature C Float NA 20 NA fixed_oxy Fixed oxygen concentration \\(mmol O_2\\,m^{-3}\\) Float NA 300 NA fixed_food Fixed food concentration \\(mmol C\\,m^{-3}\\) Float NA 20 NA An example nml block for the bivalve module is shown below: &amp;aed2_bivalve num_biv = 2 the_biv = 1,2 ! dn_target_variable=&#39;&#39; ! dissolved nitrogen target variable pn_target_variable=&#39;&#39; ! particulate nitrogen target variable dp_target_variable=&#39;&#39; ! dissolved phosphorus target variable pp_target_variable=&#39;&#39; ! particulate phosphorus target variable dc_target_variable=&#39;&#39; ! dissolved carbon target variable pc_target_variable=&#39;&#39; ! particulate carbon target variable do_uptake_variable=&#39;OXY_oxy&#39; ! oxygen uptake variable ss_uptake_variable=&#39;&#39; ! oxygen uptake variable !FIX FROM ERIE! !n_zones, active_zones, extra_diag,&amp; !simBivTracer, simBivFeedback, simStaticBiomass, &amp; !dbase, simFixedEnv, fixed_temp, fixed_sal, fixed_oxy, fixed_food, &amp; initFromDensity / 23.5 Case Studies &amp; Examples 23.5.1 Case Study 23.5.2 Publications References "],["benthic-habitat-quality.html", "24 Benthic Habitat Quality 24.1 Contributors 24.2 Overview 24.3 Model Description 24.4 Setup &amp; Configuration 24.5 Case Studies &amp; Examples", " 24 Benthic Habitat Quality 24.1 Contributors 24.2 Overview 24.3 Model Description 24.3.1 Process Descriptions 24.3.2 Variable Summary 24.3.3 Parameter Summary 24.3.4 Optional Module Links 24.3.5 Feedbacks to the Host Model 24.4 Setup &amp; Configuration 24.5 Case Studies &amp; Examples 24.5.1 Case Study 24.5.2 Publications "],["soil-hydrology.html", "25 Soil Hydrology 25.1 Contributors 25.2 Overview 25.3 Model Description 25.4 Setup &amp; Configuration 25.5 Case Studies &amp; Examples", " 25 Soil Hydrology 25.1 Contributors 25.2 Overview 25.3 Model Description 25.3.1 Process Descriptions 25.3.2 Variable Summary 25.3.3 Parameter Summary 25.3.4 Optional Module Links 25.3.5 Feedbacks to the Host Model 25.4 Setup &amp; Configuration 25.5 Case Studies &amp; Examples 25.5.1 Case Study 25.5.2 Publications "],["soil-biogeochemistry.html", "26 Soil Biogeochemistry 26.1 Contributors 26.2 Overview 26.3 Model Description 26.4 Setup &amp; Configuration 26.5 Case Studies &amp; Examples", " 26 Soil Biogeochemistry 26.1 Contributors 26.2 Overview 26.3 Model Description 26.3.1 Process Descriptions 26.3.2 Variable Summary 26.3.3 Parameter Summary 26.3.4 Optional Module Links 26.3.5 Feedbacks to the Host Model 26.4 Setup &amp; Configuration 26.5 Case Studies &amp; Examples 26.5.1 Case Study 26.5.2 Publications "],["acid-sulfate-soils.html", "27 Acid Sulfate Soils 27.1 Contributors 27.2 Overview 27.3 Model Description 27.4 Setup &amp; Configuration 27.5 Case Studies &amp; Examples", " 27 Acid Sulfate Soils 27.1 Contributors 27.2 Overview 27.3 Model Description 27.3.1 Process Descriptions 27.3.2 Variable Summary 27.3.3 Parameter Summary 27.3.4 Optional Module Links 27.3.5 Feedbacks to the Host Model 27.4 Setup &amp; Configuration 27.5 Case Studies &amp; Examples 27.5.1 Case Study 27.5.2 Publications "],["riparian-vegetation.html", "28 Riparian Vegetation 28.1 Contributors 28.2 Overview 28.3 Model Description 28.4 Setup &amp; Configuration 28.5 Case Studies &amp; Examples", " 28 Riparian Vegetation 28.1 Contributors 28.2 Overview 28.3 Model Description 28.3.1 Process Descriptions 28.3.2 Variable Summary 28.3.3 Parameter Summary 28.3.4 Optional Module Links 28.3.5 Feedbacks to the Host Model 28.4 Setup &amp; Configuration 28.5 Case Studies &amp; Examples 28.5.1 Case Study 28.5.2 Publications "],["riparian-habitat-quality.html", "29 Riparian Habitat Quality 29.1 Contributors 29.2 Overview 29.3 Model Description 29.4 Setup &amp; Configuration 29.5 Case Studies &amp; Examples", " 29 Riparian Habitat Quality 29.1 Contributors 29.2 Overview 29.3 Model Description 29.3.1 Process Descriptions 29.3.2 Variable Summary 29.3.3 Parameter Summary 29.3.4 Optional Module Links 29.3.5 Feedbacks to the Host Model 29.4 Setup &amp; Configuration 29.5 Case Studies &amp; Examples 29.5.1 Case Study 29.5.2 Publications "],["generic-utilities-functions.html", "30 Generic Utilities &amp; Functions 30.1 Overview 30.2 Physico-chemical 30.3 Biological", " 30 Generic Utilities &amp; Functions 30.1 Overview 30.2 Physico-chemical 30.2.1 Gas Transfer Target: review and select a few most popularly used gas exchange velocity to be used in AED modules. Note only key factors of wind speed, current speed, and water depths are considered. Selection criteria: Environment: ocean; lake; estuary/river; Study for which gas: O2, CH4, N2O, CO2 Variables: wind speeds (\\(U\\)), current speeds (\\(v\\)), depths (\\(h\\)) Schmidt number normalization: yes/no. \\(Sc = \\frac{\\mu }{d} = \\frac{\\text{kinematic viscosity}}{\\text{diffusion}}\\) Table 30.1: Source Computation AED Case Number NA \\(schmidt = (0.9+0.1*\\frac{salt}{35.0})*(1953.4+temp*(-128.0+temp*(3.9918-temp*0.050091)))\\) 1 NA \\(schmidt = 0.9 + \\frac{salt}{350.0}\\) \\(schmidt = schmidt * (2073.1 -125.62*temp +3.6276*temp^{2} - 0.043219*temp^{3})\\) 2 NA \\(schmidt = (1.0 + 3.4e-3*salt)\\) \\(schmidt = schmidt * (1800.6 -120.1*temp +3.7818*temp^{2} - 0.047608*temp^{3})\\) 3 Arianto Santoso \\(schmidt = 2039.2 - (120.31*temp) + (3.4209*temp^{2}) - (0.040437*temp^{3})\\) \\(schmidt = \\frac{schmidt}{600}\\) 4 Wanninkhof (1992) \\(schmidt = 1897.8 - (114.28*temp) + (3.2902*temp^{2}) - (0.039061*temp^{3})\\) 5 Wanninkhof (1992) \\(schmidt = 2055.6 - (137.11*temp) + (4.3173*temp^{2}) - (0.054350*temp^{3})\\) 6 Table 30.2: Source Computation \\(v\\): current velocity \\(U\\): wind speed \\(h\\): water depth Environment Gas Required Variables \\(Sc\\) Normalisation Comment AED Option Number Liss and Merlivat (1986) \\(k = K_{600}(\\frac{Sc}{600})^{-\\frac{1}{2}}\\) \\(K_{600} = 0.17U\\) for \\(U \\leq 3.6\\) \\(K_{600} = 2.85U - 9.65\\) for \\(3.6 \\lt U \\leq 13\\) \\(K_{600} = 5.9U - 49.3\\) for \\(U \\gt 13\\) Lake and ocean CO2 \\(U\\) Yes, 600 One of the most popular formulas in early stage \\(\\Theta_{gas}^{schmidt} = 1\\) Wanninkhof (1992) \\(k = 0.31U^{2}(\\frac{Sc}{660})^{-\\frac{1}{2}}\\) Ocean, open lakes CO2 \\(U\\) Yes, 660 One of the most globally popular formulas for oceans and lakes \\(\\Theta_{gas}^{schmidt} = 2\\) Wanninkhof (2014) \\(k = 0.251U^{2}(\\frac{Sc}{660})^{-\\frac{1}{2}}\\) Ocean, open lakes CO2 \\(U\\) Yes, 660 Updated formula of Wanninkhof (1992). Note the coefficient of 0.251 is now closer to Ho et al. (2011), Ho et al. (2016), and Borges et al. (2004). \\(\\Theta_{gas}^{schmidt} = 3\\) Ho et al. (2011) \\(k = 0.26U^{2}(\\frac{Sc}{600})^{-\\frac{1}{2}}\\) Ocean, coastal area He/SF6 \\(U\\) Yes, 600 Measurement at ocean and coastal area \\(\\Theta_{gas}^{schmidt} = 4\\) Ho et al. (2016) \\(k = K_{600}(\\frac{Sc}{600})^{-\\frac{1}{2}}\\) \\(K_{600} = 0.77v^{\\frac{1}{2}}h^{-\\frac{1}{2}}+0.266U^{2}\\) Estuary, rivers He/SF6 \\(v\\),\\(U\\),\\(h\\) Yes, 600 Measurement at estuarine environment \\(\\Theta_{gas}^{schmidt} = 5\\) Raymond and Cole (2001) \\(k = K_{600}(\\frac{Sc}{600})^{-\\frac{1}{2}}\\) \\(K_{600} = 1.91exp(0.35U)\\) Estuary, rivers CO2 \\(U\\) Yes, 600 An equation for estuary/river environment but against only on winds based on extensive review. Note the K value here is much higher than ocean environment in high wind speeds (e.g. Wanninkhof (1992)). \\(\\Theta_{gas}^{schmidt} = 6\\) Borges et al. (2004) \\(k = K_{600}(\\frac{Sc}{600})^{-\\frac{1}{2}}\\) \\(K_{600} = 1.0 + 1.719v^{\\frac{1}{2}}h^{\\frac{1}{2}}+2.85U\\) Scheldt Estuary CO2 \\(v\\),\\(U\\),\\(h\\) Yes, 600 A equation for estuary environment from extensive measurement at Scheldt Estuary \\(\\Theta_{gas}^{schmidt} = 7\\) Rosentreter et al. (2016) \\(k = K_{600}(\\frac{Sc}{600})^{-\\frac{1}{2}}\\) \\(K_{600CO_{2}} = -0.08+0.26v+0.83U+0.59h\\) \\(K_{600CO_{4}} = -1.07+0.36v+0.99U+0.87h\\) Estuaries CO2, CH4 \\(v\\),\\(U\\),\\(h\\) Yes, 600 Equations developed specially for Queensland estuaries \\(\\Theta_{gas}^{schmidt} = 8\\) 30.3 Biological References "],["publications-25.html", "31 Publications", " 31 Publications The following publications have applied the AED modelling library. Please edit this page by clicking the above icon if you wish to have a new publication added, or contact the authors. /* Style the buttons inside the tab */ .tab button { background-color: #2481AA; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 17px; color: #FFFFFF; font-weight: bold; } Publications Tab 2 Tab 3 Table 31.1: Publications Author/Year Paper Title Description Bruce et al. (2014) Hydrodynamic controls on oxygen dynamics in a riverine salt wedge estuary, the Yarra River estuary, Australia Estuarine Bucak et al. (2018) Modeling the effects of climatic and land use changes on phytoplankton and water quality of the largest Turkish freshwater lake: Lake Beyşehir Estuarine Chen et al. (2018) Effectiveness of a bubble-plume mixing system for managing phytoplankton in lakes and reservoirs Lake Coletti, Vogwill, and Hipsey (2017) Water management can reinforce plant competition in salt-affected semi-arid wetlands Wetland Devlin and Toby (2019) Integrated aquaculture modelling to determine carrying capacity of aquaculture development zones in the Arab Gulf Aquaculture Fadel et al. (2019) A simple modelling approach to simulate the effect of different climate scenarios on toxic cyanobacterial bloom in a eutrophic reservoir Lake Farrell et al. (2020) Ecosystem-scale nutrient cycling responses to increasing air temperatures vary with lake trophic state Lake Fenocchi et al. (2019) Applicability of a one-dimensional coupled ecological-hydrodynamic numerical model to future projections in a very deep large lake (Lake Maggiore, Northern Italy/Southern Switzerland) Lake Fenocchi et al. (2020) Model simulations of the ecological dynamics induced by climate and nutrient load changes for deep subalpine Lake Maggiore (Italy/Switzerland): Model simulations of the future ecological dynamics of Lake Maggiore Lake Griffith and Tate (2014) Hawkesbury Nepean River and South Creek Model River Huang et al. (2018) Assessing artificial oxygenation in a riverine salt-wedge estuary with a three-dimensional finite-volume model Estuarine Krinos et al. (2019) Including variability in air temperature warming scenarios in a lake simulation model highlights uncertainty in predictions of cyanobacteria Lake Liu et al. (2020) Unravelling the metabolism black-box in a dynamic wetland environment using a hybrid model framework: Storm driven changes in oxygen budgets Wetland Snortheim et al. (2017) Meteorological drivers of hypolimnetic anoxia in a eutrophic, north temperate lake Lake Subratie et al. (2017) GRAPLEr: A distributed collaborative environment for lake ecosystem modeling that integrates overlay networks, high-throughput computing, and WEB services Lake Ward et al. (2020) Differential responses of maximum versus median chlorophyll‐ a to air temperature and nutrient loads in an oligotrophic lake over 31 years Lake Weber et al. (2017) Optimizing withdrawal from drinking water reservoirs to reduce downstream temperature pollution and reservoir hypoxia River Weng et al. (2020) Coupling Natural and Human Models in the Context of a Lake Ecosystem: Lake Mendota, Wisconsin, USA Lake Zhang et al. (2017) Simulation of multiple water source ecological replenishment for Chagan Lake based on coupled hydrodynamic and water quality models Lake Tab 2 This is the second tab Tab 3 This is the third tab. References "],["abbreviations.html", "32 Abbreviations", " 32 Abbreviations "],["references.html", "References", " References "]]
