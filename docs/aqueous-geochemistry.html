<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Aqueous Geochemistry | The AED Manual</title>
  <meta name="description" content="Work in progress." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Aqueous Geochemistry | The AED Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Work in progress." />
  <meta name="github-repo" content="AquaticEcoDynamics/aed-science/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Aqueous Geochemistry | The AED Manual" />
  
  <meta name="twitter:description" content="Work in progress." />
  



<meta name="date" content="2022-06-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="phytoplankton.html"/>
<link rel="next" href="pathogens-microbial-indicator-organisms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<script src="https://hypothes.is/embed.js" async></script>
  


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/tabs.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="http://aed.see.uwa.edu.au/research/models/aed/"><center><img src="images/aed-icon.png" width="90"></center></a></li><li><a href="./"><center>The AED Manual</center></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Modelling Aquatic Eco-Dynamics: Overview of the AED modular simulation platform</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#welcome"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#editing-the-book"><i class="fa fa-check"></i>Editing the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-cite-this-book"><i class="fa fa-check"></i>How to cite this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#supporting-the-project"><i class="fa fa-check"></i>Supporting the project</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-aed"><i class="fa fa-check"></i>Why AED?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#scientific-overview"><i class="fa fa-check"></i>Scientific Overview</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#application-contexts"><i class="fa fa-check"></i>Application Contexts</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#navigating-this-book"><i class="fa fa-check"></i>Navigating this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="nomenclature.html"><a href="nomenclature.html"><i class="fa fa-check"></i><b>2</b> Nomenclature</a>
<ul>
<li class="chapter" data-level="2.1" data-path="nomenclature.html"><a href="nomenclature.html#variables-and-data-types"><i class="fa fa-check"></i><b>2.1</b> Variables and Data Types</a></li>
<li class="chapter" data-level="2.2" data-path="nomenclature.html"><a href="nomenclature.html#a-note-on-notation"><i class="fa fa-check"></i><b>2.2</b> A Note on Notation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="nomenclature.html"><a href="nomenclature.html#general-notation"><i class="fa fa-check"></i><b>2.2.1</b> General Notation</a></li>
<li class="chapter" data-level="2.2.2" data-path="nomenclature.html"><a href="nomenclature.html#model-domain-and-position"><i class="fa fa-check"></i><b>2.2.2</b> Model Domain and Position</a></li>
<li class="chapter" data-level="2.2.3" data-path="nomenclature.html"><a href="nomenclature.html#environmental-conditions"><i class="fa fa-check"></i><b>2.2.3</b> Environmental Conditions</a></li>
<li class="chapter" data-level="2.2.4" data-path="nomenclature.html"><a href="nomenclature.html#transport-reference-frame"><i class="fa fa-check"></i><b>2.2.4</b> Transport Reference Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organisation-of-the-library-module-structure.html"><a href="organisation-of-the-library-module-structure.html"><i class="fa fa-check"></i><b>3</b> Organisation of the Library &amp; Module Structure</a>
<ul>
<li class="chapter" data-level="3.1" data-path="organisation-of-the-library-module-structure.html"><a href="organisation-of-the-library-module-structure.html#library-design"><i class="fa fa-check"></i><b>3.1</b> Library Design</a></li>
<li class="chapter" data-level="3.2" data-path="organisation-of-the-library-module-structure.html"><a href="organisation-of-the-library-module-structure.html#model-structure"><i class="fa fa-check"></i><b>3.2</b> Model Structure</a></li>
<li class="chapter" data-level="3.3" data-path="organisation-of-the-library-module-structure.html"><a href="organisation-of-the-library-module-structure.html#module-summary"><i class="fa fa-check"></i><b>3.3</b> Module Summary</a></li>
</ul></li>
<li class="part"><span><b>I AED Water Modules</b></span></li>
<li class="chapter" data-level="4" data-path="DO_1.html"><a href="DO_1.html"><i class="fa fa-check"></i><b>4</b> Dissolved Oxygen</a>
<ul>
<li class="chapter" data-level="4.1" data-path="DO_1.html"><a href="DO_1.html#contributors"><i class="fa fa-check"></i><b>4.1</b> Contributors</a></li>
<li class="chapter" data-level="4.2" data-path="DO_1.html"><a href="DO_1.html#overview"><i class="fa fa-check"></i><b>4.2</b> Overview</a></li>
<li class="chapter" data-level="4.3" data-path="DO_1.html"><a href="DO_1.html#model-description"><i class="fa fa-check"></i><b>4.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="DO_1.html"><a href="DO_1.html#process-descriptions"><i class="fa fa-check"></i><b>4.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="4.3.2" data-path="DO_1.html"><a href="DO_1.html#optional-module-links"><i class="fa fa-check"></i><b>4.3.2</b> Optional Module Links</a></li>
<li class="chapter" data-level="4.3.3" data-path="DO_1.html"><a href="DO_1.html#feedbacks-to-the-host-model"><i class="fa fa-check"></i><b>4.3.3</b> Feedbacks to the Host Model</a></li>
<li class="chapter" data-level="4.3.4" data-path="DO_1.html"><a href="DO_1.html#variable-summary"><i class="fa fa-check"></i><b>4.3.4</b> Variable Summary</a></li>
<li class="chapter" data-level="4.3.5" data-path="DO_1.html"><a href="DO_1.html#parameter-summary"><i class="fa fa-check"></i><b>4.3.5</b> Parameter Summary</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="DO_1.html"><a href="DO_1.html#setup-configuration"><i class="fa fa-check"></i><b>4.4</b> Setup &amp; Configuration</a></li>
<li class="chapter" data-level="4.5" data-path="DO_1.html"><a href="DO_1.html#case-studies-examples"><i class="fa fa-check"></i><b>4.5</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="DO_1.html"><a href="DO_1.html#case-study-swan-canning-estuary"><i class="fa fa-check"></i><b>4.5.1</b> Case Study: Swan-Canning Estuary</a></li>
<li class="chapter" data-level="4.5.2" data-path="DO_1.html"><a href="DO_1.html#publications"><i class="fa fa-check"></i><b>4.5.2</b> Publications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Carbon_1.html"><a href="Carbon_1.html"><i class="fa fa-check"></i><b>5</b> Inorganic Carbon</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Carbon_1.html"><a href="Carbon_1.html#contributors-1"><i class="fa fa-check"></i><b>5.1</b> Contributors</a></li>
<li class="chapter" data-level="5.2" data-path="Carbon_1.html"><a href="Carbon_1.html#overview-1"><i class="fa fa-check"></i><b>5.2</b> Overview</a></li>
<li class="chapter" data-level="5.3" data-path="Carbon_1.html"><a href="Carbon_1.html#model-description-1"><i class="fa fa-check"></i><b>5.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Carbon_1.html"><a href="Carbon_1.html#process-descriptions-1"><i class="fa fa-check"></i><b>5.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="Carbon_1.html"><a href="Carbon_1.html#optional-module-links-1"><i class="fa fa-check"></i><b>5.3.2</b> Optional Module Links</a></li>
<li class="chapter" data-level="5.3.3" data-path="Carbon_1.html"><a href="Carbon_1.html#feedbacks-to-the-host-model-1"><i class="fa fa-check"></i><b>5.3.3</b> Feedbacks to the Host Model</a></li>
<li class="chapter" data-level="5.3.4" data-path="Carbon_1.html"><a href="Carbon_1.html#variable-summary-1"><i class="fa fa-check"></i><b>5.3.4</b> Variable Summary</a></li>
<li class="chapter" data-level="5.3.5" data-path="Carbon_1.html"><a href="Carbon_1.html#parameter-summary-1"><i class="fa fa-check"></i><b>5.3.5</b> Parameter Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="Carbon_1.html"><a href="Carbon_1.html#setup-configuration-1"><i class="fa fa-check"></i><b>5.4</b> Setup &amp; Configuration</a></li>
<li class="chapter" data-level="5.5" data-path="Carbon_1.html"><a href="Carbon_1.html#case-studies-examples-1"><i class="fa fa-check"></i><b>5.5</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="Carbon_1.html"><a href="Carbon_1.html#SEQCarbonCaseStudy"><i class="fa fa-check"></i><b>5.5.1</b> Case Study : South-east Queensland estuaries</a></li>
<li class="chapter" data-level="5.5.2" data-path="Carbon_1.html"><a href="Carbon_1.html#case-study-lake-kinneret"><i class="fa fa-check"></i><b>5.5.2</b> Case Study : Lake Kinneret</a></li>
<li class="chapter" data-level="5.5.3" data-path="Carbon_1.html"><a href="Carbon_1.html#publications-1"><i class="fa fa-check"></i><b>5.5.3</b> Publications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html"><i class="fa fa-check"></i><b>6</b> Inorganic Nitrogen</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#contributors-2"><i class="fa fa-check"></i><b>6.1</b> Contributors</a></li>
<li class="chapter" data-level="6.2" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#overview-2"><i class="fa fa-check"></i><b>6.2</b> Overview</a></li>
<li class="chapter" data-level="6.3" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#model-description---default-model"><i class="fa fa-check"></i><b>6.3</b> Model Description - Default Model</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#process-descriptions-2"><i class="fa fa-check"></i><b>6.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="6.3.2" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#variable-summary-2"><i class="fa fa-check"></i><b>6.3.2</b> Variable Summary</a></li>
<li class="chapter" data-level="6.3.3" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#parameter-summary-2"><i class="fa fa-check"></i><b>6.3.3</b> Parameter Summary</a></li>
<li class="chapter" data-level="6.3.4" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#optional-module-links-2"><i class="fa fa-check"></i><b>6.3.4</b> Optional Module Links</a></li>
<li class="chapter" data-level="6.3.5" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#feedbacks-to-the-host-model-2"><i class="fa fa-check"></i><b>6.3.5</b> Feedbacks to the Host Model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#model-description---adding-n2o-reactions"><i class="fa fa-check"></i><b>6.4</b> Model Description - Adding N<sub>2</sub>O Reactions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#process-descriptions-simn20-1"><i class="fa fa-check"></i><b>6.4.1</b> Process Descriptions (<code>simN20</code> = 1)</a></li>
<li class="chapter" data-level="6.4.2" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#process-descriptions-simn2o-2"><i class="fa fa-check"></i><b>6.4.2</b> Process Descriptions (<code>simN2O = 2</code>)</a></li>
<li class="chapter" data-level="6.4.3" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#variable-summary-3"><i class="fa fa-check"></i><b>6.4.3</b> Variable Summary</a></li>
<li class="chapter" data-level="6.4.4" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#parameter-summary-3"><i class="fa fa-check"></i><b>6.4.4</b> Parameter summary</a></li>
<li class="chapter" data-level="6.4.5" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#optional-module-links-3"><i class="fa fa-check"></i><b>6.4.5</b> Optional Module Links</a></li>
<li class="chapter" data-level="6.4.6" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#feedbacks-to-the-host-model-3"><i class="fa fa-check"></i><b>6.4.6</b> Feedbacks to the Host Model</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#setup-configuration-2"><i class="fa fa-check"></i><b>6.5</b> Setup &amp; Configuration</a></li>
<li class="chapter" data-level="6.6" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#case-studies-examples-2"><i class="fa fa-check"></i><b>6.6</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#case-study-yarra-river-estuary"><i class="fa fa-check"></i><b>6.6.1</b> Case Study: Yarra River Estuary</a></li>
<li class="chapter" data-level="6.6.2" data-path="inorganic-nitrogen.html"><a href="inorganic-nitrogen.html#publications-2"><i class="fa fa-check"></i><b>6.6.2</b> Publications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html"><i class="fa fa-check"></i><b>7</b> Inorganic Phosphorus</a>
<ul>
<li class="chapter" data-level="7.1" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#contributors-3"><i class="fa fa-check"></i><b>7.1</b> Contributors</a></li>
<li class="chapter" data-level="7.2" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#overview-3"><i class="fa fa-check"></i><b>7.2</b> Overview</a></li>
<li class="chapter" data-level="7.3" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#model-description-2"><i class="fa fa-check"></i><b>7.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#process-descriptions-3"><i class="fa fa-check"></i><b>7.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="7.3.2" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#optional-module-links-4"><i class="fa fa-check"></i><b>7.3.2</b> Optional Module Links</a></li>
<li class="chapter" data-level="7.3.3" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#feedbacks-to-the-host-model-4"><i class="fa fa-check"></i><b>7.3.3</b> Feedbacks to the Host Model</a></li>
<li class="chapter" data-level="7.3.4" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#variable-summary-4"><i class="fa fa-check"></i><b>7.3.4</b> Variable Summary</a></li>
<li class="chapter" data-level="7.3.5" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#parameter-summary-4"><i class="fa fa-check"></i><b>7.3.5</b> Parameter Summary</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#setup-configuration-3"><i class="fa fa-check"></i><b>7.4</b> Setup &amp; Configuration</a></li>
<li class="chapter" data-level="7.5" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#case-studies-examples-3"><i class="fa fa-check"></i><b>7.5</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#case-study-falling-creek-reservoir"><i class="fa fa-check"></i><b>7.5.1</b> Case Study: Falling Creek Reservoir</a></li>
<li class="chapter" data-level="7.5.2" data-path="inorganic-phosphorus.html"><a href="inorganic-phosphorus.html#publications-3"><i class="fa fa-check"></i><b>7.5.2</b> Publications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="silica.html"><a href="silica.html"><i class="fa fa-check"></i><b>8</b> Silica</a>
<ul>
<li class="chapter" data-level="8.1" data-path="silica.html"><a href="silica.html#contributors-4"><i class="fa fa-check"></i><b>8.1</b> Contributors</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="silica.html"><a href="silica.html#variable-summary-5"><i class="fa fa-check"></i><b>8.1.1</b> Variable Summary</a></li>
<li class="chapter" data-level="8.1.2" data-path="silica.html"><a href="silica.html#parameter-summary-5"><i class="fa fa-check"></i><b>8.1.2</b> Parameter Summary</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="silica.html"><a href="silica.html#setup-configuration-4"><i class="fa fa-check"></i><b>8.2</b> Setup &amp; Configuration</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="organic-matter.html"><a href="organic-matter.html"><i class="fa fa-check"></i><b>9</b> Organic Matter</a>
<ul>
<li class="chapter" data-level="9.1" data-path="organic-matter.html"><a href="organic-matter.html#contributors-5"><i class="fa fa-check"></i><b>9.1</b> Contributors</a></li>
<li class="chapter" data-level="9.2" data-path="organic-matter.html"><a href="organic-matter.html#overview-4"><i class="fa fa-check"></i><b>9.2</b> Overview</a></li>
<li class="chapter" data-level="9.3" data-path="organic-matter.html"><a href="organic-matter.html#model-description-3"><i class="fa fa-check"></i><b>9.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="organic-matter.html"><a href="organic-matter.html#process-descriptions-4"><i class="fa fa-check"></i><b>9.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="9.3.2" data-path="organic-matter.html"><a href="organic-matter.html#optional-module-links-5"><i class="fa fa-check"></i><b>9.3.2</b> Optional Module Links</a></li>
<li class="chapter" data-level="9.3.3" data-path="organic-matter.html"><a href="organic-matter.html#feedbacks-to-the-host-model-5"><i class="fa fa-check"></i><b>9.3.3</b> Feedbacks to the Host Model</a></li>
<li class="chapter" data-level="9.3.4" data-path="organic-matter.html"><a href="organic-matter.html#variable-summary-6"><i class="fa fa-check"></i><b>9.3.4</b> Variable Summary</a></li>
<li class="chapter" data-level="9.3.5" data-path="organic-matter.html"><a href="organic-matter.html#parameter-summary-6"><i class="fa fa-check"></i><b>9.3.5</b> Parameter Summary</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="organic-matter.html"><a href="organic-matter.html#setup-configuration-5"><i class="fa fa-check"></i><b>9.4</b> Setup &amp; Configuration</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="phytoplankton.html"><a href="phytoplankton.html"><i class="fa fa-check"></i><b>10</b> Phytoplankton</a>
<ul>
<li class="chapter" data-level="10.1" data-path="phytoplankton.html"><a href="phytoplankton.html#contributors-6"><i class="fa fa-check"></i><b>10.1</b> Contributors</a></li>
<li class="chapter" data-level="10.2" data-path="phytoplankton.html"><a href="phytoplankton.html#overview-5"><i class="fa fa-check"></i><b>10.2</b> Overview</a></li>
<li class="chapter" data-level="10.3" data-path="phytoplankton.html"><a href="phytoplankton.html#model-description-4"><i class="fa fa-check"></i><b>10.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="phytoplankton.html"><a href="phytoplankton.html#process-descriptions-5"><i class="fa fa-check"></i><b>10.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="10.3.2" data-path="phytoplankton.html"><a href="phytoplankton.html#optional-module-links-6"><i class="fa fa-check"></i><b>10.3.2</b> Optional Module Links</a></li>
<li class="chapter" data-level="10.3.3" data-path="phytoplankton.html"><a href="phytoplankton.html#feedbacks-to-the-host-model-6"><i class="fa fa-check"></i><b>10.3.3</b> Feedbacks to the Host Model</a></li>
<li class="chapter" data-level="10.3.4" data-path="phytoplankton.html"><a href="phytoplankton.html#variable-summary-7"><i class="fa fa-check"></i><b>10.3.4</b> Variable Summary</a></li>
<li class="chapter" data-level="10.3.5" data-path="phytoplankton.html"><a href="phytoplankton.html#parameter-and-option-summary"><i class="fa fa-check"></i><b>10.3.5</b> Parameter and Option Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="phytoplankton.html"><a href="phytoplankton.html#setup-configuration-6"><i class="fa fa-check"></i><b>10.4</b> Setup &amp; Configuration</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="phytoplankton.html"><a href="phytoplankton.html#setup-example"><i class="fa fa-check"></i><b>10.4.1</b> Setup Example</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="phytoplankton.html"><a href="phytoplankton.html#case-studies-examples-4"><i class="fa fa-check"></i><b>10.5</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="phytoplankton.html"><a href="phytoplankton.html#case-study-falling-creek-reservoir-1"><i class="fa fa-check"></i><b>10.5.1</b> Case Study : Falling Creek Reservoir</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html"><i class="fa fa-check"></i><b>11</b> Aqueous Geochemistry</a>
<ul>
<li class="chapter" data-level="11.1" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#contributors-7"><i class="fa fa-check"></i><b>11.1</b> Contributors</a></li>
<li class="chapter" data-level="11.2" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#overview-6"><i class="fa fa-check"></i><b>11.2</b> Overview</a></li>
<li class="chapter" data-level="11.3" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#model-description-5"><i class="fa fa-check"></i><b>11.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#process-descriptions-6"><i class="fa fa-check"></i><b>11.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="11.3.2" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#variable-summary-8"><i class="fa fa-check"></i><b>11.3.2</b> Variable Summary</a></li>
<li class="chapter" data-level="11.3.3" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#parameter-summary-7"><i class="fa fa-check"></i><b>11.3.3</b> Parameter Summary</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#setup-configuration-7"><i class="fa fa-check"></i><b>11.4</b> Setup &amp; Configuration</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="aqueous-geochemistry.html"><a href="aqueous-geochemistry.html#setup-example-1"><i class="fa fa-check"></i><b>11.4.1</b> Setup Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html"><i class="fa fa-check"></i><b>12</b> Pathogens &amp; Microbial Indicator Organisms</a>
<ul>
<li class="chapter" data-level="12.1" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#contributors-8"><i class="fa fa-check"></i><b>12.1</b> Contributors</a></li>
<li class="chapter" data-level="12.2" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#overview-7"><i class="fa fa-check"></i><b>12.2</b> Overview</a></li>
<li class="chapter" data-level="12.3" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#model-description-6"><i class="fa fa-check"></i><b>12.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#process-descriptions-7"><i class="fa fa-check"></i><b>12.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="12.3.2" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#variable-summary-9"><i class="fa fa-check"></i><b>12.3.2</b> Variable Summary</a></li>
<li class="chapter" data-level="12.3.3" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#parameter-summary-8"><i class="fa fa-check"></i><b>12.3.3</b> Parameter Summary</a></li>
<li class="chapter" data-level="12.3.4" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#optional-module-links-7"><i class="fa fa-check"></i><b>12.3.4</b> Optional Module Links</a></li>
<li class="chapter" data-level="12.3.5" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#feedbacks-to-the-host-model-7"><i class="fa fa-check"></i><b>12.3.5</b> Feedbacks to the Host Model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#setup-configuration-8"><i class="fa fa-check"></i><b>12.4</b> Setup &amp; Configuration</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#setup-example-2"><i class="fa fa-check"></i><b>12.4.1</b> Setup Example</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#case-studies-examples-5"><i class="fa fa-check"></i><b>12.5</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#case-study"><i class="fa fa-check"></i><b>12.5.1</b> Case Study</a></li>
<li class="chapter" data-level="12.5.2" data-path="pathogens-microbial-indicator-organisms.html"><a href="pathogens-microbial-indicator-organisms.html#publications-4"><i class="fa fa-check"></i><b>12.5.2</b> Publications</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II AED Benthic Modules</b></span></li>
<li class="chapter" data-level="13" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html"><i class="fa fa-check"></i><b>13</b> Sediment Biogeochemistry</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#contributors-9"><i class="fa fa-check"></i><b>13.1</b> Contributors</a></li>
<li class="chapter" data-level="13.2" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#overview-8"><i class="fa fa-check"></i><b>13.2</b> Overview</a></li>
<li class="chapter" data-level="13.3" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#model-description-7"><i class="fa fa-check"></i><b>13.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#process-descriptions-8"><i class="fa fa-check"></i><b>13.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="13.3.2" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#implementation-within-the-aed-framework"><i class="fa fa-check"></i><b>13.3.2</b> Implementation within the AED framework</a></li>
<li class="chapter" data-level="13.3.3" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#feedbacks-to-the-host-model-8"><i class="fa fa-check"></i><b>13.3.3</b> Feedbacks to the Host Model</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#setup-configuration-9"><i class="fa fa-check"></i><b>13.4</b> Setup &amp; Configuration</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#model-setup-boundary-conditions-parameter-definition"><i class="fa fa-check"></i><b>13.4.1</b> Model Setup, Boundary Conditions &amp; Parameter Definition</a></li>
<li class="chapter" data-level="13.4.2" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#setup-example-3"><i class="fa fa-check"></i><b>13.4.2</b> Setup example</a></li>
<li class="chapter" data-level="13.4.3" data-path="sediment-biogeochemistry.html"><a href="sediment-biogeochemistry.html#model-output-post-processing"><i class="fa fa-check"></i><b>13.4.3</b> Model Output &amp; Post-processing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bivalves.html"><a href="bivalves.html"><i class="fa fa-check"></i><b>14</b> Bivalves</a>
<ul>
<li class="chapter" data-level="14.1" data-path="bivalves.html"><a href="bivalves.html#contributors-10"><i class="fa fa-check"></i><b>14.1</b> Contributors</a></li>
<li class="chapter" data-level="14.2" data-path="bivalves.html"><a href="bivalves.html#overview-9"><i class="fa fa-check"></i><b>14.2</b> Overview</a></li>
<li class="chapter" data-level="14.3" data-path="bivalves.html"><a href="bivalves.html#model-description-8"><i class="fa fa-check"></i><b>14.3</b> Model Description</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="bivalves.html"><a href="bivalves.html#process-descriptions-9"><i class="fa fa-check"></i><b>14.3.1</b> Process Descriptions</a></li>
<li class="chapter" data-level="14.3.2" data-path="bivalves.html"><a href="bivalves.html#variable-summary-10"><i class="fa fa-check"></i><b>14.3.2</b> Variable Summary</a></li>
<li class="chapter" data-level="14.3.3" data-path="bivalves.html"><a href="bivalves.html#parameter-summary-9"><i class="fa fa-check"></i><b>14.3.3</b> Parameter Summary</a></li>
<li class="chapter" data-level="14.3.4" data-path="bivalves.html"><a href="bivalves.html#optional-module-links-8"><i class="fa fa-check"></i><b>14.3.4</b> Optional Module Links</a></li>
<li class="chapter" data-level="14.3.5" data-path="bivalves.html"><a href="bivalves.html#feedbacks-to-the-host-model-9"><i class="fa fa-check"></i><b>14.3.5</b> Feedbacks to the Host Model</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="bivalves.html"><a href="bivalves.html#setup-configuration-10"><i class="fa fa-check"></i><b>14.4</b> Setup &amp; Configuration</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="bivalves.html"><a href="bivalves.html#setup-example-4"><i class="fa fa-check"></i><b>14.4.1</b> Setup Example</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="bivalves.html"><a href="bivalves.html#case-studies-examples-6"><i class="fa fa-check"></i><b>14.5</b> Case Studies &amp; Examples</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="bivalves.html"><a href="bivalves.html#case-study-1"><i class="fa fa-check"></i><b>14.5.1</b> Case Study</a></li>
<li class="chapter" data-level="14.5.2" data-path="bivalves.html"><a href="bivalves.html#publications-5"><i class="fa fa-check"></i><b>14.5.2</b> Publications</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Supporting Material</b></span></li>
<li class="chapter" data-level="15" data-path="genericUtilitiesFunctions.html"><a href="genericUtilitiesFunctions.html"><i class="fa fa-check"></i><b>15</b> Generic Utilities &amp; Functions</a>
<ul>
<li class="chapter" data-level="15.0.1" data-path="genericUtilitiesFunctions.html"><a href="genericUtilitiesFunctions.html#GAS"><i class="fa fa-check"></i><b>15.0.1</b> Gas Transfer</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="publications-6.html"><a href="publications-6.html"><i class="fa fa-check"></i><b>16</b> Publications</a></li>
<li class="chapter" data-level="" data-path="forthcoming-chapters.html"><a href="forthcoming-chapters.html"><i class="fa fa-check"></i>Forthcoming chapters</a>
<ul>
<li class="chapter" data-level="" data-path="forthcoming-chapters.html"><a href="forthcoming-chapters.html#we-invite-you-to-contribute-to-these-chapters"><i class="fa fa-check"></i>We invite you to contribute to these chapters!</a></li>
<li class="chapter" data-level="" data-path="forthcoming-chapters.html"><a href="forthcoming-chapters.html#editing-the-book-1"><i class="fa fa-check"></i>Editing the book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The AED Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aqueous-geochemistry" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Aqueous Geochemistry<a href="aqueous-geochemistry.html#aqueous-geochemistry" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="contributors-7" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Contributors<a href="aqueous-geochemistry.html#contributors-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Matthew R. Hipsey and S. Ursula Salmon</p>
</div>
<div id="overview-6" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Overview<a href="aqueous-geochemistry.html#overview-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The module allows the user to choose from a wide array of geochemical ‘components’ (e.g., anions, cations, metals) to simulate, and then solves for the equilibrium speciation of the solution. The module includes an advanced solver, and provides pH and other solution properties, and optional mineral or gas phases. Relevant kinetic transformations (e.g. redox reactions) between simulated components are also included. Metals may be simulated as part of the model and can also be active within the biological cycles. The module is flexible and simple in its configuration and can be used in the water column and in the sediment if the dynamic sediment diagenesis model (see Section ?) is also being simulated. The module dynamically links with the other biogeochemical processes within AED, such that any biological activity (e.g. algal nutrient uptake and photosynthesis, microbial respiration, and nitrification) will dynamically affect the aqueous speciation and pH. Details of the equilibrium and non-equilibrium processes included are described in the adjacent tab.</p>
<center>
<div class="figure"><span style="display:block;" id="fig:19-pic1"></span>
<img src="images/19-aqueous_geochemistry/image1.png" alt="Conceptual diagram highlighting key variables and interactions within the model" width="95%" />
<p class="caption">
Figure 11.1: Conceptual diagram highlighting key variables and interactions within the model
</p>
</div>
</center>
</div>
<div id="model-description-5" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Model Description<a href="aqueous-geochemistry.html#model-description-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The aqueous geochemistry sub-model was developed to simulate aqueous speciation and solubility equilibrium control of pure-phase minerals using an approach similar to <strong>PHREEQC</strong> and as reported previously in Salmon et al (in review). Each dissolved component, <span class="math inline">\(X\)</span>, and mineral phase, <span class="math inline">\(PP\)</span>, is a state variable within the model and is mass-conserved. In addition to external loading from inflows, the model includes a configurable dissolved sediment flux term for the dissolved species and a sedimentation term for the particulates. If we remove the hydrodynamic terms (e.g., inflows/outflows, mixing) for brevity, the differential equation is defined for the dissolved state variables as:</p>
<div id="process-descriptions-6" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Process Descriptions<a href="aqueous-geochemistry.html#process-descriptions-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="aqueous-speciation-solubility-equilibrium-control" class="section level4 unnumbered hasAnchor">
<h4>Aqueous Speciation &amp; Solubility Equilibrium Control<a href="aqueous-geochemistry.html#aqueous-speciation-solubility-equilibrium-control" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The aqueous geochemistry model is conceptually similar to other equilbrium codes. The model defines geochemical reactions in terms of components. An aqueous species <span class="math inline">\(C\)</span> is created as a product of reaction between components <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, as shown in the following example:</p>
<center>
<span class="math display" id="eq:geochem1">\[\begin{equation}
aA + bB \Longleftrightarrow cC
\tag{11.1}
\end{equation}\]</span>
</center>
<p>where <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> are the stoichiometric coefficients. The reaction shown above is able to proceed back and forward depending on the prevailing conditions of the aqueous solution. The equilibrium of the reaction is a function of the standard free energy, and from this the familiar mass-action expression is defined:</p>
<center>
<span class="math display" id="eq:geochem2">\[\begin{equation}
K_C=\frac{[C]^c}{[A]^a[B]^b}
\tag{11.2}
\end{equation}\]</span>
</center>
<p>where <span class="math inline">\(K_{C}\)</span> is denoted the equilibrium constant. In any natural aquatic system, numerous components are present and there are therefore hundreds of reactions similar to Eq. above that will be close to equilibrium. The many reactions form a complex and interdependent set of simultaneous expressions which can be solved numerically, discussed next.</p>
<p>For each component, <span class="math inline">\(X_{x}\)</span>, (generally components are equivalent to elements, except for the case of elements with multiple redox states, in which case each redox state is assigned as a unique component), a set of <span class="math inline">\(M\)</span> components is defined, <span class="math inline">\(X \in \{X_1, X_2, ..., X_M\}\)</span>. Combination of all the components into an aqueous solution results in numerous reactions taking place of the form of Eq. .., and we define the resultant set of aqueous species that result as: <span class="math inline">\(C \in \{C_1, C_2 ..., C_N\}\)</span>, where <span class="math inline">\(N\)</span> is the total number produced.</p>
<p>The `activity’ of an aqueous species is not equivalent to its molality due to the nonideality of aqueous solutions; a species activity, is related to its molality according to the activity coefficient, :</p>
<center>
<span class="math display" id="eq:geochem3">\[\begin{equation}
  [C_i] = \tilde{C_i} = \gamma_i C_i
\tag{11.3}
\end{equation}\]</span>
</center>
<p>Numerous methods exist for estimating a species activity coefficient. The first is known as the <em>Davies</em> equation:</p>
<center>
<span class="math display" id="eq:geochem4">\[\begin{equation}
  \log \gamma_i = -c_1z_i^2\left(\frac{\sqrt{\mu}}{1+\sqrt{\mu}}-0.3\mu \right)
\tag{11.4}
\end{equation}\]</span>
</center>
<p>and the other one used in the AED2 solution is the Debye-Huckel equation:</p>
<center>
<span class="math display" id="eq:geochem5">\[\begin{equation}
  \log \gamma_i = -\frac{c_1z_i^2\sqrt{\mu}}{1+c_2c_3\sqrt{\mu}} +c_4\mu
\tag{11.5}
\end{equation}\]</span>
</center>
<p>where <span class="math inline">\(z_{i}\)</span> is the ionic charge of the <span class="math inline">\(i^{\text{th}}\)</span> species <span class="math inline">\(c_{1-4}\)</span> are constants that depend upon properties such as the temperature of the solution. The activity of a species is dependent on the ionic strength, <span class="math inline">\(\mu\)</span>, a solution property defined as:</p>
<center>
<span class="math display" id="eq:geochem6">\[\begin{equation}
  \mu = \frac{1}{2}\sum_i^N{z_i^2\frac{C_i}{W_{aq}}}
\tag{11.6}
\end{equation}\]</span>
</center>
<p>where <span class="math inline">\(W_{aq}\)</span> is mass of water in the aqueous phase.</p>
<p>To numerically solve the system of equations, the total number of moles of any component is estimated by adding up the amount contained in each species:</p>
<center>
<span class="math display" id="eq:geochem7">\[\begin{equation}
  T_j = \sum_{i=1}^N{a_{ij}C_i} \:\:\:\:\:\:\:\:\:\:\: j=1..M
\tag{11.7}
\end{equation}\]</span>
</center>
<p>where <span class="math inline">\())aix\)</span> is the stoichiometric coefficient of component <span class="math inline">\(x\)</span> in species <span class="math inline">\(i\)</span>. The activity of each species is calculated using the mass-action equations, which are defined more generically as:</p>
<center>
<span class="math display" id="eq:geochem8">\[\begin{equation}
  \tilde{C}_i = K_i \prod_{j=1}^M{\tilde{X}_j^{a_{ij}}} \:\:\:\:\:\:\: j=1..N
\tag{11.8}
\end{equation}\]</span>
</center>
<p>Taking the logarithm of both sides of Equation above leaves:</p>
<center>
<span class="math display" id="eq:geochem9">\[\begin{equation}
  log \tilde{C}_i = \log K_i + \sum_{j=1}^M{a_{ij}\log \tilde{X}_j} \:\:\:\:\: j=1..N
\tag{11.9}
\end{equation}\]</span>
</center>
<p>which can be defined in matrix notation as:</p>
<center>
<span class="math display" id="eq:geochem10">\[\begin{equation}
  \tilde{C}^* = K^*+A\tilde{X}^*
\tag{11.10}
\end{equation}\]</span>
</center>
<p>where <span class="math inline">\(*\)</span> denotes a vector quantity. The solution is achieved by iterating using a Newton-Rhapson scheme, which aims to minimize the residual, <span class="math inline">\(R\)</span>, between the estimated component molalities (<span class="math inline">\(T\)</span>) and the known values:</p>
<center>
<span class="math display" id="eq:geochem11">\[\begin{equation}
  R_x = \sum_{i=1}^{N}{a_{ix}C_i-T_x}\:\:\:\:\: i=1..N
\tag{11.11}
\end{equation}\]</span>
</center>
<p>In matrix notation:</p>
<center>
<span class="math display" id="eq:geochem12">\[\begin{equation}
  R=A^{-1}C-T
\tag{11.12}
\end{equation}\]</span>
</center>
<p>The Newton-Rhapson technique iterates towards a solution by employing a derivative (termed Jacobian) matrix, <span class="math inline">\(J\)</span>:</p>
<p><span class="math display" id="eq:geochem13">\[\begin{equation}
  R=J \Delta X
\tag{11.13}
\end{equation}\]</span></p>
<p>which is solved for <span class="math inline">\(\Delta X\)</span> at each iteration. The new estimates for <span class="math inline">\(X\)</span> are then updated according to:</p>
<center>
<span class="math display" id="eq:geochem14">\[\begin{equation}
  X^{n+1} = X^n + \Delta X
\tag{11.14}
\end{equation}\]</span>
</center>
<p>and the whole scheme proceeds until the solution has sufficiently converged, <span class="math inline">\(R&lt;\epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span> is a pre-defined convergence criterion (<span class="math inline">\(10^{-10}\)</span> in this code). The Jacobian matrix is defined as:</p>
<center>
<span class="math display" id="eq:geochem15">\[\begin{equation}
  J = \frac{dR_x}{dX_k}
\tag{11.15}
\end{equation}\]</span>
</center>
<p>which can be expanded to:</p>
<center>
<span class="math display" id="eq:geochem16">\[\begin{equation}
  \frac{dR_x}{dX_k} = \sum_{i=1}^{N}{a_{ik}}\frac{dC_i}{dX_k}-\frac{dT_x}{dX_k}
\tag{11.16}
\end{equation}\]</span>
</center>
<p>using Eq. …. The derivatives are then defined according to:</p>
<center>
<span class="math display" id="eq:geochem17">\[\begin{equation}
  \frac{dC_i}{dX_k} = a_{ik}\frac{C_i}{X_k}
\tag{11.17}
\end{equation}\]</span>
</center>
<p>and</p>
<center>
<span class="math display" id="eq:geochem18">\[\begin{equation}
  \frac{dT_x}{dX_k} = 0
\tag{11.18}
\end{equation}\]</span>
</center>
<p>which are the substituted into Eq. .. to leave</p>
<center>
<span class="math display" id="eq:geochem19">\[\begin{equation}
  \frac{dR_x}{dX_k} = \sum_{i=1}^{N}{a_{ik}\:a_{ik}}\frac{C_i}{X_k}.
\tag{11.19}
\end{equation}\]</span>
</center>
<p>Therefore for a given total number of moles of each element in each computational cell, using this scheme the model solves for the activity of each aqueous species, ionic strength and <span class="math inline">\(pH\)</span>. The charge balance variable (denoted <span class="math inline">\(ubalchg\)</span>) is also subject to advection and mixing as all other state variables, and importantly, an estimate of <span class="math inline">\(ubalchg\)</span> must be provided at any inflow boundaries. If this is not done, then the charge balance will be compromised, and will manifest in a poor <span class="math inline">\(pH\)</span> prediction.</p>
<p>The Newton-Rhapson scheme described above is implemented by making use of the Simplex numerical solver (Barrodale and Roberts, 1980; Parkhurst and Appelo, 1999). This is because AED2 also allows for simulation of pure phase (i.e. non-aqueous phase) minerals. When minerals can precipitate and dissolve, properties such as the ionic strength (<span class="math inline">\(MU\)</span>), activity of water (<span class="math inline">\(XH_{2}O\)</span>) and charge balance (<span class="math inline">\(CV\)</span>) may be non-conservative in the aqueous solution. These are therefore included as unknowns in the simplex solver, which uses the Newton-Rhapson technique to solve the following matrix:</p>
<center>
<span class="math display" id="eq:geochem20">\[\begin{equation}
  \begin{array}{lll}
    \begin{pmatrix}
      R_{PP}\\
      R_{X_{1}}\\
      \vdots\\
      R_{X_{N}}\\
      R_{MU}\\
      R_{H_2O}\\
      R_{CB}\\
      R_{W_{aq}}\\
      X_{PP}\\
      \end{pmatrix}
      =&amp;
      \begin{pmatrix}
      \pd{R_{PP}}{\text{ln}(\tilde{X}_1)} &amp; \dots &amp; \pd{R_{PP}}{\text{ln}(\tilde{X}_N)} &amp; \pd{R_{PP}}{d\mu} &amp; &amp; \\
      \pd{R_{X_1}}{\text{ln}(\tilde{X}_1)} &amp;  &amp;  &amp;  &amp;  &amp; \\
       &amp;  &amp;  &amp;  &amp;  &amp; \\
      \vdots &amp;  &amp;  &amp;  &amp;  &amp; \\
       &amp;  &amp;  &amp;  &amp;  &amp; \\
       &amp;  &amp;  &amp;  &amp;  &amp; \pd{R_{Waq}}{X_{PP}} \\
       &amp;  &amp;  &amp;  &amp;  &amp; 1 \\
       \end{pmatrix}
       &amp;
       \begin{pmatrix}
       d\text{ln}(\tilde{X}_1)\\
       R_{X_{1}}\\
       \vdots\\
       d\text{ln}(\tilde{X}_N)\\
       d\mu \\
       d\text{ln}(\tilde{X}_{H_2O})\\
       d\text{ln}(\tilde{X}_{H^+})\\
       d\text{ln}(W_{aq})\\
       dX_{PP}\\
    \end{pmatrix}
  \end{array}
\tag{11.20}
\end{equation}\]</span>
</center>
<p>The operation of the simplex solver is complicated and the reader is referred to Barrodale and Roberts (1980) for a detailed account. The aqueous species used in the simulations is based on those from Nordstrom et al. (1990), termed the <strong>WATEQ4F</strong> database.</p>
<!-- #### Redox Transformations {-} -->
<!-- #### Other Geochemistry Sources/sinks (optional) {-} -->
</div>
</div>
<div id="variable-summary-8" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Variable Summary<a href="aqueous-geochemistry.html#variable-summary-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="state-variables-7" class="section level4 unnumbered hasAnchor">
<h4>State Variables<a href="aqueous-geochemistry.html#state-variables-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:770px; ">
<table class="table" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:19-statevariables">Table 11.1: </span>State variables
</caption>
<thead>
<tr>
<th style="text-align:center;">
Variable Name
</th>
<th style="text-align:center;">
Description
</th>
<th style="text-align:center;">
Units
</th>
<th style="text-align:center;">
Variable Type
</th>
<th style="text-align:center;">
Core/Optional
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;min-width: 13em; background-color: white !important;">
<code>GEO_{var}</code>
</td>
<td style="text-align:center;min-width: 12em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 12em; background-color: white !important;">
<span class="math inline">\(mmol m^{-3}\)</span>
</td>
<td style="text-align:center;min-width: 12em; background-color: white !important;">
pelagic
</td>
<td style="text-align:center;min-width: 13em; background-color: white !important;">
configurable
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="parameter-summary-7" class="section level3 hasAnchor" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Parameter Summary<a href="aqueous-geochemistry.html#parameter-summary-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:550px; overflow-x: scroll; width:770px; ">
<table class="table table-hover" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:19-parameterconfig">Table 11.2: </span>Parameters and configuration
</caption>
<thead>
<tr>
<th style="text-align:center;">
Parameter Name
</th>
<th style="text-align:center;">
Description
</th>
<th style="text-align:center;">
Units
</th>
<th style="text-align:center;">
Parameter Type
</th>
<th style="text-align:center;">
Default
</th>
<th style="text-align:center;">
Typical Range
</th>
<th style="text-align:center;">
Comment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>geochem_file</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
Link to geochem database
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
string
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>num_components</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
number f dissolved components to be concidered
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
integer
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>dis_components</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
list of component names
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
string
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>component_link</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
Active variables to be used as a componenet
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
string
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>Fsed_gch</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
sediment flux rate of dissolved components
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<span class="math inline">\(mmol\,m^{-2}\,day^{-1}\)</span>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
array
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>num_minerals</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
number of particulate mineral phases to be included
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
integer
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>the_minerals</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
list of mineral names
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
string
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>mineral_link</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
name of any active variables to be used as a mineral
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
string
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>w_gch</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
sedimentation rate of chosen particulate phases
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<span class="math inline">\(m\,day^{-1}\)</span>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
array
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>Riron_red</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
float
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>Kiron_red</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
float
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>theta_iron_red</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
float
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>Riron_aox</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
float
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>Riron_box</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
float
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>theta_iron_ox</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
float
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>simEq</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
boolean
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>dis_initial</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
array
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>speciesOutput</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
string
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
<code>min_initial</code>
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
array
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
<td style="text-align:center;min-width: 6em; background-color: white !important;">
—
</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<!-- ###    Optional Module Links -->
<!-- ###    Feedbacks to the Host Model -->
</div>
</div>
<div id="setup-configuration-7" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Setup &amp; Configuration<a href="aqueous-geochemistry.html#setup-configuration-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="setup-example-1" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Setup Example<a href="aqueous-geochemistry.html#setup-example-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An example <code>nml</code> block for the geochemistry module is shown below:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb13-1"><a href="aqueous-geochemistry.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>aed_geochemistry</span>
<span id="cb13-2"><a href="aqueous-geochemistry.html#cb13-2" aria-hidden="true" tabindex="-1"></a>   geochem_file   <span class="kw">=</span> <span class="st">&#39;./AED2/aed_geochem_pars.dat&#39;</span></span>
<span id="cb13-3"><a href="aqueous-geochemistry.html#cb13-3" aria-hidden="true" tabindex="-1"></a>   <span class="co">!-- dissolved components</span></span>
<span id="cb13-4"><a href="aqueous-geochemistry.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">     n</span>um_components <span class="kw">=</span> <span class="dv">10</span></span>
<span id="cb13-5"><a href="aqueous-geochemistry.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">     d</span>is_components <span class="kw">=</span> <span class="st">&#39;DIC&#39;</span>, <span class="st">&#39;FeII&#39;</span>, <span class="st">&#39;FeIII&#39;</span> ,<span class="st">&#39;Al&#39;</span>, <span class="st">&#39;Cl&#39;</span>, <span class="st">&#39;SO4&#39;</span>, <span class="st">&#39;Na&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;Mg&#39;</span>, <span class="st">&#39;Ca&#39;</span>,<span class="st">&#39;H2S&#39;</span></span>
<span id="cb13-6"><a href="aqueous-geochemistry.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">     c</span>omponent_link <span class="kw">=</span> <span class="st">&#39;CAR_dic&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span>,<span class="st">&#39;&#39;</span></span>
<span id="cb13-7"><a href="aqueous-geochemistry.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">     F</span>sed_gch       <span class="kw">=</span> <span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span>,<span class="fl">0.</span></span>
<span id="cb13-8"><a href="aqueous-geochemistry.html#cb13-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">!-- mineral components</span></span>
<span id="cb13-9"><a href="aqueous-geochemistry.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="bu">     n</span>um_minerals   <span class="kw">=</span> <span class="dv">3</span></span>
<span id="cb13-10"><a href="aqueous-geochemistry.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">     t</span>he_minerals    <span class="kw">=</span> <span class="st">&#39;Gibbsite&#39;</span>,<span class="st">&#39;FeOH3A&#39;</span>,<span class="st">&#39;Calcite&#39;</span></span>
<span id="cb13-11"><a href="aqueous-geochemistry.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="bu">     m</span>ineral_link    <span class="kw">=</span>  <span class="st">&#39;&#39;</span>,   <span class="st">&#39;&#39;</span>,  <span class="st">&#39;&#39;</span></span>
<span id="cb13-12"><a href="aqueous-geochemistry.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="bu">     w</span>_gch           <span class="kw">=</span> <span class="fl">0.0</span>, <span class="kw">-</span><span class="fl">1.0</span>, <span class="fl">0.0</span></span>
<span id="cb13-13"><a href="aqueous-geochemistry.html#cb13-13" aria-hidden="true" tabindex="-1"></a>   <span class="co">!-- iron redox</span></span>
<span id="cb13-14"><a href="aqueous-geochemistry.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="bu">     R</span>iron_red <span class="kw">=</span> <span class="fl">0.0</span></span>
<span id="cb13-15"><a href="aqueous-geochemistry.html#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="bu">     K</span>iron_red <span class="kw">=</span> <span class="fl">100.</span></span>
<span id="cb13-16"><a href="aqueous-geochemistry.html#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">     t</span>heta_iron_red <span class="kw">=</span> <span class="fl">1.07</span></span>
<span id="cb13-17"><a href="aqueous-geochemistry.html#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="bu">     R</span>iron_aox <span class="kw">=</span> <span class="fl">0.0</span>  <span class="co">!1 = 100% per day decay</span></span>
<span id="cb13-18"><a href="aqueous-geochemistry.html#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">     R</span>iron_box <span class="kw">=</span> <span class="fl">0.5</span></span>
<span id="cb13-19"><a href="aqueous-geochemistry.html#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="bu">     t</span>heta_iron_ox <span class="kw">=</span> <span class="fl">1.06</span></span>
<span id="cb13-20"><a href="aqueous-geochemistry.html#cb13-20" aria-hidden="true" tabindex="-1"></a>   <span class="co">!-- advanced</span></span>
<span id="cb13-21"><a href="aqueous-geochemistry.html#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="bu">     s</span>imEq <span class="kw">=</span> <span class="cn">.true.</span></span>
<span id="cb13-22"><a href="aqueous-geochemistry.html#cb13-22" aria-hidden="true" tabindex="-1"></a>   <span class="co">! dis_initial    = 0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1</span></span>
<span id="cb13-23"><a href="aqueous-geochemistry.html#cb13-23" aria-hidden="true" tabindex="-1"></a>   <span class="co">! speciesOutput  = &#39;CO2&#39;</span></span>
<span id="cb13-24"><a href="aqueous-geochemistry.html#cb13-24" aria-hidden="true" tabindex="-1"></a>   <span class="co">! min_initial    = 0.01,0.01,0.01,0.01</span></span>
<span id="cb13-25"><a href="aqueous-geochemistry.html#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">/</span></span></code></pre></div>
<p><br></p>

<div class="rmdnote">
In addition to adding the above code block to <code>aed.nml</code>, users must also supply a valid AED geochemistry reaction database file (<code>aed_geochem_pars</code>). This file must be supplied in the specified <code>DAT</code> format.
</div>
<p><br></p>
<!-- ## Case Studies & Examples -->
<!-- ###    Case Study -->
<!-- ###    Publications -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="phytoplankton.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pathogens-microbial-indicator-organisms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AquaticEcoDynamics/aed-science/blob/master/19-aqueous_geochemistry.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/AquaticEcoDynamics/aed-science/edit/master/19-aqueous_geochemistry.Rmd",
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["aed_science.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
